{"version":3,"sources":["webpack:///static/js/app.73294db1681dae71608e.js","webpack:///./src/main.js","webpack:///./src/libs/Tools.js","webpack:///./src/libs/Drawing.js","webpack:///./src/libs/ColorUtil.js","webpack:///./src/libs/DrawingManager.js","webpack:///App.vue","webpack:///UiCanvas.vue","webpack:///UiLayerList.vue","webpack:///UiSlider.vue","webpack:///./src/App.vue","webpack:///./src/components/UiCanvas.vue","webpack:///./src/components/UiLayerList.vue","webpack:///./src/components/UiSlider.vue","webpack:///./src/components/UiCanvas.vue?ce90","webpack:///./src/components/UiSlider.vue?ef7f","webpack:///./src/App.vue?0d2e","webpack:///./src/components/UiLayerList.vue?28f7"],"names":["webpackJsonp","0","module","exports","__webpack_require__","_interopRequireDefault","obj","__esModule","default","_vue","_vue2","_App","_App2","el","template","components","App","10","Object","defineProperty","value","tools","PEN","window","Symbol","BRUSH","ERASER","SPOIT","FILL","COLOR","fromName","name","25","_slicedToArray2","_slicedToArray3","_defineProperties","_defineProperties2","_classCallCheck2","_classCallCheck3","_createClass2","_createClass3","_color","_color2","_Tools","_Tools2","Drawing","mainColor","tool","canvas","width","arguments","length","undefined","height","showPen","showBase","showExtra","this","url","history","shape","document","createElement","overlap","style","currentStyle","getComputedStyle","styleWidth","parseInt","styleHeight","ctx","getContext","devicePixelRatio","scale","setupCanvas","_mainColor","_canvas","key","path","color","size","lineCap","strokeStyle","hex","globalAlpha","a","lineWidth","globalCompositeOperation","beginPath","i","Math","max","_path$i","cx","cy","_ref","_ref2","nx","ny","moveTo","lineTo","stroke","editRange","drawImage","lx","ly","rx","ry","ctx2","updateCanvas","clearRect","ctx3","origShape","origOverlap","info","tune","ctxOrig","w","h","putImageData","getImageData","pen","base","extra","get","toDataURL","orig","copied","Uint8ClampedArray","data","set","ps","ImageData","cache","newColor","c","slice","join","rgb","rotate","hue","saturate","sat","lighten","val","array","concat","60","hslToYuv","s","l","r","g","b","hue2rgb","p","q","t","round","y","u","v","rgbToYuv","61","_getIterator2","_getIterator3","_assign","_assign2","_mlKmeans","_mlKmeans2","_mlDistance","_mlDistance2","_Drawing","_Drawing2","_ColorUtil","MEASURE_ITER_COUNT","SORT_DIV","layerIndex","DrawingManager","fixedObject","objects","objectIndexes","layers","histories","sortCache","lastKey","clearedKey","_styleWidth","_styleHeight","drawPen","drawBrush","updateSort","update","getKey","rgba","target","indexOf","toString","push","getToolString","drawObject","currentColorString","getColorString","allColors","filter","x","map","getColor","overlapping","checkOverlap","colors","comp","spilled","self","sameIndexes","last","idx","simIndexes","currentColor","console","log","abs","distance","euclidean","targetIdx","minTarget","d","changed","drawOverlapObject","sim","drawObjectComp","splice","eraseObject","k","split","eraseOverlapObject","clear","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","next","done","imageUrl","err","return","reverse","_this","c1","d1","ctx1","c2","d2","sort","key1","key2","o1","o2","tool1","tool2","cacheKey","oc1","oc2","fillStyle","fillRect","imgdata","_DrawingManager$measu","measureArea","_DrawingManager$measu2","result","_DrawingManager$measu3","_DrawingManager$measu4","point","spoitColor","points","filledColor","layerIdx","historyIdx","changeVisual","colorString","_x","_y","_w","targetColors","range","hits","Array","fill","ox","oy","random","getImageDataFaster","j","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","arr","before","kms","bics","Number","NEGATIVE_INFINITY","cluster_arr","km","newArr","clusters","res","computeBic","bic","resClusters","centers","centroids","centroid","labels","m","n","N","clVar","constTerm","PI","62","_from","_from2","_vueColor","_vueMaterial","_vueMaterial2","_UiCanvas","_UiCanvas2","_UiSlider","_UiSlider2","_UiLayerList","_UiLayerList2","_DrawingManager","_DrawingManager2","use","currentTool","prevTool","toolSizes","Sketch","UiCanvas","UiLayerList","UiSlider","drawingManager","defaultSize","tuneTargetKey","tuneTarget","tuneInfo","tuneShape","tuneOverlap","showPalette","mounted","querySelector","count","startTime","counter","Date","getTime","title","requestAnimationFrame","methods","onchange","toggletool","$refs","slider","setValue","onchangesize","onextractcolor","colorPicker","colorChange","newcanvas","toolButtons","$el","children","classList","remove","penButton","add","onclear","index","rollback","openColorDialog","hueSlider","satSlider","valSlider","colorDialog","open","closeColorDialog","po","close","applyColorDialog","targetTool","targetColor","floor","newKey","ontune","targetKey","onchangehue","colorTune","onchangesat","onchangeval","onchangevisiual","togglepalette","63","getMousePos","event","rect","getBoundingClientRect","clientX","touches","clientY","left","top","props","currentStroke","drawing","eraseTarget","addEventListener","dragover","drop","mousedown","preventDefault","_getMousePos","_getMousePos2","mousex","mousey","firstTarget","spoit","$emit","getTopKey","draw","updateerasertarget","mousemove","_currentStroke","pmousex","pmousey","_getMousePos3","_getMousePos4","min","mouseup","erase","$parent","cos","sin","file","dataTransfer","files","type","reader","FileReader","onload","image","setAttribute","readAsDataURL","64","active","mouseover","mouseleave","65","_draggabilly","_draggabilly2","keyboardStep","defaultValue","dragging","draggable","thumb","containment","container","axis","on","dragStart","dragMove","dragEnd","sliderClick","e","sliderPosition","newValue","_pointerDown","focus","position","increment","decrement","updateThumb","emit","moderatedValue","110","111","112","113","114","176","Component","177","178","179","180","render","_vm","_h","$createElement","_c","_self","attrs","id","_v","ref","touchstart","touchmove","touchend","staticRenderFns","181","staticClass","class","tabindex","keydown","$event","_k","keyCode","button","182","current-color","current-tool","prev-tool","tool-sizes","drawing-manager","directives","rawName","expression","change-color","model","callback","$$v","change-value","_e","change","click","md-single","183","_l","layer","src","staticStyle","display"],"mappings":"AAAAA,cAAc,EAAE,IAEVC,EACA,SAAUC,EAAQC,EAASC,GAEhC,YAUA,SAASC,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,QAASF,GCbxF,GAAAG,GAAAL,EAAA,IDOKM,EAAQL,EAAuBI,GCNpCE,EAAAP,EAAA,KDUKQ,EAAQP,EAAuBM,ECPpC,IAAAD,GAAAF,SACEK,GAAI,OACJC,SAAU,SACVC,YAAcC,kBDgBVC,GACA,SAAUf,EAAQC,GAEvB,YAEAe,QAAOC,eAAehB,EAAS,cAC7BiB,OAAO,GE/BV,IAAMC,IACJC,IAAKC,OAAOC,OAAO,OACnBC,MAAOF,OAAOC,OAAO,SACrBE,OAAQH,OAAOC,OAAO,UACtBG,MAAOJ,OAAOC,OAAO,SACrBI,KAAML,OAAOC,OAAO,QACpBK,MAAON,OAAOC,OAAO,SACrBM,SAAU,SAACC,GACT,OAAQA,GACN,IAAK,MACH,MAAOV,GAAMC,GACf,KAAK,QACH,MAAOD,GAAMI,KACf,KAAK,SACH,MAAOJ,GAAMK,MACf,KAAK,QACH,MAAOL,GAAMM,KACf,KAAK,OACH,MAAON,GAAMO,IACf,KAAK,QACH,MAAOP,GAAMQ,KACf,SACE,SFsCP1B,GAAQK,QEjCMa,GFqCTW,GACA,SAAU9B,EAAQC,EAASC,GAEhC,YA8BA,SAASC,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,QAASF,GA5BvFY,OAAOC,eAAehB,EAAS,cAC7BiB,OAAO,GAGT,IAAIa,GAAkB7B,EAAoB,IAEtC8B,EAAkB7B,EAAuB4B,GAEzCE,EAAoB/B,EAAoB,IAExCgC,EAAqB/B,EAAuB8B,GAE5CE,EAAmBjC,EAAoB,IAEvCkC,EAAmBjC,EAAuBgC,GAE1CE,EAAgBnC,EAAoB,IAEpCoC,EAAgBnC,EAAuBkC,GGvF5CE,EAAArC,EAAA,IH2FKsC,EAAUrC,EAAuBoC,GG1FtCE,EAAAvC,EAAA,IH8FKwC,EAAUvC,EAAuBsC,GG5FhCE,EHgGS,WG/Fb,QAAAA,GAAYC,EAAWC,EAAMC,GAC+C,GAA1EC,GAA0EC,UAAAC,OAAA,GAAAC,SAAAF,UAAA,GAAAA,UAAA,GAAlE,EAAGG,EAA+DH,UAAAC,OAAA,GAAAC,SAAAF,UAAA,GAAAA,UAAA,GAAtD,EAAGI,IAAmDJ,UAAAC,OAAA,GAAAC,SAAAF,UAAA,KAAAA,UAAA,GAAnCK,IAAmCL,UAAAC,OAAA,GAAAC,SAAAF,UAAA,KAAAA,UAAA,GAAlBM,IAAkBN,UAAAC,OAAA,GAAAC,SAAAF,UAAA,KAAAA,UAAA,EAY1E,KAZ0E,EAAAZ,EAAA9B,SAAAiD,KAAAZ,GAC1EY,KAAKX,UAAYA,EACjBW,KAAKV,KAAOA,EACZU,KAAKT,OAASA,EACdS,KAAKC,IAAM,KACXD,KAAKE,QAAU,KACfF,KAAKG,MAAQC,SAASC,cAAc,UACpCL,KAAKM,QAAUF,SAASC,cAAc,UACtCL,KAAKH,QAAUA,EACfG,KAAKF,SAAWA,EAChBE,KAAKD,UAAYA,EAEH,IAAVP,GAA0B,IAAXI,EAAc,CAC/B,GAAMW,GAAQhB,EAAOiB,cAAgB1C,OAAO2C,iBAAiBlB,EAC7DS,MAAKU,WAAa5C,OAAO6C,SAASJ,EAAMf,OACxCQ,KAAKY,YAAc9C,OAAO6C,SAASJ,EAAMX,YAEzCI,MAAKU,WAAalB,EAClBQ,KAAKY,YAAchB,CAGrB,IAAMiB,GAAMtB,EAAOuB,WAAW,KAC9Bd,MAAKT,OAAOC,MAAQQ,KAAKU,WAAa5C,OAAOiD,iBAC7Cf,KAAKT,OAAOK,OAASI,KAAKY,YAAc9C,OAAOiD,iBAC/Cf,KAAKT,OAAOgB,MAAMf,MAAQQ,KAAKU,WAC/BV,KAAKT,OAAOgB,MAAMX,OAASI,KAAKY,YAChCC,EAAIG,MAAMlD,OAAOiD,iBAAkBjD,OAAOiD,kBAE1C3B,EAAQ6B,YAAYjB,KAAKT,OAAQS,KAAKU,WAAYV,KAAKY,aACvDxB,EAAQ6B,YAAYjB,KAAKG,MAAOH,KAAKU,WAAYV,KAAKY,aACtDxB,EAAQ6B,YAAYjB,KAAKM,QAASN,KAAKU,WAAYV,KAAKY,cAExD,EAAAjC,EAAA5B,SAAwBiD,MACtBkB,YACEvD,MAAOqC,KAAKX,WAEd8B,SACExD,MAAOqC,KAAKT,UHwVjB,OA7OA,EAAIR,EAAchC,SAASqC,IACzBgC,IAAK,OACLzD,MAAO,SG9FL0D,EAAMC,EAAOhC,EAAMiC,GACtB,GAAoB,IAAhBF,EAAK3B,OAAT,CAIA,GAAMmB,GAAMb,KAAKT,OAAOuB,WAAW,KAEnC,QADAD,EAAIW,QAAU,QACNlC,GACN,IAAKH,GAAApC,QAAMc,IACX,IAAKsB,GAAApC,QAAMiB,MACT6C,EAAIY,YAAcH,EAAMI,IACxBb,EAAIc,YAAcL,EAAMM,CACxB,MACF,KAAKzC,GAAApC,QAAMkB,OACT4C,EAAIY,YAAc,OAClBZ,EAAIc,YAAc,CAClB,MACF,SACE,OAEJd,EAAIgB,UAAYN,EAChBV,EAAIiB,yBAA2B,cAE/BjB,EAAIkB,WACJ,KAAK,GAAIC,GAAI,EAAGA,EAAIC,KAAKC,IAAIb,EAAK3B,OAAS,EAAG,GAAIsC,GAAK,EAAG,IAAAG,IAAA,EAAA1D,EAAA1B,SACvCsE,EAAKW,GADkC,GACjDI,EADiDD,EAAA,GAC7CE,EAD6CF,EAAA,GAAAG,EAEvCjB,EAAKW,EAAI,IAAMX,EAAKW,GAFmBO,GAAA,EAAA9D,EAAA1B,SAAAuF,EAAA,GAEjDE,EAFiDD,EAAA,GAE7CE,EAF6CF,EAAA,EAGxD1B,GAAI6B,OAAON,EAAIC,GACfxB,EAAI8B,OAAOH,EAAIC,GAEjB5B,EAAI+B,SAEJ5C,KAAKC,IAAM,SHwGVmB,IAAK,iBACLzD,MAAO,SGrGKd,EAAKgG,GAClB,GAAMhC,GAAMb,KAAKG,MAAMW,WAAW,KAC9B+B,GACFhC,EAAIiC,UACFjG,EAAIsD,MACJ0C,EAAUE,GAAKjF,OAAOiD,iBACtB8B,EAAUG,GAAKlF,OAAOiD,kBACrB8B,EAAUI,GAAKJ,EAAUE,IAAMjF,OAAOiD,kBACtC8B,EAAUK,GAAKL,EAAUG,IAAMlF,OAAOiD,iBACvC8B,EAAUE,GAAIF,EAAUG,GACxBH,EAAUI,GAAKJ,EAAUE,GAAIF,EAAUK,GAAKL,EAAUG,IAGxDnC,EAAIiC,UAAUjG,EAAIsD,MAAO,EAAG,EAAGH,KAAKU,WAAYV,KAAKY,YAEvD,IAAMuC,GAAOnD,KAAKM,QAAQQ,WAAW,KACjC+B,GACFM,EAAKL,UACHjG,EAAI0C,OACJsD,EAAUE,GAAKjF,OAAOiD,iBACtB8B,EAAUG,GAAKlF,OAAOiD,kBACrB8B,EAAUI,GAAKJ,EAAUE,IAAMjF,OAAOiD,kBACtC8B,EAAUK,GAAKL,EAAUG,IAAMlF,OAAOiD,iBACvC8B,EAAUE,GAAIF,EAAUG,GACxBH,EAAUI,GAAKJ,EAAUE,GAAIF,EAAUK,GAAKL,EAAUG,IAGxDG,EAAKL,UAAUjG,EAAIyD,QAAS,EAAG,EAAGN,KAAKU,WAAYV,KAAKY,aAE1DZ,KAAKoD,eACLpD,KAAKC,IAAM,QHwFVmB,IAAK,aACLzD,MAAO,SGtFCd,EAAKgG,GACd,GAAI7C,KAAKV,KAAM,CACb,GAAkB,gBAAdU,KAAKV,OAA2BU,KAAKH,QACvC,MAEF,IAAkB,kBAAdG,KAAKV,OAA6BU,KAAKF,SACzC,OAGJ,GAAMe,GAAMb,KAAKG,MAAMW,WAAW,KAC9B+B,GACFhC,EAAIiC,UACFjG,EAAI0C,OACJsD,EAAUE,GAAKjF,OAAOiD,iBACtB8B,EAAUG,GAAKlF,OAAOiD,kBACrB8B,EAAUI,GAAKJ,EAAUE,IAAMjF,OAAOiD,kBACtC8B,EAAUK,GAAKL,EAAUG,IAAMlF,OAAOiD,iBACvC8B,EAAUE,GAAIF,EAAUG,GACxBH,EAAUI,GAAKJ,EAAUE,GAAIF,EAAUK,GAAKL,EAAUG,IAGxDnC,EAAIiC,UAAUjG,EAAI0C,OAAQ,EAAG,EAAGS,KAAKU,WAAYV,KAAKY,aAExDZ,KAAKoD,eACLpD,KAAKC,IAAM,QHiFVmB,IAAK,oBACLzD,MAAO,SG/EQd,EAAKgG,GACrB,GAAK7C,KAAKD,UAAV,CAGA,GAAMc,GAAMb,KAAKM,QAAQQ,WAAW,KAChC+B,GACFhC,EAAIiC,UACFjG,EAAI0C,OACJsD,EAAUE,GAAKjF,OAAOiD,iBACtB8B,EAAUG,GAAKlF,OAAOiD,kBACrB8B,EAAUI,GAAKJ,EAAUE,IAAMjF,OAAOiD,kBACtC8B,EAAUK,GAAKL,EAAUG,IAAMlF,OAAOiD,iBACvC8B,EAAUE,GAAIF,EAAUG,GACxBH,EAAUI,GAAKJ,EAAUE,GAAIF,EAAUK,GAAKL,EAAUG,IAGxDnC,EAAIiC,UAAUjG,EAAI0C,OAAQ,EAAG,EAAGS,KAAKU,WAAYV,KAAKY,aAExDZ,KAAKoD,eACLpD,KAAKC,IAAM,SH0EVmB,IAAK,cACLzD,MAAO,SGxEEd,GACV,GAAImD,KAAKV,KAAM,CACb,GAAkB,gBAAdU,KAAKV,OAA2BU,KAAKH,QACvC,MAEF,IAAkB,kBAAdG,KAAKV,OAA6BU,KAAKF,SACzC,OAGJ,GAAMe,GAAMb,KAAKG,MAAMW,WAAW,KAYlCD,GAAIiB,yBAA2B,kBAC/BjB,EAAIiC,UAAUjG,EAAI0C,OAAQ,EAAG,EAAGS,KAAKU,WAAYV,KAAKY,aACtDC,EAAIiB,yBAA2B,cAE/B9B,KAAKoD,eACLpD,KAAKC,IAAM,QHiEVmB,IAAK,qBACLzD,MAAO,SG/DSd,GACjB,GAAKmD,KAAKD,UAAV,CAGA,GAAMc,GAAMb,KAAKM,QAAQQ,WAAW,KAYpCD,GAAIiB,yBAA2B,kBAC/BjB,EAAIiC,UAAUjG,EAAI0C,OAAQ,EAAG,EAAGS,KAAKU,WAAYV,KAAKY,aACtDC,EAAIiB,yBAA2B,cAE/B9B,KAAKT,OAAOuB,WAAW,MAAMuC,UAAU,EAAG,EAAGrD,KAAKU,WAAYV,KAAKY,aACnEZ,KAAKoD,eACLpD,KAAKC,IAAM,SHwDVmB,IAAK,QACLzD,MAAO,SGtDJkF,GACJ,GAAMhC,GAAMb,KAAKT,OAAOuB,WAAW,KAC/B+B,GACFhC,EAAIwC,UACFR,EAAUE,GAAIF,EAAUG,GACxBH,EAAUI,GAAKJ,EAAUE,GAAIF,EAAUK,GAAKL,EAAUG,IAGxDnC,EAAIwC,UAAU,EAAG,EAAGrD,KAAKU,WAAYV,KAAKY,YAE5C,IAAMuC,GAAOnD,KAAKG,MAAMW,WAAW,KAC/B+B,GACFM,EAAKE,UACHR,EAAUE,GAAIF,EAAUG,GACxBH,EAAUI,GAAKJ,EAAUE,GAAIF,EAAUK,GAAKL,EAAUG,IAGxDG,EAAKE,UAAU,EAAG,EAAGrD,KAAKU,WAAYV,KAAKY,YAE7C,IAAM0C,GAAOtD,KAAKG,MAAMW,WAAW,KAC/B+B,GACFS,EAAKD,UACHR,EAAUE,GAAIF,EAAUG,GACxBH,EAAUI,GAAKJ,EAAUE,GAAIF,EAAUK,GAAKL,EAAUG,IAGxDM,EAAKD,UAAU,EAAG,EAAGrD,KAAKU,WAAYV,KAAKY,aAE7CZ,KAAKC,IAAM,QHgDVmB,IAAK,YACLzD,MAAO,SG9CA4F,EAAWC,EAAaC,GAChCrE,EAAQsE,KAAKH,EAAWvD,KAAKG,MAAOsD,GACpCrE,EAAQsE,KAAKF,EAAaxD,KAAKM,QAASmD,GACxCzD,KAAKoD,eACLpD,KAAKC,IAAM,QHiDVmB,IAAK,eACLzD,MAAO,SGbGkF,GACX,GAAMc,GAAU3D,KAAKT,OAAOuB,WAAW,KACvC,KAAKd,KAAKV,MACU,gBAAdU,KAAKV,MAA0BU,KAAKH,SACtB,kBAAdG,KAAKV,MAA4BU,KAAKF,SAAW,CACrD,GAAI+C,EAAW,CACb,GAAMe,IAAKf,EAAUI,GAAKJ,EAAUE,IAAMjF,OAAOiD,iBAC3C8C,GAAKhB,EAAUK,GAAKL,EAAUG,IAAMlF,OAAOiD,gBACjD4C,GAAQG,aACN9D,KAAKG,MAAMW,WAAW,MAAMiD,aAAalB,EAAUE,GAAIF,EAAUG,GAAIY,EAAGC,GAAIhB,EAAUE,GAAIF,EAAUG,QAGtGW,GAAQG,aACN9D,KAAKG,MAAMW,WAAW,MAAMiD,aAAa,EAAG,EAAG/D,KAAKG,MAAMX,MAAOQ,KAAKG,MAAMP,QAAS,EAAG,EAG5F+D,GAAQ7B,yBAA2B,cAEnB,kBAAd9B,KAAKV,MAA4BU,KAAKD,WACxC4D,EAAQb,UAAU9C,KAAKM,QAAS,EAAG,EAAGN,KAAKU,WAAYV,KAAKY,aAE9D+C,EAAQ7B,yBAA2B,iBHUlCV,IAAK,eACLzD,MAAO,SGRGqG,EAAKC,EAAMC,GACtBlE,KAAKH,QAAUmE,EACfhE,KAAKF,SAAWmE,EAChBjE,KAAKD,UAAYmE,EACjBlE,KAAKC,IAAM,KACXD,KAAKT,OAAOuB,WAAW,MAAMuC,UAAU,EAAG,EAAGrD,KAAKT,OAAOC,MAAOQ,KAAKT,OAAOK,QAC5EI,KAAKoD,kBHWJhC,IAAK,WACL+C,IAAK,WGLN,MAHKnE,MAAKC,MACRD,KAAKC,IAAMD,KAAKT,OAAO6E,aAElBpE,KAAKC,SHYXmB,IAAK,cACLzD,MAAO,SGhTS4B,EAAQmB,EAAYE,GAErC,GAAMC,GAAMtB,EAAOuB,WAAW,KAC9BvB,GAAOC,MAAQkB,EAAa5C,OAAOiD,iBACnCxB,EAAOK,OAASgB,EAAc9C,OAAOiD,iBACrCxB,EAAOgB,MAAMf,MAAQkB,EACrBnB,EAAOgB,MAAMX,OAASgB,EACtBC,EAAIG,MAAMlD,OAAOiD,iBAAkBjD,OAAOiD,qBHkTzCK,IAAK,OACLzD,MAAO,SG9FE0G,EAAM9E,EAAQkE,GACxB,GAAMa,GAAS,GAAIC,mBAAkBF,EAAKG,KAC1CF,GAAOG,IAAIJ,EAMX,KAAK,GALCK,GAAK,GAAI5G,QAAO6G,UACpBL,EACA/E,EAAOC,MAAOD,EAAOK,QAEjBgF,KACG5C,EAAI,EAAGA,EAAI0C,EAAGF,KAAK9E,OAAQsC,GAAK,EAEvC,GAAuB,IAAnB0C,EAAGF,KAAKxC,EAAI,GAAhB,CAIA,GAAI6C,UACEC,EAAIF,EAAMF,EAAGF,KAAKO,MAAM/C,EAAGA,EAAI,GAAGgD,KAAK,KACzCF,GACFD,EAAWC,GAGXD,EAAW5F,EAAAlC,QAAMkI,IAAIP,EAAGF,KAAKO,MAAM/C,EAAGA,EAAI,IACvCkD,OAAOzB,EAAK0B,KACZC,SAAS3B,EAAK4B,KACdC,QAAQ7B,EAAK8B,KAChBV,EAAWA,EAASI,MAAMO,QAC1BZ,EAAMF,EAAGF,KAAKO,MAAM/C,EAAGA,EAAI,GAAGgD,KAAK,SAAWS,OAAOZ,IAEvDH,EAAGF,KAAKxC,GAAK6C,EAAS,GACtBH,EAAGF,KAAKxC,EAAI,GAAK6C,EAAS,GAC1BH,EAAGF,KAAKxC,EAAI,GAAK6C,EAAS,GAE5BtF,EAAOuB,WAAW,MAAMgD,aAAaY,EAAI,EAAG,OHwFtCtF,IAGT1C,GAAQK,QG/CMqC,GHmDTsG,GACA,SAAUjJ,EAAQC,GAEvB,YAEAe,QAAOC,eAAehB,EAAS,cAC7BiB,OAAO,GI7YV,IAAMgI,GAAW,SAAC9B,EAAG+B,EAAGC,GACtBhC,GAAK,IACL+B,GAAK,IACLC,GAAK,GAEL,IAAIC,UACAC,SACAC,QAEJ,IAAU,IAANJ,EACFE,EAAIC,EAAIC,EAAIH,MACP,CACL,GAAMI,GAAU,SAACC,EAAGC,EAAGC,GAGrB,MAFIA,GAAI,IAAGA,GAAK,GACZA,EAAI,IAAGA,GAAK,GACZA,EAAI,EAAI,EAAUF,EAAc,GAATC,EAAID,GAASE,EACpCA,EAAI,GAAcD,EAClBC,EAAI,EAAI,EAAUF,GAAKC,EAAID,IAAM,EAAI,EAAIE,GAAK,EAC3CF,GAGHC,EAAIN,EAAI,GAAMA,GAAK,EAAID,GAAKC,EAAID,EAAIC,EAAID,EACxCM,EAAI,EAAIL,EAAIM,CAClBL,GAAIG,EAAQC,EAAGC,EAAGtC,EAAI,EAAI,GAC1BkC,EAAIE,EAAQC,EAAGC,EAAGtC,GAClBmC,EAAIC,EAAQC,EAAGC,EAAGtC,EAAI,EAAI,GAG5BiC,EAAI7D,KAAKoE,MAAU,IAAJP,GACfC,EAAI9D,KAAKoE,MAAU,IAAJN,GACfC,EAAI/D,KAAKoE,MAAU,IAAJL,EAEf,IAAMM,GAAK,KAAQR,EAAI,KAAQC,EAAI,KAAQC,EACrCO,GAAK,KAAST,EAAI,KAAQC,EAAI,GAAQC,EACtCQ,EAAK,GAAQV,EAAI,KAAQC,EAAI,KAAQC,CAE3C,QAAQM,EAAGC,EAAGC,IAGVC,EAAW,SAACxB,GAChB,GAAMa,GAAI7D,KAAKoE,MAAMpB,EAAI,IACnBc,EAAI9D,KAAKoE,MAAMpB,EAAI,IACnBe,EAAI/D,KAAKoE,MAAMpB,EAAI,IAEnBqB,EAAK,KAAQR,EAAI,KAAQC,EAAI,KAAQC,EACrCO,GAAK,KAAST,EAAI,KAAQC,EAAI,GAAQC,EACtCQ,EAAK,GAAQV,EAAI,KAAQC,EAAI,KAAQC,CAE3C,QAAQM,EAAGC,EAAGC,GJmZf9J,GIhZQiJ,WJiZRjJ,EIjZkB+J,YJqZbC,GACA,SAAUjK,EAAQC,EAASC,GAEhC,YAgDA,SAASC,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,QAASF,GA9CvFY,OAAOC,eAAehB,EAAS,cAC7BiB,OAAO,GAGT,IAAIa,GAAkB7B,EAAoB,IAEtC8B,EAAkB7B,EAAuB4B,GAEzCmI,EAAgBhK,EAAoB,IAEpCiK,EAAgBhK,EAAuB+J,GAEvCE,EAAUlK,EAAoB,IAE9BmK,EAAWlK,EAAuBiK,GAElCnI,EAAoB/B,EAAoB,IAExCgC,EAAqB/B,EAAuB8B,GAE5CE,EAAmBjC,EAAoB,IAEvCkC,EAAmBjC,EAAuBgC,GAE1CE,EAAgBnC,EAAoB,IAEpCoC,EAAgBnC,EAAuBkC,GKze5CiI,EAAApK,EAAA,KL6eKqK,EAAapK,EAAuBmK,GK5ezCE,EAAAtK,EAAA,KLgfKuK,EAAetK,EAAuBqK,GK9e3CE,EAAAxK,EAAA,ILkfKyK,EAAYxK,EAAuBuK,GKjfxCjI,EAAAvC,EAAA,ILqfKwC,EAAUvC,EAAuBsC,GKpftCmI,EAAA1K,EAAA,IAEM2K,EAAqB,IACrBC,EAAW,EAEbC,EAAa,EAEXC,ELwfgB,WKvfpB,QAAAA,GAAYlI,IAAQ,EAAAV,EAAA9B,SAAAiD,KAAAyH,EAClB,IAAMlH,GAAQhB,EAAOiB,cAAgB1C,OAAO2C,iBAAiBlB,EAC7DS,MAAKU,WAAa5C,OAAO6C,SAASJ,EAAMf,OACxCQ,KAAKY,YAAc9C,OAAO6C,SAASJ,EAAMX,QACzCI,KAAK0H,YAAc,GAAAN,GAAArK,QAAY,KAAM,KAAMwC,EAAQS,KAAKU,WAAYV,KAAKY,aACzEZ,KAAK2H,WACL3H,KAAK4H,iBACL5H,KAAK6H,UACL7H,KAAK8H,aACL9H,KAAK+H,aACL/H,KAAKgI,QAAU,KACfhI,KAAKiI,WAAa,KAClBjI,KAAKH,SAAU,EACfG,KAAKF,UAAW,EAChBE,KAAKD,WAAY,GAEjB,EAAApB,EAAA5B,SAAwBiD,MACtBkI,aACEvK,MAAOqC,KAAKU,YAEdyH,cACExK,MAAOqC,KAAKY,eLusCjB,OAxsBA,EAAI7B,EAAchC,SAAS0K,IACzBrG,IAAK,OACLzD,MAAO,SKjULd,EAAKyE,EAAOhC,EAAMuD,GACrB,OAAQvD,GACN,IAAKH,GAAApC,QAAMc,IACTmC,KAAKoI,QAAQvL,EAAKyE,EAAOhC,EAAMuD,EAC/B,MACF,KAAK1D,GAAApC,QAAMiB,MACTgC,KAAKqI,UAAUxL,EAAKyE,EAAOhC,EAAMuD,GAMrC7C,KAAKsI,aAGLtI,KAAKuI,YLmUJnH,IAAK,UACLzD,MAAO,SKjUFd,EAAKyE,EAAOhC,GAClB,GAAKU,KAAKH,QAAV,CAGA,GAAMuB,GAAMqG,EAAee,OAAOlJ,EAAMgC,EAAMmH,KAAK3C,EAAGxE,EAAMmH,KAAK1C,EAAGzE,EAAMmH,KAAKzC,GAC3E0C,QACJ,IAAI1I,KAAK4H,cAAce,QAAQvH,MAAS,EAAI,CAC1C,GAAM7B,GAASa,SAASC,cAAc,SACtCqI,GAAS,GAAAtB,GAAArK,QAAYuE,EAAOhC,EAAKsJ,WAAYrJ,EAAQS,KAAKU,WAAYV,KAAKY,YAAaZ,KAAKH,QAASG,KAAKF,SAAUE,KAAKD,WAC1HC,KAAK4H,cAAciB,KAAKzH,GACpBpB,KAAKiI,YAAgE,gBAAlDR,EAAeqB,cAAc9I,KAAKiI,aAAiCjI,KAAK2H,QAAQ3H,KAAKiI,cAC1GS,EAAOxI,SAAU,EAAA4G,EAAA/J,YAAkBiD,KAAK2H,QAAQ3H,KAAKiI,cAEvDjI,KAAKiI,WAAa,SAElBS,GAAS1I,KAAK2H,QAAQvG,EAExBsH,GAAOK,WAAWlM,GAClBmD,KAAK2H,QAAQvG,GAAOsH,EACpB1I,KAAKgI,QAAU5G,MLoUdA,IAAK,YACLzD,MAAO,SKlUAd,EAAKyE,EAAOhC,EAAMuD,GAC1B,GAAK7C,KAAKF,SAAV,CAGA,GAAMsB,GAAMqG,EAAee,OAAOlJ,EAAMgC,EAAMmH,KAAK3C,EAAGxE,EAAMmH,KAAK1C,EAAGzE,EAAMmH,KAAKzC,GACzEgD,EAAqBvB,EAAewB,eAAe7H,GAEnD8H,EAAYlJ,KAAK4H,cAAcuB,OAAO,SAAAC,GAAA,MAAyC,kBAApC3B,EAAeqB,cAAcM,KAAwBC,IAAI,SAAAD,GAAA,MAAK3B,GAAe6B,SAAS7B,EAAewB,eAAeG,KACrKF,GAAUL,KAAKpB,EAAe6B,SAASN,GAEvC,IAAMO,GAAcvJ,KAAKwJ,aAAa3M,EAAKgG,GACvC4G,IACJA,GAASA,EAAOhE,OAAO8D,EAAYG,KAAKL,IAAI,SAAAD,GAAA,MAAK3B,GAAewB,eAAeG,MAC/EK,EAASA,EAAOhE,OAAO8D,EAAYI,QAAQN,IAAI,SAAAD,GAAA,MAAK3B,GAAewB,eAAeG,MAClFK,EAASA,EAAON,OAAO,SAACC,EAAGpH,EAAG4H,GAAP,MAAgBA,GAAKjB,QAAQS,KAAOpH,GAU3D,KAHA,GAAM6H,MACFC,GAAO,IAEE,CACX,GAAMC,GAAMN,EAAOd,QAAQK,EAAoBc,EAAO,EACtD,IAAIC,KAAQ,EACV,KAEFF,GAAYhB,KAAKkB,GACjBD,EAAOC,EAOT,IAAK,GAJCC,MAEAC,EAAexC,EAAe6B,SAASN,GACvChD,GAAI,EAAAqB,EAAAZ,UAASwD,GACVjI,EAAI,EAAGA,EAAIyH,EAAO/J,OAAQsC,GAAK,EAAG,CACzC,GAAMJ,IAAI,EAAAyF,EAAAZ,UAASgB,EAAe6B,SAASG,EAAOzH,IAClDkI,SAAQC,IAAI,QACZD,QAAQC,IAAIlI,KAAKmI,IAAIxI,EAAE,GAAKoE,EAAE,KAG9BkE,QAAQC,IAAIjD,EAAAnK,QAAKsN,SAASC,WAAW1I,EAAE,GAAIA,EAAE,KAAMoE,EAAE,GAAIA,EAAE,MAC3DkE,QAAQC,IAAIjD,EAAAnK,QAAKsN,SAASC,UAAU7C,EAAe6B,SAASG,EAAOzH,IAAKiI,IAGpEhI,KAAKmI,IAAIxI,EAAE,GAAKoE,EAAE,IAAM,KAAOkB,EAAAnK,QAAKsN,SAASC,WAAW1I,EAAE,GAAIA,EAAE,KAAMoE,EAAE,GAAIA,EAAE,KAAO,IAGzFgE,EAAWnB,KAAK7G,GAGlB,GAAI0G,SAIK,KAAKa,EAAYI,QAAQjK,OAAS,GAAK6J,EAAYG,KAAKhK,OAAS,IAAMsK,EAAWtK,OAAS,GAAKsK,EAAWtK,SAAWmK,EAAYnK,OAEzI,GAAI6J,EAAYG,KAAKhK,OAAS,EAAG,CAG/B,IAAK,GAFD6K,GAAY,EACZC,EAAY,IACPxI,EAAI,EAAGA,EAAIuH,EAAYG,KAAKhK,OAAQsC,GAAK,EAAG,CACnD,GAAMyI,GAAIvD,EAAAnK,QAAKsN,SAASC,UAAU7C,EAAe6B,SAAS7B,EAAewB,eAAeM,EAAYG,KAAK1H,KAAMiI,EAC3GQ,GAAID,IACND,EAAYvI,EACZwI,EAAYC,GAGhB/B,EAAS1I,KAAK2H,QAAQ4B,EAAYG,KAAKa,GAEvC,KAAK,GADDG,IAAU,EACL1I,EAAI,EAAGA,EAAIuH,EAAYI,QAAQjK,OAAQsC,GAAK,EAAG,CACtD,GAAMyI,GAAIvD,EAAAnK,QAAKsN,SAASC,UAAU7C,EAAe6B,SAAS7B,EAAewB,eAAeM,EAAYI,QAAQ3H,KAAMiI,EAC9GQ,GAAID,IACND,EAAYvI,EACZwI,EAAYC,EACZC,GAAU,GAGVA,IACFhC,EAAS1I,KAAK2H,QAAQ4B,EAAYI,QAAQY,KAS5C7B,EAAOiC,kBAAkB9N,GACzBmD,KAAKgI,QAAUuB,EAAYG,KAAKM,EAAW,QACtC,CAGL,IAAK,GAFDO,GAAY,EACZC,EAAY,IACPxI,EAAI,EAAGA,EAAIuH,EAAYI,QAAQjK,OAAQsC,GAAK,EAAG,CACtD,GAAMyI,GAAIvD,EAAAnK,QAAKsN,SAASC,UAAU7C,EAAe6B,SAAS7B,EAAewB,eAAeM,EAAYI,QAAQ3H,KAAMiI,EAClHC,SAAQC,IAAIM,GACRA,EAAID,IACNN,QAAQC,IAAI,UACZI,EAAYvI,EACZwI,EAAYC,GAGhB/B,EAAS1I,KAAK2H,QAAQ4B,EAAYI,QAAQY,IAQ1C7B,EAAOiC,kBAAkB9N,GACzBmD,KAAKgI,QAAUuB,EAAYI,QAAQK,EAAW,QAE3C,KAAKT,EAAYG,KAAKhK,OAAS,GAAK6J,EAAYI,QAAQjK,OAAS,IAAMmK,EAAYnK,OAAS,EAEjG,GAAI6J,EAAYG,KAAKhK,OAAS,EAAG,CAQ/B,IAAK,GAAIsC,GAAI,EAAGA,EAAIuH,EAAYG,KAAKhK,OAAQsC,GAAK,EAAG,CACnD,GAAM4I,GAAMrB,EAAYG,KAAK1H,EACzByF,GAAewB,eAAe2B,KAAS5B,IAGtCN,GAILA,EAAOmC,eAAe7K,KAAK2H,QAAQiD,UAC5B5K,MAAK2H,QAAQiD,GACpB5K,KAAK4H,cAAckD,OAAO9K,KAAK4H,cAAce,QAAQiC,GAAM,IALzDlC,EAAS1I,KAAK2H,QAAQ4B,EAAYG,KAAK1H,KAQ3C,IAAK0G,EACH,IAAK,GAAI1G,GAAI,EAAGA,EAAIuH,EAAYI,QAAQjK,OAAQsC,GAAK,EAAG,CACtD,GAAM4I,GAAMrB,EAAYI,QAAQ3H,EAC5ByF,GAAewB,eAAe2B,KAAS5B,IAGtCN,GAILA,EAAOmC,eAAe7K,KAAK2H,QAAQiD,UAC5B5K,MAAK2H,QAAQiD,GACpB5K,KAAK4H,cAAckD,OAAO9K,KAAK4H,cAAce,QAAQiC,GAAM,IALzDlC,EAAS1I,KAAK2H,QAAQ4B,EAAYI,QAAQ3H,KAQhD0G,EAAOK,WAAWlM,GAClBmD,KAAKgI,QAAUuB,EAAYG,KAAKG,EAAY,QACvC,CACL,IAAK,GAAI7H,GAAI,EAAGA,EAAIuH,EAAYI,QAAQjK,OAAQsC,GAAK,EAAG,CACtD,GAAM4I,GAAMrB,EAAYI,QAAQ3H,EAC5ByF,GAAewB,eAAe2B,KAAS5B,IAGtCN,GAILA,EAAOmC,eAAe7K,KAAK2H,QAAQiD,UAC5B5K,MAAK2H,QAAQiD,GACpB5K,KAAK4H,cAAckD,OAAO9K,KAAK4H,cAAce,QAAQiC,GAAM,IALzDlC,EAAS1I,KAAK2H,QAAQ4B,EAAYI,QAAQ3H,KAa9C0G,EAAOK,WAAWlM,GAClBmD,KAAKgI,QAAUuB,EAAYI,QAAQE,EAAY,QAE5C,CACL,GAAMtK,GAASa,SAASC,cAAc,SACtCqI,GAAS,GAAAtB,GAAArK,QAAYuE,EAAOhC,EAAKsJ,WAAYrJ,EAAQS,KAAKU,WAAYV,KAAKY,YAAaZ,KAAKH,QAASG,KAAKF,SAAUE,KAAKD,WAC1H2I,EAAOK,WAAWlM,GAClBmD,KAAK4H,cAAciB,KAAKzH,GACxBpB,KAAK2H,QAAQvG,GAAOsH,EACpB1I,KAAKgI,QAAU5G,EACXpB,KAAKiI,YAAgE,kBAAlDR,EAAeqB,cAAc9I,KAAKiI,aAAmCjI,KAAK2H,QAAQ3H,KAAKiI,cAC5GS,EAAOxI,SAAU,EAAA4G,EAAA/J,YAAkBiD,KAAK2H,QAAQ3H,KAAKiI,cAEvDjI,KAAKiI,WAAa,UL4SnB7G,IAAK,QACLzD,MAAO,SKzSJd,EAAKyE,EAAOhC,EAAMuD,EAAWzB,GACjC,GAAKA,EAAL,CAGA,GAAIA,EAAIuH,QAAQ,eAAgB,EAAI,CAClC,GAAMD,GAAS1I,KAAK2H,QAAQvG,EAC5BsH,GAAOqC,YAAYlO,GACnBmD,KAAKgI,QAAU5G,MACV,CACL,GAAM4J,GAAI5J,EAAI6J,MAAM,YAAY,GAC1BvC,EAAS1I,KAAK2H,QAAQqD,EAC5BtC,GAAOwC,mBAAmBrO,GAC1BmD,KAAKgI,QAAUgD,EAGjBhL,KAAKuI,SACLvI,KAAKsI,iBL4SJlH,IAAK,SACLzD,MAAO,SK1SHkF,GACL7C,KAAK6H,UACL7H,KAAK0H,YAAYyD,MAAMtI,EAFP,IAAAuI,IAAA,EAAAC,GAAA,EAAAC,EAAA3L,MAAA,KAGhB,OAAA4L,GAAAC,GAAA,EAAA5E,EAAA7J,SAAkBiD,KAAK4H,iBAAvBwD,GAAAG,EAAAC,EAAAC,QAAAC,MAAAN,GAAA,EAAsC,CAIpC,IAJoC,GAA3BhK,GAA2BmK,EAAA5N,MAC9B2B,EAAOmI,EAAeqB,cAAc1H,GACtCsH,EAAS1I,KAAK2H,QAAQvG,GACpB0G,KACCY,EAAOxI,SACZ4H,EAAUe,KAAKH,EAAOxI,QAAQD,KAC9ByI,EAASA,EAAOxI,OAElBF,MAAK6H,OAAOgB,MACV5I,IAAKD,KAAK2H,QAAQvG,GAAKuK,SACvB7D,eAEY,gBAATxI,GAA0BU,KAAKH,SACrB,kBAATP,IAA6BU,KAAKF,UAAYE,KAAKD,aACvDC,KAAK0H,YAAYqB,WAAW/I,KAAK2H,QAAQvG,GAAMyB,IAjBnC,MAAA+I,GAAAP,GAAA,EAAAC,EAAAM,EAAA,aAAAR,GAAAI,EAAAK,QAAAL,EAAAK,SAAA,WAAAR,EAAA,KAAAC,IAoBhBtL,KAAK6H,OAAS7H,KAAK6H,OAAOiE,aLkUzB1K,IAAK,aACLzD,MAAO,WKhUG,GAAAoO,GAAA/L,KACLgM,EAAK5L,SAASC,cAAc,SAClC2L,GAAGzL,MAAMf,MAAQQ,KAAKU,WACtBsL,EAAGzL,MAAMX,OAASI,KAAKY,WACvB,IAAMqL,GAAK,GAAA7E,GAAArK,QAAY,KAAM,KAAMiP,EAAIhM,KAAKU,WAAa6G,EAAUvH,KAAKY,YAAc2G,GAChF2E,EAAOD,EAAG1M,OAAOuB,WAAW,MAE5BqL,EAAK/L,SAASC,cAAc,SAClC8L,GAAG5L,MAAMf,MAAQQ,KAAKU,WACtByL,EAAG5L,MAAMX,OAASI,KAAKY,WACvB,IAAMwL,GAAK,GAAAhF,GAAArK,QAAY,KAAM,KAAMoP,EAAInM,KAAKU,WAAa6G,EAAUvH,KAAKY,YAAc2G,GAChFpE,EAAOiJ,EAAG7M,OAAOuB,WAAW,KAElCd,MAAK4H,cAAcyE,KAAK,SAACC,EAAMC,GAC7B,GAAMC,GAAKT,EAAKpE,QAAQ2E,GAClBG,EAAKV,EAAKpE,QAAQ4E,GAClBG,EAAQJ,EAAKrB,MAAM,KAAK,GACxB0B,EAAQJ,EAAKtB,MAAM,KAAK,EAC9B,IAAIyB,IAAUC,EACZ,MAAiB,gBAAVD,EAA0B,GAAI,CAGvC,IAAME,GAAcN,EAAd,IAAsBC,EACxB3H,EAAQmH,EAAKhE,UAAU6E,EAC3B,IAAIhI,GAAS0H,IAASP,EAAK/D,SAAWuE,IAASR,EAAK/D,QAClD,MAAOpD,EAGT,IAAMiI,GAAML,EAAGjN,OACTuN,EAAML,EAAGlN,MAEf2M,GAAKpK,yBAA2B,cAChCoK,EAAKpJ,UAAU+J,EAAK,EAAG,EAAGd,EAAKrL,WAAa6G,EAAUwE,EAAKnL,YAAc2G,GACzE2E,EAAKpK,yBAA2B,YAChCoK,EAAKa,UAAY,OACjBb,EAAKc,SAAS,EAAG,EAAGjB,EAAKrL,WAAa6G,EAAUwE,EAAKnL,YAAc2G,GAEnEpE,EAAKrB,yBAA2B,cAChCqB,EAAKL,UAAUgK,EAAK,EAAG,EAAGf,EAAKrL,WAAa6G,EAAUwE,EAAKnL,YAAc2G,GACzEpE,EAAKrB,yBAA2B,YAChCqB,EAAK4J,UAAY,OACjB5J,EAAK6J,SAAS,EAAG,EAAGjB,EAAKrL,WAAa6G,EAAUwE,EAAKnL,YAAc2G,GAEnEpE,EAAKrB,yBAA2B,MAChCqB,EAAKL,UAAUkJ,EAAI,EAAG,EAAGD,EAAKrL,WAAa6G,EAAUwE,EAAKnL,YAAc2G,EAExE,IAAM0F,GAAU9J,EAAKY,aAAa,EAAG,EAAGqI,EAAG7M,OAAOC,MAAO4M,EAAG7M,OAAOK,QAAQ4E,KAjCrC0I,EAmCvBzF,EAAe0F,YAC5BF,EACAb,EAAG7M,OAAOC,MACV4M,EAAG7M,OAAOK,SACR,IAAK,EAAG,IAAK,EAAG,EAAG,OAvCewN,GAAA,EAAA3O,EAAA1B,SAAAmQ,EAAA,GAmC/BtL,EAnC+BwL,EAAA,GAmC5BpH,EAnC4BoH,EAAA,EA+CtC,OALAnB,GAAGd,QACHiB,EAAGjB,QAEHvG,EAAQhD,EAAIoE,GAAI,EAAK,EACrB+F,EAAKhE,UAAU6E,GAAYhI,EACpBA,OLoURxD,IAAK,eACLzD,MAAO,SKjUGd,EAAKgG,GAChB,GAAMwK,IACJ3D,QACAC,WAGF,KAAK3J,KAAKF,SACR,MAAOuN,EAGT,IAAMrB,GAAK5L,SAASC,cAAc,SAClC2L,GAAGzL,MAAMf,MAAQQ,KAAKU,WACtBsL,EAAGzL,MAAMX,OAASI,KAAKY,WACvB,IAAMqL,GAAK,GAAA7E,GAAArK,QAAY,KAAM,KAAMiP,EAAIhM,KAAKU,WAAa6G,EAAUvH,KAAKY,YAAc2G,GAAU,GAAO,GAAM,GACvG2E,EAAOD,EAAG1M,OAAOuB,WAAW,KAElCoL,GAAKpK,yBAA2B,cAChCoK,EAAKpJ,UAAUjG,EAAI0C,OAAQ,EAAG,EAAGS,KAAKU,WAAa6G,EAAUvH,KAAKY,YAAc2G,GAChF2E,EAAKpK,yBAA2B,YAChCoK,EAAKa,UAAY,OACjBb,EAAKc,SAAS,EAAG,EAAGhN,KAAKU,WAAa6G,EAAUvH,KAAKY,YAAc2G,EAEnE,IAAM4E,GAAK/L,SAASC,cAAc,SAClC8L,GAAG5L,MAAMf,MAAQQ,KAAKU,WACtByL,EAAG5L,MAAMX,OAASI,KAAKY,WAIvB,KAAK,GAHCwL,GAAK,GAAAhF,GAAArK,QAAY,KAAM,KAAMoP,EAAInM,KAAKU,WAAa6G,EAAUvH,KAAKY,YAAc2G,GAAU,GAAO,GAAM,GACvGpE,EAAOiJ,EAAG7M,OAAOuB,WAAW,MAEzBkB,EAAI,EAAGA,EAAIhC,KAAK4H,cAAclI,OAAQsC,GAAK,EAAG,CACrD,GAAMZ,GAAMpB,KAAK4H,cAAc5F,EAC/B,IAA0C,gBAAtCyF,EAAeqB,cAAc1H,GAAjC,CAGA,GAAMsH,GAAS1I,KAAK2H,QAAQ3H,KAAK4H,cAAc5F,GAE/CmB,GAAKrB,yBAA2B,cAChCqB,EAAKL,UAAU4F,EAAOnJ,OAAQ,EAAG,EAAGS,KAAKU,WAAa6G,EAAUvH,KAAKY,YAAc2G,GACnFpE,EAAKrB,yBAA2B,YAChCqB,EAAK4J,UAAY,OACjB5J,EAAK6J,SAAS,EAAG,EAAGhN,KAAKU,WAAa6G,EAAUvH,KAAKY,YAAc2G,GAEnEpE,EAAKrB,yBAA2B,aAChCqB,EAAKL,UAAUkJ,EAAI,EAAG,EAAGhM,KAAKU,WAAa6G,EAAUvH,KAAKY,YAAc2G,EAExE,IAAM0F,GAAU9J,EAAKY,aAAa,EAAG,EAAGqI,EAAG7M,OAAOC,MAAO4M,EAAG7M,OAAOK,QAAQ4E,KAhBtB8I,EAkBnC7F,EAAe0F,YAC/BF,EACAb,EAAG7M,OAAOC,MACV4M,EAAG7M,OAAOK,SACR,IAAK,EAAG,IAAK,IAAK,EAAG,MAAO,EAAG,EAAG,MACpCiD,GAvBmD0K,GAAA,EAAA9O,EAAA1B,SAAAuQ,EAAA,GAkB9C1L,EAlB8C2L,EAAA,GAkB3CvH,EAlB2CuH,EAAA,GAkBxCzI,EAlBwCyI,EAAA,EA0BrDnB,GAAGjB,QAEO,IAANvJ,GAAiB,IAANoE,GAAiB,IAANlB,EACxBuI,EAAO1D,QAAQd,KAAKzH,GACJ,IAANQ,GAAiB,IAANkD,GAAkB,IAANkB,GACjCqH,EAAO3D,KAAKb,KAAKzH,IAGrB,MAAOiM,MLkUNjM,IAAK,QACLzD,MAAO,SKhUJ6P,GACJ,GAAMP,GAAUjN,KAAK0H,YAAYnI,OAAOuB,WAAW,MAAMiD,aAAa,EAAG,EAAG/D,KAAK0H,YAAYnI,OAAOC,MAAOQ,KAAK0H,YAAYnI,OAAOK,QAAQ4E,IAC3I,OAAOiD,GAAegG,WAAWR,EAASO,EAAOxN,KAAK0H,YAAYnI,OAAOC,ULmUxE4B,IAAK,YACLzD,MAAO,SKjUA+P,GACR,IAAK,GAAI1L,GAAIhC,KAAK4H,cAAclI,OAAS,EAAGsC,GAAK,EAAGA,GAAK,EAAG,CAC1D,GAAMZ,GAAMpB,KAAK4H,cAAc5F,GACzB0G,EAAS1I,KAAK2H,QAAQvG,GACtBd,EAAUoI,EAAOpI,QAAQQ,WAAW,MAAMiD,aAAa,EAAG,EAAG2E,EAAOpI,QAAQd,MAAOkJ,EAAOpI,QAAQV,QAAQ4E,IAChH,IAAIxE,KAAKD,WAAa0H,EAAekG,YAAYrN,EAASoN,EAAQhF,EAAOpI,QAAQd,OAC/E,MAAU4B,GAAV,UAEF,IAAMjB,GAAQuI,EAAOvI,MAAMW,WAAW,MAAMiD,aAAa,EAAG,EAAG2E,EAAOvI,MAAMX,MAAOkJ,EAAOvI,MAAMP,QAAQ4E,KAClGgC,GAAKkC,EAAOpJ,MAAyB,gBAAhBoJ,EAAOpJ,MAA0BoJ,EAAO7I,SAA6B,kBAAhB6I,EAAOpJ,MAA4BoJ,EAAO5I,QAC1H,IAAI0G,GAAKiB,EAAekG,YAAYxN,EAAOuN,EAAQhF,EAAOvI,MAAMX,OAC9D,MAAO4B,OLuUVA,IAAK,WACLzD,MAAO,WK9TRqC,KAAK2H,WACL3H,KAAK8H,aACL9H,KAAK6H,aLkUJzG,IAAK,OACLzD,MAAO,WK/TRqC,KAAK2H,QAAU3H,KAAK8H,UAAU9H,KAAK8H,UAAUpI,OAAS,MLmUrD0B,IAAK,WACLzD,MAAO,SKjUDiQ,EAAUC,GAMjB,IAAK,GALCnO,GAASM,KAAK4H,cAAclI,OAC5B0B,EAAMpB,KAAK4H,cAAclI,EAASkO,EAAW,GAC7CrO,EAASa,SAASC,cAAc,UAChCqI,EAAS,GAAAtB,GAAArK,QAAY,KAAM0K,EAAeqB,cAAc1H,GAAM7B,EAAQS,KAAKU,WAAYV,KAAKY,aAC9FV,EAAUF,KAAK2H,QAAQvG,GAAKlB,QACvB8B,EAAI,EAAGA,EAAI6L,EAAY7L,GAAK,EACnC9B,EAAUA,EAAQA,OAEpBwI,GAAOmC,eAAe3K,GACtBwI,EAAOxI,SAAU,EAAA4G,EAAA/J,YAAkBiD,KAAK2H,QAAQvG,IAChDpB,KAAK2H,QAAQvG,GAAOsH,EACpB1I,KAAKuI,YLoUJnH,IAAK,eACLzD,MAAO,SKlUGqG,EAAKC,EAAMC,GACtBlE,KAAKH,QAAUmE,EACfhE,KAAKF,SAAWmE,EAChBjE,KAAKD,UAAYmE,CACjB,KAAK,GAAIlC,GAAI,EAAGA,EAAIhC,KAAK4H,cAAclI,OAAQsC,GAAK,EAClDhC,KAAK2H,QAAQ3H,KAAK4H,cAAc5F,IAAI8L,aAAa9J,EAAKC,EAAMC,EAE9DlE,MAAKuI,cLqUJnH,IAAK,SACLzD,MAAO,SK78BI2B,EAAMwG,EAAGC,EAAGC,GACxBwB,GAAc,CACd,IAAMuC,GAAMzK,IAASH,EAAApC,QAAMc,IAAM,EAAI2J,CACrC,OAAUlI,GAAKsJ,WAAf,IAA6B9C,EAA7B,IAAkCC,EAAlC,IAAuCC,EAAvC,IAA4C+D,KLg9B3C3I,IAAK,gBACLzD,MAAO,SK98BWyD,GACnB,MAAOA,GAAI6J,MAAM,KAAK,MLi9BrB7J,IAAK,iBACLzD,MAAO,SK/8BYyD,GACpB,MAAOA,GAAI6J,MAAM,KAAKH,OAAO,EAAG,GAAG9F,KAAK,QLk9BvC5D,IAAK,WACLzD,MAAO,SKh9BMoQ,GACd,MAAOA,GAAY9C,MAAM,KAAK5B,IAAI,SAAAD,GAAA,MAAKzI,UAASyI,EAAG,SLq9BlDhI,IAAK,qBACLzD,MAAO,SKn9BgBqQ,EAAIC,EAAIC,EAAIzD,GACpC,GAAMrB,GAAInH,KAAKoE,MAAM2H,GACf1H,EAAIrE,KAAKoE,MAAM4H,GACfrK,EAAI3B,KAAKoE,MAAM6H,GACfpI,EAAI2E,EAAkB,GAAdnE,EAAI1C,EAAKwF,IACjBrD,EAAI0E,EAAmB,GAAdnE,EAAI1C,EAAKwF,GAAU,GAC5BpD,EAAIyE,EAAmB,GAAdnE,EAAI1C,EAAKwF,GAAU,GAC5BxH,EAAI6I,EAAmB,GAAdnE,EAAI1C,EAAKwF,GAAU,EAClC,QAAQtD,EAAGC,EAAGC,EAAGpE,MLs9BhBR,IAAK,cACLzD,MAAO,SKp9BSsP,EAASzN,EAAOI,EAAQuO,EAAcC,GACvD,GAAMC,GAAO,GAAIC,OAAMH,EAAazO,OACpC2O,GAAKE,KAAK,EACV,IAAI3K,GAAIpE,EACJqE,EAAIjE,EACJ4O,EAAK,EACLC,EAAK,CACLL,KACFxK,GAAMwK,EAAMnL,GAAKmL,EAAMrL,IAAMwE,EAAYzJ,OAAOiD,iBAChD8C,GAAMuK,EAAMlL,GAAKkL,EAAMpL,IAAMuE,EAAYzJ,OAAOiD,iBAChDyN,EAAMJ,EAAMrL,GAAKwE,EAAYzJ,OAAOiD,iBACpC0N,EAAML,EAAMpL,GAAKuE,EAAYzJ,OAAOiD,iBAEtC,KAAK,GAAIiB,GAAI,EAAGA,EAAIsF,EAAoBtF,GAAK,EAI3C,IAAK,GAHCoH,GAAInH,KAAKoE,MAAOpE,KAAKyM,UAAY9K,EAAI,GAAM4K,GAC3ClI,EAAIrE,KAAKoE,MAAOpE,KAAKyM,UAAY7K,EAAI,GAAM4K,GAC3CvI,EAAIuB,EAAekH,mBAAmBvF,EAAG9C,EAAGrE,KAAKoE,MAAM7G,GAAQyN,GAC5D2B,EAAI,EAAGA,EAAIT,EAAazO,OAAQkP,GAAK,EAAG,CAC/C,GAAM9J,GAAIqJ,EAAaS,EACnB1I,GAAE,KAAOpB,EAAE,IAAMoB,EAAE,KAAOpB,EAAE,IAAMoB,EAAE,KAAOpB,EAAE,KAC/CuJ,EAAKO,IAAM,GAIjB,MAAOP,MLu9BNjN,IAAK,cACLzD,MAAO,SKr9BSsP,EAASS,EAAQlO,GAAO,GAAAqP,IAAA,EAAAC,GAAA,EAAAC,EAAApP,MAAA,KACzC,OAAAqP,GAAAC,GAAA,EAAArI,EAAA7J,SAAoB2Q,KAApBmB,GAAAG,EAAAC,EAAAxD,QAAAC,MAAAmD,GAAA,EAA4B,IAAjBrB,GAAiBwB,EAAArR,MACpBuI,EAAIuB,EAAekH,mBAAmBnB,EAAM,GAAIA,EAAM,GAAIvL,KAAKoE,MAAM7G,GAAQyN,EACnF,IAAe,IAAT/G,EAAE,IAAqB,IAATA,EAAE,IAAqB,IAATA,EAAE,IAAqB,IAATA,EAAE,GAChD,OAAO,GAJ8B,MAAA0F,GAAAkD,GAAA,EAAAC,EAAAnD,EAAA,aAAAiD,GAAAI,EAAApD,QAAAoD,EAAApD,SAAA,WAAAiD,EAAA,KAAAC,IAOzC,OAAO,KL8+BN3N,IAAK,aACLzD,MAAO,SK5+BQsP,EAASS,EAAQlO,GAAO,GAAA0P,IAAA,EAAAC,GAAA,EAAAC,EAAAzP,MAAA,KACxC,OAAA0P,GAAAC,GAAA,EAAA1I,EAAA7J,SAAoB2Q,KAApBwB,GAAAG,EAAAC,EAAA7D,QAAAC,MAAAwD,GAAA,EAA4B,IAAjB1B,GAAiB6B,EAAA1R,MACpBuI,EAAIuB,EAAekH,mBAAmBnB,EAAM,GAAIA,EAAM,GAAIvL,KAAKoE,MAAM7G,GAAQyN,EACnF,IAAe,IAAT/G,EAAE,IAAqB,IAATA,EAAE,IAAqB,IAATA,EAAE,IAAqB,IAATA,EAAE,GAChD,MAAOA,IAJ6B,MAAA0F,GAAAuD,GAAA,EAAAC,EAAAxD,EAAA,aAAAsD,GAAAI,EAAAzD,QAAAyD,EAAAzD,SAAA,WAAAsD,EAAA,KAAAC,IAOxC,MAAO,SLqgCNhO,IAAK,IACLzD,MAAO,SKngCD4R,EAAKC,GAIZ,IAAK,GAHDnC,MACEoC,GAAO,KAAM,MACbC,GAAQC,OAAOC,kBAAmBD,OAAOC,mBACtC5N,EAAI,EAAGA,EAAI,EAAGA,GAAK,EAC1B,KAAIuN,EAAIM,YAAY7N,GAAGtC,OAAS,GAAhC,CAIA,GAAMoQ,IAAK,EAAA9I,EAAAjK,SAAOwS,EAAIM,YAAY7N,GAAI,GAClC+N,IACJA,GAASA,EAAOtK,OAAO8J,EAAIM,YAAY7N,IACvC+N,EAASA,EAAOtK,OAAO8J,EAAIM,YAAY,EAAI7N,GAC3C,KAAK,GAAI4M,GAAI,EAAGA,EAAIW,EAAIM,YAAY,EAAI7N,GAAGtC,OAAQkP,GAAK,EACtDkB,EAAGE,SAASnH,KAAK,EAGnB,IAAMoH,GAAMxI,EAAeyI,WAAWH,EAAQD,EAC1CG,GAAIE,IAAMX,IACZE,EAAK1N,GAAKiO,EAAIE,IACdV,EAAIzN,GAAK8N,GAIb,GAAIJ,EAAK,GAAKF,GAAUE,EAAK,GAAKF,EAChC,IAAK,GAAIxN,GAAI,EAAGA,EAAI,EAAGA,GAAK,EAC1B,GAAI0N,EAAK1N,GAAKwN,EAAQ,CAGpB,IAAK,GAFCM,GAAKL,EAAIzN,GACTgO,EAAW,GAAI1B,OAAM,GAClBtD,EAAI,EAAGA,EAAI8E,EAAGE,SAAStQ,OAAQsL,GAAK,EACtCgF,EAASF,EAAGE,SAAShF,MACxBgF,EAASF,EAAGE,SAAShF,QAEvBgF,EAASF,EAAGE,SAAShF,IAAInC,KAAK0G,EAAIM,YAAY7N,GAAGgJ,GAEnD8E,GAAGP,IAAMA,EAAIM,YAAY7N,GACzB8N,EAAGD,YAAcG,EACjB3C,EAASA,EAAO5H,OAAOgC,EAAegD,EAAEqF,EAAIJ,EAAK1N,SAEjDqL,GAAOxE,KAAK0G,EAAIM,YAAY7N,QAIhCqL,GAAOxE,QAAQpD,OAAO8J,EAAIM,YAAY,GAAIN,EAAIM,YAAY,IAE5D,OAAOxC,MLqgCNjM,IAAK,SACLzD,MAAO,SKngCI4R,GACZ,GAAIA,EAAI7P,OAAS,EACf,OAAQ6P,EAIV,KAAK,GAFCO,IAAK,EAAA9I,EAAAjK,SAAOwS,EAAK,GACjBS,EAAW,GAAI1B,OAAM,GAClBtM,EAAI,EAAGA,EAAI8N,EAAGE,SAAStQ,OAAQsC,GAAK,EACtCgO,EAASF,EAAGE,SAAShO,MACxBgO,EAASF,EAAGE,SAAShO,QAEvBgO,EAASF,EAAGE,SAAShO,IAAI6G,KAAK0G,EAAIvN,GAEpC,KAAKgO,EAAS,GACZ,OAAQT,EAGVO,GAAGP,IAAMA,EACTO,EAAGD,YAAcG,CACjB,IAAMC,GAAMxI,EAAeyI,WAAWX,EAAKO,GACrCM,EAAc3I,EAAegD,EAAEqF,EAAIG,EAAIE,IAC7C,OAAOC,MLsgCNhP,IAAK,aACLzD,MAAO,SKpgCQ4R,EAAKO,GASrB,IAAK,GARCO,GAAUP,EAAGQ,UAAUjH,IAAI,SAAAD,GAAA,MAAKA,GAAEmH,WAClCC,EAASV,EAAGE,SACZS,EAAIX,EAAGQ,UAAU5Q,OACjBgR,EAAIZ,EAAGQ,UAAUjH,IAAI,SAAAD,GAAA,MAAKA,GAAE7H,OAC5BoP,EAAIpB,EAAI7P,OACR+K,EAAI8E,EAAI,GAAG7P,OAEXsQ,EAAW,GAAI1B,OAAMmC,GAClBzO,EAAI,EAAGA,EAAI8N,EAAGE,SAAStQ,OAAQsC,GAAK,EACtCgO,EAASF,EAAGE,SAAShO,MACxBgO,EAASF,EAAGE,SAAShO,QAEvBgO,EAASF,EAAGE,SAAShO,IAAI6G,KAAK0G,EAAIvN,GAIpC,KAAK,GADD4D,GAAI,EACC5D,EAAI,EAAGA,EAAIyO,EAAGzO,GAAK,EAC1B,IAAK,GAAI4M,GAAI,EAAGA,EAAI+B,EAAG/B,GAAK,EACtB5M,IAAMwO,EAAO5B,KACfhJ,GAAKsB,EAAAnK,QAAKsN,SAASC,UAAUiF,EAAIX,GAAIyB,EAAQrO,IAInD,IAAM4O,GAAS,GAAOD,EAAIF,GAAKhG,EAAK7E,EAC9BiL,EAAY,GAAMJ,EAAIxO,KAAKkI,IAAIwG,IAAMlG,EAAI,EAC/C,KAAKmG,EACH,OAASZ,WAAUK,UAASF,IAAKR,OAAOC,kBAG1C,KAAK,GADDO,GAAM,EACDnO,EAAI,EAAGA,EAAIyO,EAAGzO,GAAK,EAAG,CAC7B,GAAMgE,GAAI0K,EAAE1O,EAGZmO,IAAOnK,EAAI/D,KAAKkI,IAAInE,GAAKA,EAAI/D,KAAKkI,IAAIwG,GAAO3K,EAAIyE,EAAK,EAAKxI,KAAKkI,IAAI,EAAIlI,KAAK6O,GAAKF,IAAW5K,EAAI,GAAKyE,EAAI,EAG5G,MADA0F,IAAOU,GACEb,WAAUK,UAASF,WL0gCtB1I,IAGT/K,GAAQK,QK1jBM0K,GL8jBTsJ,GACA,SAAUtU,EAAQC,EAASC,GAEhC,YA8CA,SAASC,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,QAASF,GA5CvFY,OAAOC,eAAehB,EAAS,cAC7BiB,OAAO,GAGT,IAAIqT,GAAQrU,EAAoB,IAE5BsU,EAASrU,EAAuBoU,GM3qCrCE,EAAAvU,EAAA,KACAK,EAAAL,EAAA,INgrCKM,EAAQL,EAAuBI,GM/qCpCgC,EAAArC,EAAA,INmrCKsC,EAAUrC,EAAuBoC,GMlrCtCmS,EAAAxU,EAAA,KNsrCKyU,EAAgBxU,EAAuBuU,EMrrC5CxU,GAAA,IACA,IAAA0U,GAAA1U,EAAA,KN0rCK2U,EAAa1U,EAAuByU,GMzrCzCE,EAAA5U,EAAA,KN6rCK6U,EAAa5U,EAAuB2U,GM5rCzCE,EAAA9U,EAAA,KNgsCK+U,EAAgB9U,EAAuB6U,GM/rC5CE,EAAAhV,EAAA,INmsCKiV,EAAmBhV,EAAuB+U,GMlsC/CzS,EAAAvC,EAAA,INssCKwC,EAAUvC,EAAuBsC,EMpsCtCjC,GAAAF,QAAA8U,IAAAT,EAAArU,QAEA,IAAAkN,INysCGvI,IMvsCH,UNwsCG+G,MACE3C,EMvsCL,GNwsCKC,EMvsCL,GNwsCKC,EMvsCL,GNwsCKpE,EMtsCL,GNwsCGA,EMvsCH,GAEAkQ,EAAA3S,EAAApC,QAAAc,IACAkU,EAAAD,EACAE,IACAA,GAAA7S,EAAApC,QAAAc,KAAA,EACAmU,EAAA7S,EAAApC,QAAAiB,OAAA,GACAgU,EAAA7S,EAAApC,QAAAkB,QAEA,GNwsCCvB,EAAQK,SACNuB,KMvsCH,MNwsCGhB,YMtsCH2U,OAAAf,EAAAe,OACAC,SAAAZ,EAAAvU,QACAoV,YAAAT,EAAA3U,QAEAqV,SAAAZ,EAAAzU,SNwsCGyH,KAAM,WACJ,OMtsCLyF,eACA6H,cACAC,WACAC,YNwsCOK,eMvsCP1S,ONwsCO2S,YMvsCP,ENwsCOC,cMvsCP5S,ONwsCO6S,WMvsCP7S,ONwsCO8S,SMvsCP9S,ONwsCO+S,UMvsCP/S,ONwsCOgT,YMvsCPhT,ONwsCOE,SMvsCP,ENwsCOC,UMvsCP,ENwsCOC,WMvsCP,ENwsCO6S,aMtsCP,INysCGC,QAAS,WACP/U,OAAOiD,iBMvsCZ,ENwsCKf,KAAKqS,eAAiB,GAAIT,GAAiB7U,QAAQqD,SAAS0S,cMtsCjE,iBNwsCK,IAAIC,GMvsCT,ENwsCSC,EMvsCT,ENwsCSC,EAAU,QAASA,KACrBF,GMvsCP,GNwsCW,GAAIG,OAAOC,UAAYH,EAAY,MACrC5S,SAASgT,MAAQ,SMvsC1BL,EAAA,INwsCSA,EMvsCT,ENwsCSC,GAAY,GAAIlV,QAAOoV,MMvsChCC,WNysCOrV,OAAOuV,sBMvsCdJ,GNysCKnV,QAAOuV,sBMvsCZJ,IN0sCGK,SACEC,SAAU,SAAkBjS,GAC1BtB,KAAKiK,aMxsCZ3I,GN0sCKkS,WAAY,SAAoBlU,GAC9BU,KAAK+R,SAAW/R,KMxsCvB8R,YNysCO9R,KAAK8R,YAAc3S,EAAQpC,QAAQsB,SMxsC1CiB,GNysCOU,KAAKyT,MAAMC,OAAOC,SAAS3T,KAAKgS,UAAUhS,KAAK8R,cAAc,GMxsCpE,IN0sCK8B,aAAc,SAAsBrS,GAClCvB,KAAKgS,UAAUhS,KAAK8R,aMxsC3BvQ,GN0sCKsS,eAAgB,SAAwBvS,GACtCtB,KAAKyT,MAAMK,YAAYC,aACrBrS,IAAKzC,EAAQlC,QAAQkI,IAAI3D,GMxsClCI,MNysCS+G,MACE3C,EAAGxE,EMxsCd,GNysCWyE,EAAGzE,EMxsCd,GNysCW0E,EAAG1E,EMxsCd,GNysCWM,EMvsCX,GNysCSA,EMvsCT,KN0sCKoS,UAAW,WACThU,KAAKqS,eAAiB,GAAIT,GAAiB7U,QAAQqD,SAAS0S,cMxsCnE,kBNysCO9S,KAAKiK,aMxsCZA,ENysCOjK,KAAK8R,YMxsCZA,ENysCO9R,KAAKyT,MAAMC,OAAOC,SAAS3T,KAAKsS,aAAa,GMxsCpD,INysCO,EAAIrB,EAAOlU,SAASiD,KAAKyT,MAAMQ,YAAYC,IAAIC,UAAU9K,IAAI,SAAUD,GACrE,MAAOA,GAAEgL,UAAUC,OMxsC5B,eN2sCOrU,KAAKyT,MAAMa,UAAUJ,IAAIE,UAAUG,IM1sC1C,aN2sCOvU,KAAKH,SM1sCZ,EN2sCOG,KAAKF,UM1sCZ,EN2sCOE,KAAKD,WM1sCZ,EN2sCOC,KAAK4S,aM1sCZ,GN4sCK4B,QAAS,SAAiBC,GACxB,GAAIzU,KAAKqS,eM1sChB,CN2sCS,GAAI3S,GAASM,KAAKqS,eAAezK,cM1sC1ClI,ON2sCauI,EAAajI,KAAKqS,eAAezK,cAAckD,OAAOpL,EAAS+U,EAAQ,EAAG,GM1sCvF,EN2sCSzU,MAAKqS,eAAepK,WM1sC7BA,EN2sCSjI,KAAKqS,eM1sCd9J,WN6sCKmM,SAAU,SAAkB9G,EAAUC,GACpC7N,KAAKqS,eAAeqC,SAAS9G,EM1sCpCC,IN4sCK8G,gBAAiB,WACf3U,KAAKyT,MAAMmB,UAAUjB,SAAS,IAAI,GM1sCzC,GN2sCO3T,KAAKyT,MAAMoB,UAAUlB,SAAS,IAAI,GM1sCzC,GN2sCO3T,KAAKyT,MAAMqB,UAAUnB,SAAS,IAAI,GM1sCzC,GN2sCO3T,KAAKyT,MAAMsB,YM1sClBC,QN4sCKC,iBAAkB,WAChB,GAAI9U,GAAQ,GAAIoE,mBAAkBvE,KAAK0S,UM1sC9ClO,KN2sCOrE,GAAMsE,IAAIzE,KM1sCjB0S,UN2sCO,IAAIhO,GAAK,GAAI5G,QM1sCpB6G,UACAxE,EAAAH,KAAAwS,WAAArS,MAAAX,MAAAQ,KAAAwS,WAAArS,MAEAP,ONwsCOI,MAAKwS,WAAWrS,MAAMW,WAAW,MAAMgD,aAAaY,EAAI,EMvsC/D,ENwsCO,IAAIpE,GAAU,GAAIiE,mBAAkBvE,KAAK2S,YMvsChDnO,KNwsCOlE,GAAQmE,IAAIzE,KMvsCnB2S,YNwsCO,IAAIuC,GAAK,GAAIpX,QMvsCpB6G,UACArE,EAAAN,KAAAwS,WAAAlS,QAAAd,MAAAQ,KAAAwS,WAAAlS,QAEAV,ONqsCOI,MAAKwS,WAAWlS,QAAQQ,WAAW,MAAMgD,aAAaoR,EAAI,EMpsCjE,GNqsCOlV,KAAKwS,WAAWvS,IMpsCvB,KNqsCOD,KAAKwS,WMpsCZpP,eNqsCOpD,KAAKqS,eMpsCZ9J,SNqsCOvI,KAAKyT,MAAMsB,YMpsClBI,SNssCKC,iBAAkB,WAChB,GAAIC,GAAazD,EAAiB7U,QAAQ+L,cAAc9I,KMpsC/DuS,eACA+C,EAAA1D,EAAA7U,QAAAuM,SAAAsI,EAAA7U,QAAAkM,eAAAjJ,KACAuS,gBNosCW1N,EAAW5F,EAAQlC,QAAQkI,IMnsCtCqQ,GAAApQ,OAAAlF,KAAAyS,SACAtN,KAAAC,SAAApF,KAAAyS,SACApN,KAAAC,QAAAtF,KAAAyS,SACAlN,KACAN,MACAO,ON+rCOX,GAAWA,EAASwE,IAAI,SAAUD,GAChC,MAAOnH,MAAKsT,MM/rCrBnM,INisCO,IAAIoM,GAAS5D,EAAiB7U,QMhsCrCyL,OACA6M,EAAApT,KAAAsT,MAAA1Q,EACA,IAAA5C,KAAAsT,MAAA1Q,EACA,IAAA5C,KAAAsT,MAAA1Q,EAEA,KN4rCWkF,EAAM/J,KAAKqS,eAAezK,cAAce,QAAQ3I,KM3rC3DuS,cN4rCWxI,MAAQ,IAGZ/J,KAAKqS,eAAezK,cAAcmC,GM3rCzCyL,EN4rCOxV,KAAKqS,eAAe1K,QAAQ6N,GAAUxV,KM3rC7CwS,iBN4rCcxS,MAAKqS,eAAe1K,QAAQ3H,KM3rC1CuS,eN4rCOvS,KAAKqS,eM3rCZ9J,SN4rCOvI,KAAKyT,MAAMsB,YM3rClBI,UN6rCKM,OAAQ,SAAgBC,GACtB1V,KAAKuS,cM3rCZmD,EN4rCO1V,KAAKwS,WAAaxS,KAAKqS,eAAe1K,QM3rC7C+N,GN4rCO1V,KAAKyS,UACHtN,IM3rCT,EN4rCSE,IM3rCT,EN4rCSE,IM1rCT,GN4rCOvF,KAAK0S,UAAY1S,KAAKwS,WAAWrS,MAAMW,WAAW,MAAMiD,aAAa,EAAG,EAAG/D,KAAKwS,WAAWrS,MAAMX,MAAOQ,KAAKwS,WAAWrS,MM3rC/HP,QN4rCOI,KAAK2S,YAAc3S,KAAKwS,WAAWlS,QAAQQ,WAAW,MAAMiD,aAAa,EAAG,EAAG/D,KAAKwS,WAAWlS,QAAQd,MAAOQ,KAAKwS,WAAWlS,QM3rCrIV,QN4rCOI,KM3rCP2U,mBN6rCKgB,YAAa,SAAqBxQ,GAChCnF,KAAKyS,SAAStN,KAAOA,EAAM,IAAM,IM1rCxC,IN2rCOnF,KM1rCP4V,aN4rCKC,YAAa,SAAqBxQ,GAChCrF,KAAKyS,SAASpN,KAAOA,EAAM,IM1rClC,IN2rCOrF,KM1rCP4V,aN4rCKE,YAAa,SAAqBvQ,GAChCvF,KAAKyS,SAASlN,KAAOA,EAAM,IM1rClC,IN2rCOvF,KM1rCP4V,aN4rCKA,UAAW,WACT5V,KAAKwS,WAAWoD,UAAU5V,KAAK0S,UAAW1S,KAAK2S,YAAa3S,KM1rCnEyS,UN2rCOzS,KAAKqS,eM1rCZ9J,UN4rCKwN,gBAAiB,WACf/V,KAAKqS,eAAevE,aAAa9N,KAAKH,QAASG,KAAKF,SAAUE,KM1rCrED,YN4rCKiW,cAAe,WACbhW,KAAK4S,aAAe5S,KM1rC3B4S,gBNisCMqD,GACA,SAAUxZ,EAAQC,EAASC,GAEhC,YAkBA,SAASC,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,QAASF,GAhBvFY,OAAOC,eAAehB,EAAS,cAC7BiB,OAAO,GAGT,IAAIa,GAAkB7B,EAAoB,IAEtC8B,EAAkB7B,EAAuB4B,GO59C9C2I,EAAAxK,EAAA,IPg+CKyK,EAAYxK,EAAuBuK,GO/9CxCjI,EAAAvC,EAAA,IPm+CKwC,EAAUvC,EAAuBsC,GOj+CtCgX,EAAA,SAAAC,GPs+CG,GAAIC,GAAOD,EAAMzN,OOp+CpB2N,wBPq+COC,EAAUH,EAAMG,SAAWH,EAAMI,QAAQ,GOp+ChDD,QPq+COE,EAAUL,EAAMK,SAAWL,EAAMI,QAAQ,GOp+ChDC,OPq+CG,QAAQF,EAAUF,EAAKK,KAAMD,EAAUJ,EOp+C1CM,KPu+CCha,GAAQK,SACNuB,KOp+CH,WPq+CGqY,OOn+CH,gBACA,eACA,YACA,aAEA,mBP+9CGnS,KAAM,WACJ,OACEoS,iBACAC,QO99CP,KP+9COhU,WAAaE,GAAI,EAAGC,GAAI,EAAGC,GAAI,EAAGC,GO99CzC,GP+9CO4T,YO79CPnX,SPg+CGkT,QAAS,WACP7S,KAAKyT,MAAMoD,QAAQE,iBAAiB,WAAY/W,KAAKgX,UO99C1D,GP+9CKhX,KAAKyT,MAAMoD,QAAQE,iBAAiB,OAAQ/W,KAAKiX,MO99CtD,IPi+CG3D,SACE4D,UAAW,SAAmBf,GAC5BA,EO/9CPgB,gBADA,IAAAC,GAAAlB,EAEAC,GPi+CWkB,GAAgB,EAAI5Y,EAAgB1B,SAASqa,EAAc,GAC3DE,EAASD,EAAc,GACvBE,EAASF,EAAc,GOl+ClCG,EAAA,OACAlW,EAAA,MPq+CO,QAAQtB,KOp+Cf8R,aPq+CS,IAAK3S,GAAQpC,QOp+CtBc,IPq+CS,IAAKsB,GAAQpC,QOp+CtBiB,MPq+CS,IAAKmB,GAAQpC,QOp+CtBkB,OPq+CW+B,KAAK6W,QAAU,GAAIzP,GAAUrK,QAAQiD,KAAKiK,aAAc,KAAM7J,SAAS0S,cOp+ClF,YACA,MPq+CS,KAAK3T,GAAQpC,QOp+CtBmB,MAQA,MP69CWoD,GAAQtB,KAAKqS,eAAeoF,QOp+CvCH,EAAAxZ,OACAiD,iBAAAwW,EAAAzZ,OAEAiD,yBPk+CeO,GACFtB,KAAK0X,MAAM,iBOj+CxBpW,GPo+CS,KAAKnC,GAAQpC,QOj+CtBoB,KACA,MPk+CS,KAAKgB,GAAQpC,QOj+CtBqB,MAQA,MP09CWoZ,GAAcxX,KAAKqS,eAAesF,YOj+C7CL,EAAAxZ,OACAiD,iBAAAwW,EAAAzZ,OAEAiD,yBP+9CeyW,GACFxX,KAAK0X,MAAM,SAAUF,EAAYvM,MAAM,YO99CpD,IAGA,SAEA,OP+9CO,GAAI1J,GAAOvB,KAAKgS,UAAUhS,KO99CjC8R,YP+9CO9R,MAAK4W,cAAc/N,MAAMyO,EO99ChCC,IP+9COvX,KAAK6W,QO99CZe,KAAA5X,KACA4W,cAAA5W,KACAiK,aAAAjK,KACA8R,YAGAvQ,GP09COvB,KAAK6C,UAAUE,GAAKuU,EOz9C3B/V,EP09COvB,KAAK6C,UAAUG,GAAKuU,EOz9C3BhW,EP09COvB,KAAK6C,UAAUI,GAAKqU,EOz9C3B/V,EP09COvB,KAAK6C,UAAUK,GAAKqU,EOx9C3BhW,EP09COvB,KAAK6X,mBAAmBP,EAASxZ,OAAOiD,iBAAkBwW,EAASzZ,OOz9C1EiD,mBP29CK+W,UAAW,SAAmB3B,GAE5B,GADAA,EOz9CPgB,iBP09CYnX,KAAK6W,QAAV,CO39CP,GAAAkB,IAAA,EAAAtZ,EAAA1B,SAAAiD,KAAA4W,cAAA5W,KAAA4W,cAAAlX,OAKA,MP29CWsY,EAAUD,EAAe,GACzBE,EAAUF,EAAe,GAEzBG,EAAgBhC,EO79C3BC,GP89CWgC,GAAgB,EAAI1Z,EAAgB1B,SAASmb,EAAe,GAC5DZ,EAASa,EAAc,GACvBZ,EAASY,EAAc,EAE3B,IAAIb,IAAWU,GAAWT,IAAWU,EAArC,CAGA,GAAI1W,GAAOvB,KAAKgS,UAAUhS,KOj+CjC8R,YPk+CO9R,MAAK4W,cAAc/N,MAAMyO,EOj+ChCC,IPk+COvX,KAAK6W,QAAQ1L,MAAMnL,KOj+C1B6C,WPk+CO7C,KAAK6W,QOj+CZe,KAAA5X,KACA4W,cAAA5W,KACAiK,aAAAjK,KACA8R,YAGAvQ,GP69COvB,KAAK6C,UAAUE,GAAKd,KAAKmW,IAAId,EAAS/V,EAAMvB,KAAK6C,UO59CxDE,IP69CO/C,KAAK6C,UAAUG,GAAKf,KAAKmW,IAAIb,EAAShW,EAAMvB,KAAK6C,UO59CxDG,IP69COhD,KAAK6C,UAAUI,GAAKhB,KAAKC,IAAIoV,EAAS/V,EAAMvB,KAAK6C,UO59CxDI,IP69COjD,KAAK6C,UAAUK,GAAKjB,KAAKC,IAAIqV,EAAShW,EAAMvB,KAAK6C,UO39CxDK,IP69COlD,KAAK6X,mBAAmBP,EAASxZ,OAAOiD,iBAAkBwW,EAASzZ,OO59C1EiD,qBP89CKsX,QAAS,SAAiBlC,GAExB,GADAA,EO59CPgB,iBP69CYnX,KAAK6W,QAAV,CAGA,OAAQ7W,KO59Cf8R,aP69CS,IAAK3S,GAAQpC,QO59CtBc,IP69CS,IAAKsB,GAAQpC,QO59CtBiB,MP69CWgC,KAAKqS,eO59ChBuF,KAAA5X,KACA6W,QAAA7W,KACAiK,aAAAjK,KACA8R,YAAA9R,KAEA6C,UACA,MPw9CS,KAAK1D,GAAQpC,QOv9CtBkB,OPw9CW+B,KAAKqS,eOv9ChBiG,MAAAtY,KACA6W,QAAA7W,KACAiK,aAAAjK,KACA8R,YAAA9R,KACA6C,UAAA7C,KAEA8W,YACA,MPk9CS,KAAK3X,GAAQpC,QOj9CtBmB,MACA,MPk9CS,KAAKiB,GAAQpC,QOj9CtBoB,KACA,MACA,SAEA,OPk9CO6B,KAAK6W,QAAQ1L,MAAMnL,KOj9C1B6C,WPk9CO7C,KAAK6W,QOj9CZ,KPk9CO7W,KAAK4W,iBACL5W,KAAK6C,WAAcE,GAAI,EAAGC,GAAI,EAAGC,GAAI,EAAGC,GOj9C/C,GPk9COlD,KAAK8W,YOj9CZnX,OPk9COK,KAAKuY,QAAQb,MOj9CpB,uBPm9CKG,mBAAoB,SAA4BP,EAAQC,GACtD,GAAIhW,GAAOvB,KAAKgS,UAAUhS,KOj9CjC8R,YPk9CO,IAAI9R,KAAK8R,cAAgB3S,EAAQpC,QAAQkB,SAAW+B,KAAK8W,YOj9ChE,CPk9CS,GAAIpJ,KACJA,GAAO7E,MAAMyO,EOj9CtBC,GPk9CS,KAAK,GAAIvV,GAAI,EAAGA,EAAI,GAAIA,GAAK,EAC3B0L,EAAO7E,MOh9ClByO,EAAA,GAAA/V,EAAAU,KAAAuW,IAAA,EAAAvW,KAAA6O,GAAA,GACA9O,GAAAuV,EAAA,GAAAhW,EAAAU,KAAAwW,IAAA,EAAAxW,KAAA6O,GAAA,GAEA9O,IP+8CS,IAAI0G,GAAS1I,KAAKqS,eAAesF,UO78C1CjK,EP88CahF,KACF1I,KAAK8W,YO78ChBpO,KPi9CKsO,SAAU,SAAkBb,GAC1BA,EO78CPgB,kBP+8CKF,KAAM,SAAcd,GO78CzB,GAAApK,GAAA/L,IPg9COmW,GO/8CPgB,gBPg9CO,IAAIuB,GAAOvC,EAAMwC,aAAaC,MO/8CrC,EPg9CO,IAAkB,cAAdF,EAAKG,MAAsC,eAAdH,EAAKG,KAAtC,CAIA,GAAIC,GAAS,GO/8CpBC,WPg9COD,GAAOE,OAAS,WACd,GAAIC,GAAQ7Y,SAASC,cO/8C9B,MPg9CS4Y,GAAMC,aAAa,MAAOJ,EO/8CnCzL,QPg9CStB,EAAM8K,QAAU,GAAIzP,GAAUrK,QAAQgP,EAAM9B,aAAc,KAAM7J,SAAS0S,cO/8ClF,aPg9CS/G,EAAM8K,QAAQ9N,YAAaxJ,OO/8CpC0Z,IPg9CSlN,EAAMsG,eO/8CfuF,KAAA7L,EACA8K,QAAA9K,EACA9B,aAAA8B,EACA+F,YAAA/F,EAEAlJ,YP48COiW,EAAOK,cO18CdT,QPi9CMU,GACA,SAAU3c,EAAQC,GAEvB,YAEAe,QAAOC,eAAehB,EAAS,cAC7BiB,OAAO,IAETjB,EAAQK,SACNuB,KQppDH,cRqpDGqY,OQlpDH,URmpDGnS,KAAM,WACJ,OACE6U,QAAQ,IAIZ/F,SACEnI,MAAO,SAAesJ,GACpBzU,KAAK0X,MAAM,UQnpDlBjD,IRqpDK6E,UAAW,SAAmB7E,GAC5BzU,KAAKqZ,OQnpDZ5E,GRqpDK8E,WAAY,SAAoB9E,GAC1BA,IAAUzU,KAAKqZ,SACjBrZ,KAAKqZ,QAAS,IAGlB3E,SAAU,SAAkB9G,EAAUC,GACpC7N,KAAK0X,MAAM,WAAY9J,EQnpD9BC,OR0pDM2L,GACA,SAAU/c,EAAQC,EAASC,GAEhC,YAUA,SAASC,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,QAASF,GARvFY,OAAOC,eAAehB,EAAS,cAC7BiB,OAAO,GSlrDV,IAAA8b,GAAA9c,EAAA,KTurDK+c,EAAgB9c,EAAuB6c,EAI3C/c,GAAQK,SACNuB,KS1rDH,WT2rDGqY,OSxrDH,gBTyrDGnS,KAAM,WACJ,OACEmV,aSxrDP,ETyrDOhc,MAAOqC,KSxrDd4Z,aTyrDOC,USxrDP,ETyrDOC,USvrDP,OT0rDGjH,QAAS,WACP7S,KAAKyT,MAAMsG,MAAMxZ,MAAMkW,KAAOzW,KSvrDnCrC,MAAA,ITyrDKqC,KAAK8Z,UAAY,GAAIJ,GAAc3c,QAAQiD,KAAKyT,MAAMsG,OACpDC,YAAaha,KAAKyT,MSxrDzBwG,UTyrDOC,KStrDP,MTyrDKla,KAAK8Z,UAAUK,GAAG,YAAana,KSxrDpCoa,WTyrDKpa,KAAK8Z,UAAUK,GAAG,WAAYna,KSxrDnCqa,UTyrDKra,KAAK8Z,UAAUK,GAAG,UAAWna,KSxrDlCsa,UT2rDGhH,SACEiH,YAAa,SAAqBC,GAChC,GAAIC,GAAiBza,KAAKyT,MAAMC,OSxrDvC2C,wBT0rDWqE,GAAYF,EAAElE,QAAUmE,EAAehE,MAAQgE,EAAejb,MSxrDzE,GT0rDOQ,MAAK2T,SAAS+G,GSxrDrB,GT0rDWF,EAAE9R,SAAW1I,KAAKyT,MAAMsG,OAC1B/Z,KAAK8Z,UAAUa,aAAaH,ESxrDrCA,GT2rDOxa,KAAKyT,MAAMC,OSxrDlBkH,ST0rDKR,UAAW,WACTpa,KAAK6Z,USvrDZ,ETwrDO7Z,KAAKyT,MAAMC,OSvrDlBkH,STyrDKP,SAAU,WACR,GAAIjR,GAAIpJ,KAAK8Z,UAAUe,SSvrD9BzR,ETwrDWsR,EAAWtR,EAAIpJ,KAAKyT,MAAMC,OAAO2C,wBAAwB7W,MStrDpE,GTwrDOQ,MAAK2T,SSvrDZ+G,ITyrDKJ,QAAS,WACPta,KAAK6Z,USvrDZ,GTyrDKiB,UAAW,WACU,MAAf9a,KAAKrC,OAITqC,KAAK2T,SAAS3T,KAAKrC,MAAQqC,KAAK2Z,cSvrDvC,ITyrDKoB,UAAW,WACU,IAAf/a,KAAKrC,OAITqC,KAAK2T,SAAS3T,KAAKrC,MAAQqC,KAAK2Z,cSvrDvC,ITyrDKhG,SAAU,SAAkB+G,EAAUM,GSvrD3C,GAAAC,KAAAxb,UAAAC,OAAA,GAAAC,SAAAF,UAAA,KAAAA,UAAA,ET0rDO,IAAIib,IAAa1a,KAAKrC,MAAtB,CAIA,GAAIud,GAAiBjZ,KAAKoE,MSxrDjCqU,ET0rDWQ,IAAkB,MACpBA,ESzrDT,KT4rDWA,GAAkB,IACpBA,ESzrDT,GT4rDOlb,KAAKrC,MSxrDZud,ET0rDWF,IACFhb,KAAKyT,MAAMsG,MAAMxZ,MAAMkW,KAAOzW,KSzrDvCrC,MAAA,KT2rDWsd,GACFjb,KAAK0X,MAAM,eAAgB1X,KSzrDpCrC,YTisDMwd,IACA,SAAU1e,EAAQC,KAMlB0e,IACA,SAAU3e,EAAQC,KAMlB2e,IACA,SAAU5e,EAAQC,KAMlB4e,IACA,SAAU7e,EAAQC,KAMlB6e,IACA,SAAU9e,EAAQC,KAMlB8e,IACA,SAAU/e,EAAQC,EAASC,GUt1DjCA,EAAA,IAEA,IAAA8e,GAAA9e,EAAA,IAEAA,EAAA,IAEAA,EAAA,KAEA,KAEA,KAGAF,GAAAC,QAAA+e,EAAA/e,SV+1DMgf,IACA,SAAUjf,EAAQC,EAASC,GW72DjCA,EAAA,IAEA,IAAA8e,GAAA9e,EAAA,IAEAA,EAAA,IAEAA,EAAA,KAEA,KAEA,KAGAF,GAAAC,QAAA+e,EAAA/e,SXs3DMif,IACA,SAAUlf,EAAQC,EAASC,GYp4DjCA,EAAA,IAEA,IAAA8e,GAAA9e,EAAA,IAEAA,EAAA,IAEAA,EAAA,KAEA,KAEA,KAGAF,GAAAC,QAAA+e,EAAA/e,SZ64DMkf,IACA,SAAUnf,EAAQC,EAASC,Ga35DjCA,EAAA,IAEA,IAAA8e,GAAA9e,EAAA,IAEAA,EAAA,IAEAA,EAAA,KAEA,KAEA,KAGAF,GAAAC,QAAA+e,EAAA/e,Sbo6DMmf,IACA,SAAUpf,EAAQC,Gcp7DxBD,EAAAC,SAAgBof,OAAA,WAAmB,GAAAC,GAAA/b,KAAagc,EAAAD,EAAAE,eAA0BC,EAAAH,EAAAI,MAAAD,IAAAF,CAC1E,OAAAE,GAAA,OACAE,OACAC,GAAA,eAEGH,EAAA,UACHE,OACAC,GAAA,kBAEGN,EAAAO,GAAA,KAAAJ,EAAA,UACHK,IAAA,UACAH,OACAC,GAAA,WAEAlC,IACAjD,UAAA6E,EAAA7E,UACAsF,WAAAT,EAAA7E,UACAY,UAAAiE,EAAAjE,UACA2E,UAAAV,EAAAjE,UACAO,QAAA0D,EAAA1D,QACAqE,SAAAX,EAAA1D;AACAkB,WAAAwC,EAAA1D,cAGCsE,qBd07DKC,IACA,SAAUngB,EAAQC,Gen9DxBD,EAAAC,SAAgBof,OAAA,WAAmB,GAAAC,GAAA/b,KAAagc,EAAAD,EAAAE,eAA0BC,EAAAH,EAAAI,MAAAD,IAAAF,CAC1E,OAAAE,GAAA,OACAK,IAAA,SACAM,YAAA,YACAC,OACA1E,IAAA,IAAA2D,EAAApe,MAAAuE,IAAA,MAAA6Z,EAAApe,MAAAkc,SAAAkC,EAAAlC,UAEAuC,OACAW,SAAA,KAEA5C,IACAjD,UAAA6E,EAAAxB,YACAyC,SAAA,SAAAC,GACA,gBAAAA,KAAAlB,EAAAmB,GAAAD,EAAAE,QAAA,UAAAF,EAAA7b,KACA,UAAA6b,IAAA,IAAAA,EAAAG,OAAwD,MACxDH,EAAA9F,qBACA4E,GAAAhB,UAAAkC,IAHsF,MAI/E,SAAAA,GACP,gBAAAA,KAAAlB,EAAAmB,GAAAD,EAAAE,QAAA,WAAAF,EAAA7b,KACA,UAAA6b,IAAA,IAAAA,EAAAG,OAAwD,MACxDH,EAAA9F,qBACA4E,GAAAjB,UAAAmC,IAHuF,UAMpFf,EAAA,OACHK,IAAA,YACAM,YAAA,0BACGd,EAAAO,GAAA,KAAAJ,EAAA,OACHW,YAAA,sBACGX,EAAA,OACHW,YAAA,8BACGX,EAAA,OACHW,YAAA,oBACGd,EAAAO,GAAA,KAAAJ,EAAA,OACHW,YAAA,uBACAtc,OACAf,MAAAuc,EAAApe,MAAA,SAEGoe,EAAAO,GAAA,KAAAJ,EAAA,OACHK,IAAA,QACAM,YAAA,8BACGX,EAAA,OACHW,YAAA,yBACGd,EAAAO,GAAA,KAAAJ,EAAA,OACHK,IAAA,cACAM,YAAA,2BAECF,qBfy9DKU,IACA,SAAU5gB,EAAQC,GgBzgExBD,EAAAC,SAAgBof,OAAA,WAAmB,GAAAC,GAAA/b,KAAagc,EAAAD,EAAAE,eAA0BC,EAAAH,EAAAI,MAAAD,IAAAF,CAC1E,OAAAE,GAAA,OACAE,OACAC,GAAA,SAEGH,EAAA,aACHE,OACAkB,gBAAAvB,EAAA9R,aACAsT,eAAAxB,EAAAjK,YACA0L,YAAAzB,EAAAhK,SACA0L,aAAA1B,EAAA/J,UACA0L,kBAAA3B,EAAA1J,gBAEA8H,IACA1E,OAAAsG,EAAAtG,OACA5B,eAAAkI,EAAAlI,kBAEGkI,EAAAO,GAAA,KAAAJ,EAAA,OACHyB,aACArf,KAAA,OACAsf,QAAA,SACAjgB,MAAAoe,EAAA,YACA8B,WAAA,gBAEAhB,YAAA,YACGX,EAAA,UACHK,IAAA,cACAH,OACAC,GAAA,gBAEAlC,IACA2D,eAAA/B,EAAAxI,UAEAwK,OACApgB,MAAAoe,EAAA,aACAiC,SAAA,SAAAC,GACAlC,EAAA9R,aAAAgU,GAEAJ,WAAA,kBAEG9B,EAAAO,GAAA,KAAAJ,EAAA,aACHK,IAAA,SACAH,OACAxC,aAAAmC,EAAAzJ,aAEA6H,IACA+D,eAAAnC,EAAAnI,iBAEG,GAAAmI,EAAAO,GAAA,KAAAJ,EAAA,OACHE,OACAC,GAAA,eAEGN,EAAA,eAAAG,EAAA,iBACHW,YAAA,aACAT,OACAvU,OAAAkU,EAAA1J,eAAAxK,QAEAsS,IACA3F,QAAAuH,EAAAvH,QACAE,SAAAqH,EAAArH,YAEGqH,EAAAoC,KAAApC,EAAAO,GAAA,KAAAJ,EAAA,OACHE,OACAC,GAAA,oBAEGH,EAAA,aACH/B,IACAiE,OAAArC,EAAAhG,iBAEAgI,OACApgB,MAAAoe,EAAA,QACAiC,SAAA,SAAAC,GACAlC,EAAAlc,QAAAoe,GAEAJ,WAAA,aAEG9B,EAAAO,GAAA,WAAAP,EAAAO,GAAA,KAAAJ,EAAA,aACH/B,IACAiE,OAAArC,EAAAhG,iBAEAgI,OACApgB,MAAAoe,EAAA,SACAiC,SAAA,SAAAC,GACAlC,EAAAjc,SAAAme,GAEAJ,WAAA,cAEG9B,EAAAO,GAAA,aAAAP,EAAAO,GAAA,KAAAJ,EAAA,aACH/B,IACAiE,OAAArC,EAAAhG,iBAEAgI,OACApgB,MAAAoe,EAAA,UACAiC,SAAA,SAAAC,GACAlC,EAAAhc,UAAAke,GAEAJ,WAAA,eAEG9B,EAAAO,GAAA,qBAAAP,EAAAO,GAAA,KAAAJ,EAAA,OACHE,OACAC,GAAA,gBAEGH,EAAA,aACHW,YAAA,SACA1C,IACAkE,MAAAtC,EAAA/H,aAEGkI,EAAA,WAAAH,EAAAO,GAAA,kBAAAP,EAAAO,GAAA,KAAAJ,EAAA,aACHW,YAAA,iBACA1C,IACAkE,MAAAtC,EAAA/F,iBAEGkG,EAAA,WAAAH,EAAAO,GAAA,qBAAAP,EAAAO,GAAA,KAAAJ,EAAA,OACHE,OACAC,GAAA,cAEGH,EAAA,oBACHK,IAAA,cACAM,YAAA,YACAT,OACAkC,YAAA,MAEGpC,EAAA,aACHK,IAAA,YACAM,YAAA,2BACA1C,IACAkE,MAAA,SAAApB,GACAlB,EAAAvI,WAAA,WAGG0I,EAAA,WAAAH,EAAAO,GAAA,cAAAP,EAAAO,GAAA,KAAAJ,EAAA,aACHK,IAAA,cACAM,YAAA,iBACA1C,IACAkE,MAAA,SAAApB,GACAlB,EAAAvI,WAAA,aAGG0I,EAAA,WAAAH,EAAAO,GAAA,eAAAP,EAAAO,GAAA,KAAAJ,EAAA,aACHW,YAAA,iBACA1C,IACAkE,MAAA,SAAApB,GACAlB,EAAAvI,WAAA,cAGG0I,EAAA,WAAAH,EAAAO,GAAA,wBAAAP,EAAAO,GAAA,KAAAJ,EAAA,aACHW,YAAA,iBACA1C,IACAkE,MAAA,SAAApB,GACAlB,EAAAvI,WAAA,aAGG0I,EAAA,WAAAH,EAAAO,GAAA,kBAAAP,EAAAO,GAAA,KAAAJ,EAAA,aACHW,YAAA,iBACA1C,IACAkE,MAAA,SAAApB,GACAlB,EAAAvI,WAAA,aAGG0I,EAAA,WAAAH,EAAAO,GAAA,sBAAAP,EAAAO,GAAA,KAAAJ,EAAA,aACHK,IAAA,cACAH,OACAC,GAAA,kBAEGH,EAAA,mBAAAH,EAAAO,GAAA,UAAAP,EAAAO,GAAA,KAAAJ,EAAA,qBAAAH,EAAAO,GAAA,uBAAAJ,EAAA,aACHK,IAAA,YACAH,OACAxC,aAAA,IAEAO,IACA+D,eAAAnC,EAAApG,eAEGoG,EAAAO,GAAA,sBAAAJ,EAAA,aACHK,IAAA,YACAH,OACAxC,aAAA,IAEAO,IACA+D,eAAAnC,EAAAlG,eAEGkG,EAAAO,GAAA,uBAAAJ,EAAA,aACHK,IAAA,YACAH,OACAxC,aAAA,IAEAO,IACA+D,eAAAnC,EAAAjG,gBAEG,GAAAiG,EAAAO,GAAA,KAAAJ,EAAA,qBAAAA,EAAA,aACHW,YAAA,aACA1C,IACAkE,MAAAtC,EAAA9G,oBAEG8G,EAAAO,GAAA,WAAAP,EAAAO,GAAA,KAAAJ,EAAA,aACHW,YAAA,aACA1C,IACAkE,MAAAtC,EAAA3G,oBAEG2G,EAAAO,GAAA,qBACFK,qBhB+gEK4B,IACA,SAAU9hB,EAAQC,GiBvtExBD,EAAAC,SAAgBof,OAAA,WAAmB,GAAAC,GAAA/b,KAAagc,EAAAD,EAAAE,eAA0BC,EAAAH,EAAAI,MAAAD,IAAAF,CAC1E,OAAAE,GAAA,OACAE,OACAC,GAAA,mBAEGN,EAAA,OAAAG,EAAA,KAAAH,EAAAyC,GAAAzC,EAAA,gBAAA0C,EAAAzc,GACH,MAAAka,GAAA,MACA/B,IACAb,UAAA,SAAA2D,GACAlB,EAAAzC,UAAAtX,IAEAuX,WAAA,SAAA0D,GACAlB,EAAAxC,WAAAvX,OAGKka,EAAA,aACL/B,IACAkE,MAAA,SAAApB,GACAlB,EAAA5Q,MAAAnJ,OAGKka,EAAA,WAAAH,EAAAO,GAAA,eAAAP,EAAAO,GAAA,KAAAJ,EAAA,OACLE,OACAsC,IAAAD,EAAAxe,OAEK8b,EAAAO,GAAA,KAAAmC,EAAA3W,WAAAiU,EAAA1C,SAAArX,EAAAka,EAAA,KAAAH,EAAAyC,GAAAC,EAAA,mBAAAve,EAAA0O,GACL,MAAAsN,GAAA,MACAyC,aACAC,QAAA,YAEO1C,EAAA,OACPE,OACAsC,IAAAxe,GAEAia,IACAkE,MAAA,SAAApB,GACAlB,EAAArH,SAAA1S,EAAA4M,YAIKmN,EAAAoC,MAAA,MACFpC,EAAAoC,QACFxB","file":"static/js/app.73294db1681dae71608e.js","sourcesContent":["webpackJsonp([2,0],{\n\n/***/ 0:\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _vue = __webpack_require__(24);\n\t\n\tvar _vue2 = _interopRequireDefault(_vue);\n\t\n\tvar _App = __webpack_require__(176);\n\t\n\tvar _App2 = _interopRequireDefault(_App);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tnew _vue2.default({\n\t  el: '#app',\n\t  template: '<App/>',\n\t  components: { App: _App2.default }\n\t});\n\n/***/ }),\n\n/***/ 10:\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\tvar tools = {\n\t  PEN: window.Symbol('PEN'),\n\t  BRUSH: window.Symbol('BRUSH'),\n\t  ERASER: window.Symbol('ERASER'),\n\t  SPOIT: window.Symbol('SPOIT'),\n\t  FILL: window.Symbol('FILL'),\n\t  COLOR: window.Symbol('COLOR'),\n\t  fromName: function fromName(name) {\n\t    switch (name) {\n\t      case 'pen':\n\t        return tools.PEN;\n\t      case 'brush':\n\t        return tools.BRUSH;\n\t      case 'eraser':\n\t        return tools.ERASER;\n\t      case 'spoit':\n\t        return tools.SPOIT;\n\t      case 'fill':\n\t        return tools.FILL;\n\t      case 'color':\n\t        return tools.COLOR;\n\t      default:\n\t        return undefined;\n\t    }\n\t  }\n\t};\n\t\n\texports.default = tools;\n\n/***/ }),\n\n/***/ 25:\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _slicedToArray2 = __webpack_require__(14);\n\t\n\tvar _slicedToArray3 = _interopRequireDefault(_slicedToArray2);\n\t\n\tvar _defineProperties = __webpack_require__(27);\n\t\n\tvar _defineProperties2 = _interopRequireDefault(_defineProperties);\n\t\n\tvar _classCallCheck2 = __webpack_require__(28);\n\t\n\tvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\t\n\tvar _createClass2 = __webpack_require__(29);\n\t\n\tvar _createClass3 = _interopRequireDefault(_createClass2);\n\t\n\tvar _color = __webpack_require__(32);\n\t\n\tvar _color2 = _interopRequireDefault(_color);\n\t\n\tvar _Tools = __webpack_require__(10);\n\t\n\tvar _Tools2 = _interopRequireDefault(_Tools);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar Drawing = function () {\n\t  function Drawing(mainColor, tool, canvas) {\n\t    var width = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n\t    var height = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 0;\n\t    var showPen = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : true;\n\t    var showBase = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : true;\n\t    var showExtra = arguments.length > 7 && arguments[7] !== undefined ? arguments[7] : true;\n\t    (0, _classCallCheck3.default)(this, Drawing);\n\t\n\t    this.mainColor = mainColor;\n\t    this.tool = tool;\n\t    this.canvas = canvas;\n\t    this.url = null;\n\t    this.history = null;\n\t    this.shape = document.createElement('canvas');\n\t    this.overlap = document.createElement('canvas');\n\t    this.showPen = showPen;\n\t    this.showBase = showBase;\n\t    this.showExtra = showExtra;\n\t\n\t    if (width === 0 && height === 0) {\n\t      var style = canvas.currentStyle || window.getComputedStyle(canvas);\n\t      this.styleWidth = window.parseInt(style.width);\n\t      this.styleHeight = window.parseInt(style.height);\n\t    } else {\n\t      this.styleWidth = width;\n\t      this.styleHeight = height;\n\t    }\n\t\n\t    var ctx = canvas.getContext('2d');\n\t    this.canvas.width = this.styleWidth * window.devicePixelRatio;\n\t    this.canvas.height = this.styleHeight * window.devicePixelRatio;\n\t    this.canvas.style.width = this.styleWidth;\n\t    this.canvas.style.height = this.styleHeight;\n\t    ctx.scale(window.devicePixelRatio, window.devicePixelRatio);\n\t\n\t    Drawing.setupCanvas(this.canvas, this.styleWidth, this.styleHeight);\n\t    Drawing.setupCanvas(this.shape, this.styleWidth, this.styleHeight);\n\t    Drawing.setupCanvas(this.overlap, this.styleWidth, this.styleHeight);\n\t\n\t    (0, _defineProperties2.default)(this, {\n\t      _mainColor: {\n\t        value: this.mainColor\n\t      },\n\t      _canvas: {\n\t        value: this.canvas\n\t      }\n\t    });\n\t  }\n\t\n\t  (0, _createClass3.default)(Drawing, [{\n\t    key: 'draw',\n\t    value: function draw(path, color, tool, size) {\n\t      if (path.length === 0) {\n\t        return;\n\t      }\n\t\n\t      var ctx = this.canvas.getContext('2d');\n\t      ctx.lineCap = 'round';\n\t      switch (tool) {\n\t        case _Tools2.default.PEN:\n\t        case _Tools2.default.BRUSH:\n\t          ctx.strokeStyle = color.hex;\n\t          ctx.globalAlpha = color.a;\n\t          break;\n\t        case _Tools2.default.ERASER:\n\t          ctx.strokeStyle = '#fff';\n\t          ctx.globalAlpha = 1.0;\n\t          break;\n\t        default:\n\t          return;\n\t      }\n\t      ctx.lineWidth = size;\n\t      ctx.globalCompositeOperation = 'source-over';\n\t\n\t      ctx.beginPath();\n\t      for (var i = 0; i < Math.max(path.length - 1, 1); i += 1) {\n\t        var _path$i = (0, _slicedToArray3.default)(path[i], 2),\n\t            cx = _path$i[0],\n\t            cy = _path$i[1];\n\t\n\t        var _ref = path[i + 1] || path[i],\n\t            _ref2 = (0, _slicedToArray3.default)(_ref, 2),\n\t            nx = _ref2[0],\n\t            ny = _ref2[1];\n\t\n\t        ctx.moveTo(cx, cy);\n\t        ctx.lineTo(nx, ny);\n\t      }\n\t      ctx.stroke();\n\t\n\t      this.url = null;\n\t    }\n\t  }, {\n\t    key: 'drawObjectComp',\n\t    value: function drawObjectComp(obj, editRange) {\n\t      var ctx = this.shape.getContext('2d');\n\t      if (editRange) {\n\t        ctx.drawImage(obj.shape, editRange.lx * window.devicePixelRatio, editRange.ly * window.devicePixelRatio, (editRange.rx - editRange.lx) * window.devicePixelRatio, (editRange.ry - editRange.ly) * window.devicePixelRatio, editRange.lx, editRange.ly, editRange.rx - editRange.lx, editRange.ry - editRange.ly);\n\t      } else {\n\t        ctx.drawImage(obj.shape, 0, 0, this.styleWidth, this.styleHeight);\n\t      }\n\t      var ctx2 = this.overlap.getContext('2d');\n\t      if (editRange) {\n\t        ctx2.drawImage(obj.canvas, editRange.lx * window.devicePixelRatio, editRange.ly * window.devicePixelRatio, (editRange.rx - editRange.lx) * window.devicePixelRatio, (editRange.ry - editRange.ly) * window.devicePixelRatio, editRange.lx, editRange.ly, editRange.rx - editRange.lx, editRange.ry - editRange.ly);\n\t      } else {\n\t        ctx2.drawImage(obj.overlap, 0, 0, this.styleWidth, this.styleHeight);\n\t      }\n\t      this.updateCanvas();\n\t      this.url = null;\n\t    }\n\t  }, {\n\t    key: 'drawObject',\n\t    value: function drawObject(obj, editRange) {\n\t      if (this.tool) {\n\t        if (this.tool === 'Symbol(PEN)' && !this.showPen) {\n\t          return;\n\t        }\n\t        if (this.tool === 'Symbol(BRUSH)' && !this.showBase) {\n\t          return;\n\t        }\n\t      }\n\t      var ctx = this.shape.getContext('2d');\n\t      if (editRange) {\n\t        ctx.drawImage(obj.canvas, editRange.lx * window.devicePixelRatio, editRange.ly * window.devicePixelRatio, (editRange.rx - editRange.lx) * window.devicePixelRatio, (editRange.ry - editRange.ly) * window.devicePixelRatio, editRange.lx, editRange.ly, editRange.rx - editRange.lx, editRange.ry - editRange.ly);\n\t      } else {\n\t        ctx.drawImage(obj.canvas, 0, 0, this.styleWidth, this.styleHeight);\n\t      }\n\t      this.updateCanvas();\n\t      this.url = null;\n\t    }\n\t  }, {\n\t    key: 'drawOverlapObject',\n\t    value: function drawOverlapObject(obj, editRange) {\n\t      if (!this.showExtra) {\n\t        return;\n\t      }\n\t      var ctx = this.overlap.getContext('2d');\n\t      if (editRange) {\n\t        ctx.drawImage(obj.canvas, editRange.lx * window.devicePixelRatio, editRange.ly * window.devicePixelRatio, (editRange.rx - editRange.lx) * window.devicePixelRatio, (editRange.ry - editRange.ly) * window.devicePixelRatio, editRange.lx, editRange.ly, editRange.rx - editRange.lx, editRange.ry - editRange.ly);\n\t      } else {\n\t        ctx.drawImage(obj.canvas, 0, 0, this.styleWidth, this.styleHeight);\n\t      }\n\t      this.updateCanvas();\n\t      this.url = null;\n\t    }\n\t  }, {\n\t    key: 'eraseObject',\n\t    value: function eraseObject(obj) {\n\t      if (this.tool) {\n\t        if (this.tool === 'Symbol(PEN)' && !this.showPen) {\n\t          return;\n\t        }\n\t        if (this.tool === 'Symbol(BRUSH)' && !this.showBase) {\n\t          return;\n\t        }\n\t      }\n\t      var ctx = this.shape.getContext('2d');\n\t\n\t      ctx.globalCompositeOperation = 'destination-out';\n\t      ctx.drawImage(obj.canvas, 0, 0, this.styleWidth, this.styleHeight);\n\t      ctx.globalCompositeOperation = 'source-over';\n\t\n\t      this.updateCanvas();\n\t      this.url = null;\n\t    }\n\t  }, {\n\t    key: 'eraseOverlapObject',\n\t    value: function eraseOverlapObject(obj) {\n\t      if (!this.showExtra) {\n\t        return;\n\t      }\n\t      var ctx = this.overlap.getContext('2d');\n\t\n\t      ctx.globalCompositeOperation = 'destination-out';\n\t      ctx.drawImage(obj.canvas, 0, 0, this.styleWidth, this.styleHeight);\n\t      ctx.globalCompositeOperation = 'source-over';\n\t\n\t      this.canvas.getContext('2d').clearRect(0, 0, this.styleWidth, this.styleHeight);\n\t      this.updateCanvas();\n\t      this.url = null;\n\t    }\n\t  }, {\n\t    key: 'clear',\n\t    value: function clear(editRange) {\n\t      var ctx = this.canvas.getContext('2d');\n\t      if (editRange) {\n\t        ctx.clearRect(editRange.lx, editRange.ly, editRange.rx - editRange.lx, editRange.ry - editRange.ly);\n\t      } else {\n\t        ctx.clearRect(0, 0, this.styleWidth, this.styleHeight);\n\t      }\n\t      var ctx2 = this.shape.getContext('2d');\n\t      if (editRange) {\n\t        ctx2.clearRect(editRange.lx, editRange.ly, editRange.rx - editRange.lx, editRange.ry - editRange.ly);\n\t      } else {\n\t        ctx2.clearRect(0, 0, this.styleWidth, this.styleHeight);\n\t      }\n\t      var ctx3 = this.shape.getContext('2d');\n\t      if (editRange) {\n\t        ctx3.clearRect(editRange.lx, editRange.ly, editRange.rx - editRange.lx, editRange.ry - editRange.ly);\n\t      } else {\n\t        ctx3.clearRect(0, 0, this.styleWidth, this.styleHeight);\n\t      }\n\t      this.url = null;\n\t    }\n\t  }, {\n\t    key: 'colorTune',\n\t    value: function colorTune(origShape, origOverlap, info) {\n\t      Drawing.tune(origShape, this.shape, info);\n\t      Drawing.tune(origOverlap, this.overlap, info);\n\t      this.updateCanvas();\n\t      this.url = null;\n\t    }\n\t  }, {\n\t    key: 'updateCanvas',\n\t    value: function updateCanvas(editRange) {\n\t      var ctxOrig = this.canvas.getContext('2d');\n\t      if (!this.tool || this.tool === 'Symbol(PEN)' && this.showPen || this.tool === 'Symbol(BRUSH)' && this.showBase) {\n\t        if (editRange) {\n\t          var w = (editRange.rx - editRange.lx) * window.devicePixelRatio;\n\t          var h = (editRange.ry - editRange.ly) * window.devicePixelRatio;\n\t          ctxOrig.putImageData(this.shape.getContext('2d').getImageData(editRange.lx, editRange.ly, w, h), editRange.lx, editRange.ly);\n\t        } else {\n\t          ctxOrig.putImageData(this.shape.getContext('2d').getImageData(0, 0, this.shape.width, this.shape.height), 0, 0);\n\t        }\n\t        ctxOrig.globalCompositeOperation = 'source-atop';\n\t      }\n\t      if (this.tool === 'Symbol(BRUSH)' && this.showExtra) {\n\t        ctxOrig.drawImage(this.overlap, 0, 0, this.styleWidth, this.styleHeight);\n\t      }\n\t      ctxOrig.globalCompositeOperation = 'source-over';\n\t    }\n\t  }, {\n\t    key: 'changeVisual',\n\t    value: function changeVisual(pen, base, extra) {\n\t      this.showPen = pen;\n\t      this.showBase = base;\n\t      this.showExtra = extra;\n\t      this.url = null;\n\t      this.canvas.getContext('2d').clearRect(0, 0, this.canvas.width, this.canvas.height);\n\t      this.updateCanvas();\n\t    }\n\t  }, {\n\t    key: 'imageUrl',\n\t    get: function get() {\n\t      if (!this.url) {\n\t        this.url = this.canvas.toDataURL();\n\t      }\n\t      return this.url;\n\t    }\n\t  }], [{\n\t    key: 'setupCanvas',\n\t    value: function setupCanvas(canvas, styleWidth, styleHeight) {\n\t      var ctx = canvas.getContext('2d');\n\t      canvas.width = styleWidth * window.devicePixelRatio;\n\t      canvas.height = styleHeight * window.devicePixelRatio;\n\t      canvas.style.width = styleWidth;\n\t      canvas.style.height = styleHeight;\n\t      ctx.scale(window.devicePixelRatio, window.devicePixelRatio);\n\t    }\n\t  }, {\n\t    key: 'tune',\n\t    value: function tune(orig, canvas, info) {\n\t      var copied = new Uint8ClampedArray(orig.data);\n\t      copied.set(orig);\n\t      var ps = new window.ImageData(copied, canvas.width, canvas.height);\n\t      var cache = {};\n\t      for (var i = 0; i < ps.data.length; i += 4) {\n\t        if (ps.data[i + 3] === 0) {\n\t          continue;\n\t        }\n\t        var newColor = void 0;\n\t        var c = cache[ps.data.slice(i, i + 4).join(',')];\n\t        if (c) {\n\t          newColor = c;\n\t        } else {\n\t          newColor = _color2.default.rgb(ps.data.slice(i, i + 4)).rotate(info.hue).saturate(info.sat).lighten(info.val);\n\t          newColor = newColor.rgb().array();\n\t          cache[ps.data.slice(i, i + 4).join(',')] = [].concat(newColor);\n\t        }\n\t        ps.data[i] = newColor[0];\n\t        ps.data[i + 1] = newColor[1];\n\t        ps.data[i + 2] = newColor[2];\n\t      }\n\t      canvas.getContext('2d').putImageData(ps, 0, 0);\n\t    }\n\t  }]);\n\t  return Drawing;\n\t}();\n\t\n\texports.default = Drawing;\n\n/***/ }),\n\n/***/ 60:\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar hslToYuv = function hslToYuv(h, s, l) {\n\t  h /= 360;\n\t  s /= 100;\n\t  l /= 100;\n\t\n\t  var r = void 0;\n\t  var g = void 0;\n\t  var b = void 0;\n\t\n\t  if (s === 0) {\n\t    r = g = b = l;\n\t  } else {\n\t    var hue2rgb = function hue2rgb(p, q, t) {\n\t      if (t < 0) t += 1;\n\t      if (t > 1) t -= 1;\n\t      if (t < 1 / 6) return p + (q - p) * 6 * t;\n\t      if (t < 1 / 2) return q;\n\t      if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6;\n\t      return p;\n\t    };\n\t\n\t    var q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n\t    var p = 2 * l - q;\n\t    r = hue2rgb(p, q, h + 1 / 3);\n\t    g = hue2rgb(p, q, h);\n\t    b = hue2rgb(p, q, h - 1 / 3);\n\t  }\n\t\n\t  r = Math.round(r * 255);\n\t  g = Math.round(g * 255);\n\t  b = Math.round(b * 255);\n\t\n\t  var y = 0.299 * r + 0.587 * g + 0.114 * b;\n\t  var u = -0.169 * r - 0.331 * g + 0.500 * b;\n\t  var v = 0.500 * r - 0.419 * g - 0.081 * b;\n\t\n\t  return [y, u, v];\n\t};\n\t\n\tvar rgbToYuv = function rgbToYuv(rgb) {\n\t  var r = Math.round(rgb[0]);\n\t  var g = Math.round(rgb[1]);\n\t  var b = Math.round(rgb[2]);\n\t\n\t  var y = 0.299 * r + 0.587 * g + 0.114 * b;\n\t  var u = -0.169 * r - 0.331 * g + 0.500 * b;\n\t  var v = 0.500 * r - 0.419 * g - 0.081 * b;\n\t\n\t  return [y, u, v];\n\t};\n\t\n\texports.hslToYuv = hslToYuv;\n\texports.rgbToYuv = rgbToYuv;\n\n/***/ }),\n\n/***/ 61:\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _slicedToArray2 = __webpack_require__(14);\n\t\n\tvar _slicedToArray3 = _interopRequireDefault(_slicedToArray2);\n\t\n\tvar _getIterator2 = __webpack_require__(26);\n\t\n\tvar _getIterator3 = _interopRequireDefault(_getIterator2);\n\t\n\tvar _assign = __webpack_require__(68);\n\t\n\tvar _assign2 = _interopRequireDefault(_assign);\n\t\n\tvar _defineProperties = __webpack_require__(27);\n\t\n\tvar _defineProperties2 = _interopRequireDefault(_defineProperties);\n\t\n\tvar _classCallCheck2 = __webpack_require__(28);\n\t\n\tvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\t\n\tvar _createClass2 = __webpack_require__(29);\n\t\n\tvar _createClass3 = _interopRequireDefault(_createClass2);\n\t\n\tvar _mlKmeans = __webpack_require__(164);\n\t\n\tvar _mlKmeans2 = _interopRequireDefault(_mlKmeans);\n\t\n\tvar _mlDistance = __webpack_require__(153);\n\t\n\tvar _mlDistance2 = _interopRequireDefault(_mlDistance);\n\t\n\tvar _Drawing = __webpack_require__(25);\n\t\n\tvar _Drawing2 = _interopRequireDefault(_Drawing);\n\t\n\tvar _Tools = __webpack_require__(10);\n\t\n\tvar _Tools2 = _interopRequireDefault(_Tools);\n\t\n\tvar _ColorUtil = __webpack_require__(60);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar MEASURE_ITER_COUNT = 500;\n\tvar SORT_DIV = 1;\n\t\n\tvar layerIndex = 0;\n\t\n\tvar DrawingManager = function () {\n\t  function DrawingManager(canvas) {\n\t    (0, _classCallCheck3.default)(this, DrawingManager);\n\t\n\t    var style = canvas.currentStyle || window.getComputedStyle(canvas);\n\t    this.styleWidth = window.parseInt(style.width);\n\t    this.styleHeight = window.parseInt(style.height);\n\t    this.fixedObject = new _Drawing2.default(null, null, canvas, this.styleWidth, this.styleHeight);\n\t    this.objects = {};\n\t    this.objectIndexes = [];\n\t    this.layers = [];\n\t    this.histories = [];\n\t    this.sortCache = {};\n\t    this.lastKey = null;\n\t    this.clearedKey = null;\n\t    this.showPen = true;\n\t    this.showBase = true;\n\t    this.showExtra = true;\n\t\n\t    (0, _defineProperties2.default)(this, {\n\t      _styleWidth: {\n\t        value: this.styleWidth\n\t      },\n\t      _styleHeight: {\n\t        value: this.styleHeight\n\t      }\n\t    });\n\t  }\n\t\n\t  (0, _createClass3.default)(DrawingManager, [{\n\t    key: 'draw',\n\t    value: function draw(obj, color, tool, editRange) {\n\t      switch (tool) {\n\t        case _Tools2.default.PEN:\n\t          this.drawPen(obj, color, tool, editRange);\n\t          break;\n\t        case _Tools2.default.BRUSH:\n\t          this.drawBrush(obj, color, tool, editRange);\n\t          break;\n\t        default:\n\t          break;\n\t      }\n\t\n\t      this.updateSort();\n\t\n\t      this.update();\n\t    }\n\t  }, {\n\t    key: 'drawPen',\n\t    value: function drawPen(obj, color, tool) {\n\t      if (!this.showPen) {\n\t        return;\n\t      }\n\t      var key = DrawingManager.getKey(tool, color.rgba.r, color.rgba.g, color.rgba.b);\n\t      var target = void 0;\n\t      if (this.objectIndexes.indexOf(key) === -1) {\n\t        var canvas = document.createElement('canvas');\n\t        target = new _Drawing2.default(color, tool.toString(), canvas, this.styleWidth, this.styleHeight, this.showPen, this.showBase, this.showExtra);\n\t        this.objectIndexes.push(key);\n\t        if (this.clearedKey && DrawingManager.getToolString(this.clearedKey) === 'Symbol(PEN)' && this.objects[this.clearedKey]) {\n\t          target.history = (0, _assign2.default)({}, this.objects[this.clearedKey]);\n\t        }\n\t        this.clearedKey = null;\n\t      } else {\n\t        target = this.objects[key];\n\t      }\n\t      target.drawObject(obj);\n\t      this.objects[key] = target;\n\t      this.lastKey = key;\n\t    }\n\t  }, {\n\t    key: 'drawBrush',\n\t    value: function drawBrush(obj, color, tool, editRange) {\n\t      if (!this.showBase) {\n\t        return;\n\t      }\n\t      var key = DrawingManager.getKey(tool, color.rgba.r, color.rgba.g, color.rgba.b);\n\t      var currentColorString = DrawingManager.getColorString(key);\n\t\n\t      var allColors = this.objectIndexes.filter(function (x) {\n\t        return DrawingManager.getToolString(x) === 'Symbol(BRUSH)';\n\t      }).map(function (x) {\n\t        return DrawingManager.getColor(DrawingManager.getColorString(x));\n\t      });\n\t      allColors.push(DrawingManager.getColor(currentColorString));\n\t\n\t      var overlapping = this.checkOverlap(obj, editRange);\n\t      var colors = [];\n\t      colors = colors.concat(overlapping.comp.map(function (x) {\n\t        return DrawingManager.getColorString(x);\n\t      }));\n\t      colors = colors.concat(overlapping.spilled.map(function (x) {\n\t        return DrawingManager.getColorString(x);\n\t      }));\n\t      colors = colors.filter(function (x, i, self) {\n\t        return self.indexOf(x) === i;\n\t      });\n\t\n\t      var sameIndexes = [];\n\t      var last = -1;\n\t\n\t      while (true) {\n\t        var idx = colors.indexOf(currentColorString, last + 1);\n\t        if (idx === -1) {\n\t          break;\n\t        }\n\t        sameIndexes.push(idx);\n\t        last = idx;\n\t      }\n\t\n\t      var simIndexes = [];\n\t\n\t      var currentColor = DrawingManager.getColor(currentColorString);\n\t      var b = (0, _ColorUtil.rgbToYuv)(currentColor);\n\t      for (var i = 0; i < colors.length; i += 1) {\n\t        var a = (0, _ColorUtil.rgbToYuv)(DrawingManager.getColor(colors[i]));\n\t        console.log('----');\n\t        console.log(Math.abs(a[0] - b[0]));\n\t\n\t        console.log(_mlDistance2.default.distance.euclidean([a[1], a[2]], [b[1], b[2]]));\n\t        console.log(_mlDistance2.default.distance.euclidean(DrawingManager.getColor(colors[i]), currentColor));\n\t\n\t        if (Math.abs(a[0] - b[0]) > 100 || _mlDistance2.default.distance.euclidean([a[1], a[2]], [b[1], b[2]]) > 40) {\n\t          continue;\n\t        }\n\t        simIndexes.push(i);\n\t      }\n\t\n\t      var target = void 0;\n\t      if ((overlapping.spilled.length > 0 || overlapping.comp.length > 0) && simIndexes.length > 0 && simIndexes.length !== sameIndexes.length) {\n\t        if (overlapping.comp.length > 0) {\n\t          var targetIdx = 0;\n\t          var minTarget = 10000;\n\t          for (var _i = 0; _i < overlapping.comp.length; _i += 1) {\n\t            var d = _mlDistance2.default.distance.euclidean(DrawingManager.getColor(DrawingManager.getColorString(overlapping.comp[_i])), currentColor);\n\t            if (d < minTarget) {\n\t              targetIdx = _i;\n\t              minTarget = d;\n\t            }\n\t          }\n\t          target = this.objects[overlapping.comp[targetIdx]];\n\t          var changed = false;\n\t          for (var _i2 = 0; _i2 < overlapping.spilled.length; _i2 += 1) {\n\t            var _d = _mlDistance2.default.distance.euclidean(DrawingManager.getColor(DrawingManager.getColorString(overlapping.spilled[_i2])), currentColor);\n\t            if (_d < minTarget) {\n\t              targetIdx = _i2;\n\t              minTarget = _d;\n\t              changed = true;\n\t            }\n\t          }\n\t          if (changed) {\n\t            target = this.objects[overlapping.spilled[targetIdx]];\n\t          }\n\t\n\t          target.drawOverlapObject(obj);\n\t          this.lastKey = overlapping.comp[simIndexes[0]];\n\t        } else {\n\t          var _targetIdx = 0;\n\t          var _minTarget = 10000;\n\t          for (var _i3 = 0; _i3 < overlapping.spilled.length; _i3 += 1) {\n\t            var _d2 = _mlDistance2.default.distance.euclidean(DrawingManager.getColor(DrawingManager.getColorString(overlapping.spilled[_i3])), currentColor);\n\t            console.log(_d2);\n\t            if (_d2 < _minTarget) {\n\t              console.log('min!!!');\n\t              _targetIdx = _i3;\n\t              _minTarget = _d2;\n\t            }\n\t          }\n\t          target = this.objects[overlapping.spilled[_targetIdx]];\n\t\n\t          target.drawOverlapObject(obj);\n\t          this.lastKey = overlapping.spilled[simIndexes[0]];\n\t        }\n\t      } else if ((overlapping.comp.length > 0 || overlapping.spilled.length > 0) && sameIndexes.length > 0) {\n\t        if (overlapping.comp.length > 0) {\n\t          for (var _i4 = 0; _i4 < overlapping.comp.length; _i4 += 1) {\n\t            var sim = overlapping.comp[_i4];\n\t            if (DrawingManager.getColorString(sim) !== currentColorString) {\n\t              continue;\n\t            }\n\t            if (!target) {\n\t              target = this.objects[overlapping.comp[_i4]];\n\t              continue;\n\t            }\n\t            target.drawObjectComp(this.objects[sim]);\n\t            delete this.objects[sim];\n\t            this.objectIndexes.splice(this.objectIndexes.indexOf(sim), 1);\n\t          }\n\t\n\t          if (!target) {\n\t            for (var _i5 = 0; _i5 < overlapping.spilled.length; _i5 += 1) {\n\t              var _sim = overlapping.spilled[_i5];\n\t              if (DrawingManager.getColorString(_sim) !== currentColorString) {\n\t                continue;\n\t              }\n\t              if (!target) {\n\t                target = this.objects[overlapping.spilled[_i5]];\n\t                continue;\n\t              }\n\t              target.drawObjectComp(this.objects[_sim]);\n\t              delete this.objects[_sim];\n\t              this.objectIndexes.splice(this.objectIndexes.indexOf(_sim), 1);\n\t            }\n\t          }\n\t          target.drawObject(obj);\n\t          this.lastKey = overlapping.comp[sameIndexes[0]];\n\t        } else {\n\t          for (var _i6 = 0; _i6 < overlapping.spilled.length; _i6 += 1) {\n\t            var _sim2 = overlapping.spilled[_i6];\n\t            if (DrawingManager.getColorString(_sim2) !== currentColorString) {\n\t              continue;\n\t            }\n\t            if (!target) {\n\t              target = this.objects[overlapping.spilled[_i6]];\n\t              continue;\n\t            }\n\t            target.drawObjectComp(this.objects[_sim2]);\n\t            delete this.objects[_sim2];\n\t            this.objectIndexes.splice(this.objectIndexes.indexOf(_sim2), 1);\n\t          }\n\t\n\t          target.drawObject(obj);\n\t          this.lastKey = overlapping.spilled[sameIndexes[0]];\n\t        }\n\t      } else {\n\t        var canvas = document.createElement('canvas');\n\t        target = new _Drawing2.default(color, tool.toString(), canvas, this.styleWidth, this.styleHeight, this.showPen, this.showBase, this.showExtra);\n\t        target.drawObject(obj);\n\t        this.objectIndexes.push(key);\n\t        this.objects[key] = target;\n\t        this.lastKey = key;\n\t        if (this.clearedKey && DrawingManager.getToolString(this.clearedKey) === 'Symbol(BRUSH)' && this.objects[this.clearedKey]) {\n\t          target.history = (0, _assign2.default)({}, this.objects[this.clearedKey]);\n\t        }\n\t        this.clearedKey = null;\n\t      }\n\t    }\n\t  }, {\n\t    key: 'erase',\n\t    value: function erase(obj, color, tool, editRange, key) {\n\t      if (!key) {\n\t        return;\n\t      }\n\t      if (key.indexOf('_overlap') === -1) {\n\t        var target = this.objects[key];\n\t        target.eraseObject(obj);\n\t        this.lastKey = key;\n\t      } else {\n\t        var k = key.split('_overlap')[0];\n\t        var _target = this.objects[k];\n\t        _target.eraseOverlapObject(obj);\n\t        this.lastKey = k;\n\t      }\n\t\n\t      this.update();\n\t      this.updateSort();\n\t    }\n\t  }, {\n\t    key: 'update',\n\t    value: function update(editRange) {\n\t      this.layers = [];\n\t      this.fixedObject.clear(editRange);\n\t      var _iteratorNormalCompletion = true;\n\t      var _didIteratorError = false;\n\t      var _iteratorError = undefined;\n\t\n\t      try {\n\t        for (var _iterator = (0, _getIterator3.default)(this.objectIndexes), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t          var key = _step.value;\n\t\n\t          var tool = DrawingManager.getToolString(key);\n\t          var target = this.objects[key];\n\t          var histories = [];\n\t          while (target.history) {\n\t            histories.push(target.history.url);\n\t            target = target.history;\n\t          }\n\t          this.layers.push({\n\t            url: this.objects[key].imageUrl,\n\t            histories: histories\n\t          });\n\t          if (tool === 'Symbol(PEN)' && this.showPen || tool === 'Symbol(BRUSH)' && (this.showBase || this.showExtra)) {\n\t            this.fixedObject.drawObject(this.objects[key], editRange);\n\t          }\n\t        }\n\t      } catch (err) {\n\t        _didIteratorError = true;\n\t        _iteratorError = err;\n\t      } finally {\n\t        try {\n\t          if (!_iteratorNormalCompletion && _iterator.return) {\n\t            _iterator.return();\n\t          }\n\t        } finally {\n\t          if (_didIteratorError) {\n\t            throw _iteratorError;\n\t          }\n\t        }\n\t      }\n\t\n\t      this.layers = this.layers.reverse();\n\t    }\n\t  }, {\n\t    key: 'updateSort',\n\t    value: function updateSort() {\n\t      var _this = this;\n\t\n\t      var c1 = document.createElement('canvas');\n\t      c1.style.width = this.styleWidth;\n\t      c1.style.height = this.styleHeight;\n\t      var d1 = new _Drawing2.default(null, null, c1, this.styleWidth / SORT_DIV, this.styleHeight / SORT_DIV);\n\t      var ctx1 = d1.canvas.getContext('2d');\n\t\n\t      var c2 = document.createElement('canvas');\n\t      c2.style.width = this.styleWidth;\n\t      c2.style.height = this.styleHeight;\n\t      var d2 = new _Drawing2.default(null, null, c2, this.styleWidth / SORT_DIV, this.styleHeight / SORT_DIV);\n\t      var ctx2 = d2.canvas.getContext('2d');\n\t\n\t      this.objectIndexes.sort(function (key1, key2) {\n\t        var o1 = _this.objects[key1];\n\t        var o2 = _this.objects[key2];\n\t        var tool1 = key1.split(',')[0];\n\t        var tool2 = key2.split(',')[0];\n\t        if (tool1 !== tool2) {\n\t          return tool1 === 'Symbol(PEN)' ? 1 : -1;\n\t        }\n\t\n\t        var cacheKey = key1 + '-' + key2;\n\t        var cache = _this.sortCache[cacheKey];\n\t        if (cache && key1 !== _this.lastKey && key2 !== _this.lastKey) {\n\t          return cache;\n\t        }\n\t\n\t        var oc1 = o1.canvas;\n\t        var oc2 = o2.canvas;\n\t\n\t        ctx1.globalCompositeOperation = 'source-over';\n\t        ctx1.drawImage(oc1, 0, 0, _this.styleWidth / SORT_DIV, _this.styleHeight / SORT_DIV);\n\t        ctx1.globalCompositeOperation = 'source-in';\n\t        ctx1.fillStyle = '#f00';\n\t        ctx1.fillRect(0, 0, _this.styleWidth / SORT_DIV, _this.styleHeight / SORT_DIV);\n\t\n\t        ctx2.globalCompositeOperation = 'source-over';\n\t        ctx2.drawImage(oc2, 0, 0, _this.styleWidth / SORT_DIV, _this.styleHeight / SORT_DIV);\n\t        ctx2.globalCompositeOperation = 'source-in';\n\t        ctx2.fillStyle = '#00f';\n\t        ctx2.fillRect(0, 0, _this.styleWidth / SORT_DIV, _this.styleHeight / SORT_DIV);\n\t\n\t        ctx2.globalCompositeOperation = 'xor';\n\t        ctx2.drawImage(c1, 0, 0, _this.styleWidth / SORT_DIV, _this.styleHeight / SORT_DIV);\n\t\n\t        var imgdata = ctx2.getImageData(0, 0, d2.canvas.width, d2.canvas.height).data;\n\t\n\t        var _DrawingManager$measu = DrawingManager.measureArea(imgdata, d2.canvas.width, d2.canvas.height, [[255, 0, 0], [0, 0, 255]]),\n\t            _DrawingManager$measu2 = (0, _slicedToArray3.default)(_DrawingManager$measu, 2),\n\t            a = _DrawingManager$measu2[0],\n\t            b = _DrawingManager$measu2[1];\n\t\n\t        d1.clear();\n\t        d2.clear();\n\t\n\t        cache = a > b ? -1 : 1;\n\t        _this.sortCache[cacheKey] = cache;\n\t        return cache;\n\t      });\n\t    }\n\t  }, {\n\t    key: 'checkOverlap',\n\t    value: function checkOverlap(obj, editRange) {\n\t      var result = {\n\t        comp: [],\n\t        spilled: []\n\t      };\n\t\n\t      if (!this.showBase) {\n\t        return result;\n\t      }\n\t\n\t      var c1 = document.createElement('canvas');\n\t      c1.style.width = this.styleWidth;\n\t      c1.style.height = this.styleHeight;\n\t      var d1 = new _Drawing2.default(null, null, c1, this.styleWidth / SORT_DIV, this.styleHeight / SORT_DIV, false, true, false);\n\t      var ctx1 = d1.canvas.getContext('2d');\n\t\n\t      ctx1.globalCompositeOperation = 'source-over';\n\t      ctx1.drawImage(obj.canvas, 0, 0, this.styleWidth / SORT_DIV, this.styleHeight / SORT_DIV);\n\t      ctx1.globalCompositeOperation = 'source-in';\n\t      ctx1.fillStyle = '#f00';\n\t      ctx1.fillRect(0, 0, this.styleWidth / SORT_DIV, this.styleHeight / SORT_DIV);\n\t\n\t      var c2 = document.createElement('canvas');\n\t      c2.style.width = this.styleWidth;\n\t      c2.style.height = this.styleHeight;\n\t      var d2 = new _Drawing2.default(null, null, c2, this.styleWidth / SORT_DIV, this.styleHeight / SORT_DIV, false, true, false);\n\t      var ctx2 = d2.canvas.getContext('2d');\n\t\n\t      for (var i = 0; i < this.objectIndexes.length; i += 1) {\n\t        var key = this.objectIndexes[i];\n\t        if (DrawingManager.getToolString(key) === 'Symbol(PEN)') {\n\t          continue;\n\t        }\n\t        var target = this.objects[this.objectIndexes[i]];\n\t\n\t        ctx2.globalCompositeOperation = 'source-over';\n\t        ctx2.drawImage(target.canvas, 0, 0, this.styleWidth / SORT_DIV, this.styleHeight / SORT_DIV);\n\t        ctx2.globalCompositeOperation = 'source-in';\n\t        ctx2.fillStyle = '#00f';\n\t        ctx2.fillRect(0, 0, this.styleWidth / SORT_DIV, this.styleHeight / SORT_DIV);\n\t\n\t        ctx2.globalCompositeOperation = 'difference';\n\t        ctx2.drawImage(c1, 0, 0, this.styleWidth / SORT_DIV, this.styleHeight / SORT_DIV);\n\t\n\t        var imgdata = ctx2.getImageData(0, 0, d2.canvas.width, d2.canvas.height).data;\n\t\n\t        var _DrawingManager$measu3 = DrawingManager.measureArea(imgdata, d2.canvas.width, d2.canvas.height, [[255, 0, 0], [255, 0, 255], [0, 0, 255]], editRange),\n\t            _DrawingManager$measu4 = (0, _slicedToArray3.default)(_DrawingManager$measu3, 3),\n\t            a = _DrawingManager$measu4[0],\n\t            b = _DrawingManager$measu4[1],\n\t            c = _DrawingManager$measu4[2];\n\t\n\t        d2.clear();\n\t\n\t        if (a !== 0 && b !== 0 && c !== 0) {\n\t          result.spilled.push(key);\n\t        } else if ((a === 0 || c === 0) && b !== 0) {\n\t          result.comp.push(key);\n\t        }\n\t      }\n\t      return result;\n\t    }\n\t  }, {\n\t    key: 'spoit',\n\t    value: function spoit(point) {\n\t      var imgdata = this.fixedObject.canvas.getContext('2d').getImageData(0, 0, this.fixedObject.canvas.width, this.fixedObject.canvas.height).data;\n\t      return DrawingManager.spoitColor(imgdata, point, this.fixedObject.canvas.width);\n\t    }\n\t  }, {\n\t    key: 'getTopKey',\n\t    value: function getTopKey(points) {\n\t      for (var i = this.objectIndexes.length - 1; i >= 0; i -= 1) {\n\t        var key = this.objectIndexes[i];\n\t        var target = this.objects[key];\n\t        var overlap = target.overlap.getContext('2d').getImageData(0, 0, target.overlap.width, target.overlap.height).data;\n\t        if (this.showExtra && DrawingManager.filledColor(overlap, points, target.overlap.width)) {\n\t          return key + '_overlap';\n\t        }\n\t        var shape = target.shape.getContext('2d').getImageData(0, 0, target.shape.width, target.shape.height).data;\n\t        var v = !target.tool || target.tool === 'Symbol(PEN)' && target.showPen || target.tool === 'Symbol(BRUSH)' && target.showBase;\n\t        if (v && DrawingManager.filledColor(shape, points, target.shape.width)) {\n\t          return key;\n\t        }\n\t      }\n\t      return undefined;\n\t    }\n\t  }, {\n\t    key: 'clearAll',\n\t    value: function clearAll() {\n\t      this.objects = [];\n\t      this.histories = [];\n\t      this.layers = [];\n\t    }\n\t  }, {\n\t    key: 'undo',\n\t    value: function undo() {\n\t      this.objects = this.histories[this.histories.length - 1];\n\t    }\n\t  }, {\n\t    key: 'rollback',\n\t    value: function rollback(layerIdx, historyIdx) {\n\t      var length = this.objectIndexes.length;\n\t      var key = this.objectIndexes[length - layerIdx - 1];\n\t      var canvas = document.createElement('canvas');\n\t      var target = new _Drawing2.default(null, DrawingManager.getToolString(key), canvas, this.styleWidth, this.styleHeight);\n\t      var history = this.objects[key].history;\n\t      for (var i = 0; i < historyIdx; i += 1) {\n\t        history = history.history;\n\t      }\n\t      target.drawObjectComp(history);\n\t      target.history = (0, _assign2.default)({}, this.objects[key]);\n\t      this.objects[key] = target;\n\t      this.update();\n\t    }\n\t  }, {\n\t    key: 'changeVisual',\n\t    value: function changeVisual(pen, base, extra) {\n\t      this.showPen = pen;\n\t      this.showBase = base;\n\t      this.showExtra = extra;\n\t      for (var i = 0; i < this.objectIndexes.length; i += 1) {\n\t        this.objects[this.objectIndexes[i]].changeVisual(pen, base, extra);\n\t      }\n\t      this.update();\n\t    }\n\t  }], [{\n\t    key: 'getKey',\n\t    value: function getKey(tool, r, g, b) {\n\t      layerIndex += 1;\n\t      var idx = tool === _Tools2.default.PEN ? 0 : layerIndex;\n\t      return tool.toString() + ',' + r + ',' + g + ',' + b + ',' + idx;\n\t    }\n\t  }, {\n\t    key: 'getToolString',\n\t    value: function getToolString(key) {\n\t      return key.split(',')[0];\n\t    }\n\t  }, {\n\t    key: 'getColorString',\n\t    value: function getColorString(key) {\n\t      return key.split(',').splice(1, 3).join(',');\n\t    }\n\t  }, {\n\t    key: 'getColor',\n\t    value: function getColor(colorString) {\n\t      return colorString.split(',').map(function (x) {\n\t        return parseInt(x, 10);\n\t      });\n\t    }\n\t  }, {\n\t    key: 'getImageDataFaster',\n\t    value: function getImageDataFaster(_x, _y, _w, d) {\n\t      var x = Math.round(_x);\n\t      var y = Math.round(_y);\n\t      var w = Math.round(_w);\n\t      var r = d[(y * w + x) * 4];\n\t      var g = d[(y * w + x) * 4 + 1];\n\t      var b = d[(y * w + x) * 4 + 2];\n\t      var a = d[(y * w + x) * 4 + 3];\n\t      return [r, g, b, a];\n\t    }\n\t  }, {\n\t    key: 'measureArea',\n\t    value: function measureArea(imgdata, width, height, targetColors, range) {\n\t      var hits = new Array(targetColors.length);\n\t      hits.fill(0);\n\t      var w = width;\n\t      var h = height;\n\t      var ox = 0;\n\t      var oy = 0;\n\t      if (range) {\n\t        w = (range.rx - range.lx) / SORT_DIV * window.devicePixelRatio;\n\t        h = (range.ry - range.ly) / SORT_DIV * window.devicePixelRatio;\n\t        ox = range.lx / SORT_DIV * window.devicePixelRatio;\n\t        oy = range.ly / SORT_DIV * window.devicePixelRatio;\n\t      }\n\t      for (var i = 0; i < MEASURE_ITER_COUNT; i += 1) {\n\t        var x = Math.round(Math.random() * (w - 1) + ox);\n\t        var y = Math.round(Math.random() * (h - 1) + oy);\n\t        var p = DrawingManager.getImageDataFaster(x, y, Math.round(width), imgdata);\n\t        for (var j = 0; j < targetColors.length; j += 1) {\n\t          var c = targetColors[j];\n\t          if (p[0] === c[0] && p[1] === c[1] && p[2] === c[2]) {\n\t            hits[j] += 1;\n\t          }\n\t        }\n\t      }\n\t      return hits;\n\t    }\n\t  }, {\n\t    key: 'filledColor',\n\t    value: function filledColor(imgdata, points, width) {\n\t      var _iteratorNormalCompletion2 = true;\n\t      var _didIteratorError2 = false;\n\t      var _iteratorError2 = undefined;\n\t\n\t      try {\n\t        for (var _iterator2 = (0, _getIterator3.default)(points), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n\t          var point = _step2.value;\n\t\n\t          var p = DrawingManager.getImageDataFaster(point[0], point[1], Math.round(width), imgdata);\n\t          if (!(p[0] === 0 && p[1] === 0 && p[2] === 0 && p[3] === 0)) {\n\t            return true;\n\t          }\n\t        }\n\t      } catch (err) {\n\t        _didIteratorError2 = true;\n\t        _iteratorError2 = err;\n\t      } finally {\n\t        try {\n\t          if (!_iteratorNormalCompletion2 && _iterator2.return) {\n\t            _iterator2.return();\n\t          }\n\t        } finally {\n\t          if (_didIteratorError2) {\n\t            throw _iteratorError2;\n\t          }\n\t        }\n\t      }\n\t\n\t      return false;\n\t    }\n\t  }, {\n\t    key: 'spoitColor',\n\t    value: function spoitColor(imgdata, points, width) {\n\t      var _iteratorNormalCompletion3 = true;\n\t      var _didIteratorError3 = false;\n\t      var _iteratorError3 = undefined;\n\t\n\t      try {\n\t        for (var _iterator3 = (0, _getIterator3.default)(points), _step3; !(_iteratorNormalCompletion3 = (_step3 = _iterator3.next()).done); _iteratorNormalCompletion3 = true) {\n\t          var point = _step3.value;\n\t\n\t          var p = DrawingManager.getImageDataFaster(point[0], point[1], Math.round(width), imgdata);\n\t          if (!(p[0] === 0 && p[1] === 0 && p[2] === 0 && p[3] === 0)) {\n\t            return p;\n\t          }\n\t        }\n\t      } catch (err) {\n\t        _didIteratorError3 = true;\n\t        _iteratorError3 = err;\n\t      } finally {\n\t        try {\n\t          if (!_iteratorNormalCompletion3 && _iterator3.return) {\n\t            _iterator3.return();\n\t          }\n\t        } finally {\n\t          if (_didIteratorError3) {\n\t            throw _iteratorError3;\n\t          }\n\t        }\n\t      }\n\t\n\t      return null;\n\t    }\n\t  }, {\n\t    key: 'd',\n\t    value: function d(arr, before) {\n\t      var result = [];\n\t      var kms = [null, null];\n\t      var bics = [Number.NEGATIVE_INFINITY, Number.NEGATIVE_INFINITY];\n\t      for (var i = 0; i < 2; i += 1) {\n\t        if (arr.cluster_arr[i].length < 2) {\n\t          continue;\n\t        }\n\t        var km = (0, _mlKmeans2.default)(arr.cluster_arr[i], 2);\n\t        var newArr = [];\n\t        newArr = newArr.concat(arr.cluster_arr[i]);\n\t        newArr = newArr.concat(arr.cluster_arr[1 - i]);\n\t        for (var j = 0; j < arr.cluster_arr[1 - i].length; j += 1) {\n\t          km.clusters.push(2);\n\t        }\n\t\n\t        var res = DrawingManager.computeBic(newArr, km);\n\t        if (res.bic > before) {\n\t          bics[i] = res.bic;\n\t          kms[i] = km;\n\t        }\n\t      }\n\t\n\t      if (bics[0] > before || bics[1] > before) {\n\t        for (var _i7 = 0; _i7 < 2; _i7 += 1) {\n\t          if (bics[_i7] > before) {\n\t            var _km = kms[_i7];\n\t            var clusters = new Array(2);\n\t            for (var k = 0; k < _km.clusters.length; k += 1) {\n\t              if (!clusters[_km.clusters[k]]) {\n\t                clusters[_km.clusters[k]] = [];\n\t              }\n\t              clusters[_km.clusters[k]].push(arr.cluster_arr[_i7][k]);\n\t            }\n\t            _km.arr = arr.cluster_arr[_i7];\n\t            _km.cluster_arr = clusters;\n\t            result = result.concat(DrawingManager.d(_km, bics[_i7]));\n\t          } else {\n\t            result.push(arr.cluster_arr[_i7]);\n\t          }\n\t        }\n\t      } else {\n\t        result.push([].concat(arr.cluster_arr[0], arr.cluster_arr[1]));\n\t      }\n\t      return result;\n\t    }\n\t  }, {\n\t    key: 'divide',\n\t    value: function divide(arr) {\n\t      if (arr.length < 2) {\n\t        return [arr];\n\t      }\n\t      var km = (0, _mlKmeans2.default)(arr, 2);\n\t      var clusters = new Array(2);\n\t      for (var i = 0; i < km.clusters.length; i += 1) {\n\t        if (!clusters[km.clusters[i]]) {\n\t          clusters[km.clusters[i]] = [];\n\t        }\n\t        clusters[km.clusters[i]].push(arr[i]);\n\t      }\n\t      if (!clusters[1]) {\n\t        return [arr];\n\t      }\n\t\n\t      km.arr = arr;\n\t      km.cluster_arr = clusters;\n\t      var res = DrawingManager.computeBic(arr, km);\n\t      var resClusters = DrawingManager.d(km, res.bic);\n\t      return resClusters;\n\t    }\n\t  }, {\n\t    key: 'computeBic',\n\t    value: function computeBic(arr, km) {\n\t      var centers = km.centroids.map(function (x) {\n\t        return x.centroid;\n\t      });\n\t      var labels = km.clusters;\n\t      var m = km.centroids.length;\n\t      var n = km.centroids.map(function (x) {\n\t        return x.size;\n\t      });\n\t      var N = arr.length;\n\t      var d = arr[0].length;\n\t\n\t      var clusters = new Array(m);\n\t      for (var i = 0; i < km.clusters.length; i += 1) {\n\t        if (!clusters[km.clusters[i]]) {\n\t          clusters[km.clusters[i]] = [];\n\t        }\n\t        clusters[km.clusters[i]].push(arr[i]);\n\t      }\n\t\n\t      var s = 0;\n\t      for (var _i8 = 0; _i8 < m; _i8 += 1) {\n\t        for (var j = 0; j < N; j += 1) {\n\t          if (_i8 === labels[j]) {\n\t            s += _mlDistance2.default.distance.euclidean(arr[j], centers[_i8]);\n\t          }\n\t        }\n\t      }\n\t      var clVar = 1.0 / (N - m) / d * s;\n\t      var constTerm = 0.5 * m * Math.log(N) * (d + 1);\n\t      if (!clVar) {\n\t        return { clusters: clusters, centers: centers, bic: Number.NEGATIVE_INFINITY };\n\t      }\n\t      var bic = 0;\n\t      for (var _i9 = 0; _i9 < m; _i9 += 1) {\n\t        var b = n[_i9];\n\t\n\t        bic += b * Math.log(b) - b * Math.log(N) - b * d / 2 * Math.log(2 * Math.PI * clVar) - (b - 1) * d / 2;\n\t      }\n\t      bic -= constTerm;\n\t      return { clusters: clusters, centers: centers, bic: bic };\n\t    }\n\t  }]);\n\t  return DrawingManager;\n\t}();\n\t\n\texports.default = DrawingManager;\n\n/***/ }),\n\n/***/ 62:\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _from = __webpack_require__(66);\n\t\n\tvar _from2 = _interopRequireDefault(_from);\n\t\n\tvar _vueColor = __webpack_require__(175);\n\t\n\tvar _vue = __webpack_require__(24);\n\t\n\tvar _vue2 = _interopRequireDefault(_vue);\n\t\n\tvar _color = __webpack_require__(32);\n\t\n\tvar _color2 = _interopRequireDefault(_color);\n\t\n\tvar _vueMaterial = __webpack_require__(184);\n\t\n\tvar _vueMaterial2 = _interopRequireDefault(_vueMaterial);\n\t\n\t__webpack_require__(114);\n\t\n\tvar _UiCanvas = __webpack_require__(177);\n\t\n\tvar _UiCanvas2 = _interopRequireDefault(_UiCanvas);\n\t\n\tvar _UiSlider = __webpack_require__(179);\n\t\n\tvar _UiSlider2 = _interopRequireDefault(_UiSlider);\n\t\n\tvar _UiLayerList = __webpack_require__(178);\n\t\n\tvar _UiLayerList2 = _interopRequireDefault(_UiLayerList);\n\t\n\tvar _DrawingManager = __webpack_require__(61);\n\t\n\tvar _DrawingManager2 = _interopRequireDefault(_DrawingManager);\n\t\n\tvar _Tools = __webpack_require__(10);\n\t\n\tvar _Tools2 = _interopRequireDefault(_Tools);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t_vue2.default.use(_vueMaterial2.default);\n\t\n\tvar currentColor = {\n\t  hex: '#4A4A4A',\n\t  rgba: {\n\t    r: 74,\n\t    g: 74,\n\t    b: 74,\n\t    a: 1\n\t  },\n\t  a: 1\n\t};\n\t\n\tvar currentTool = _Tools2.default.PEN;\n\tvar prevTool = currentTool;\n\tvar toolSizes = {};\n\ttoolSizes[_Tools2.default.PEN] = 4;\n\ttoolSizes[_Tools2.default.BRUSH] = 30;\n\ttoolSizes[_Tools2.default.ERASER] = 30;\n\t\n\texports.default = {\n\t  name: 'app',\n\t  components: {\n\t    Sketch: _vueColor.Sketch,\n\t    UiCanvas: _UiCanvas2.default,\n\t    UiLayerList: _UiLayerList2.default,\n\t    UiSlider: _UiSlider2.default\n\t  },\n\t  data: function data() {\n\t    return {\n\t      currentColor: currentColor,\n\t      currentTool: currentTool,\n\t      prevTool: prevTool,\n\t      toolSizes: toolSizes,\n\t      drawingManager: undefined,\n\t      defaultSize: 4,\n\t      tuneTargetKey: undefined,\n\t      tuneTarget: undefined,\n\t      tuneInfo: undefined,\n\t      tuneShape: undefined,\n\t      tuneOverlap: undefined,\n\t      showPen: true,\n\t      showBase: true,\n\t      showExtra: true,\n\t      showPalette: true\n\t    };\n\t  },\n\t  mounted: function mounted() {\n\t    window.devicePixelRatio = 1.0;\n\t    this.drawingManager = new _DrawingManager2.default(document.querySelector('#fixed-canvas'));\n\t\n\t    var count = 0;\n\t    var startTime = 0;\n\t    var counter = function counter() {\n\t      count += 1;\n\t      if (new Date().getTime() - startTime > 1000) {\n\t        document.title = '(FPS: ' + count + ')';\n\t        count = 0;\n\t        startTime = new window.Date().getTime();\n\t      }\n\t      window.requestAnimationFrame(counter);\n\t    };\n\t    window.requestAnimationFrame(counter);\n\t  },\n\t\n\t  methods: {\n\t    onchange: function onchange(color) {\n\t      this.currentColor = color;\n\t    },\n\t    toggletool: function toggletool(tool) {\n\t      this.prevTool = this.currentTool;\n\t      this.currentTool = _Tools2.default.fromName(tool);\n\t      this.$refs.slider.setValue(this.toolSizes[this.currentTool], true, false);\n\t    },\n\t    onchangesize: function onchangesize(size) {\n\t      this.toolSizes[this.currentTool] = size;\n\t    },\n\t    onextractcolor: function onextractcolor(color) {\n\t      this.$refs.colorPicker.colorChange({\n\t        hex: _color2.default.rgb(color).hex(),\n\t        rgba: {\n\t          r: color[0],\n\t          g: color[1],\n\t          b: color[2],\n\t          a: 1\n\t        },\n\t        a: 1\n\t      });\n\t    },\n\t    newcanvas: function newcanvas() {\n\t      this.drawingManager = new _DrawingManager2.default(document.querySelector('#fixed-canvas'));\n\t      this.currentColor = currentColor;\n\t      this.currentTool = currentTool;\n\t      this.$refs.slider.setValue(this.defaultSize, true, false);\n\t      (0, _from2.default)(this.$refs.toolButtons.$el.children).map(function (x) {\n\t        return x.classList.remove('md-toggle');\n\t      });\n\t\n\t      this.$refs.penButton.$el.classList.add('md-toggle');\n\t      this.showPen = true;\n\t      this.showBase = true;\n\t      this.showExtra = true;\n\t      this.showPalette = true;\n\t    },\n\t    onclear: function onclear(index) {\n\t      if (this.drawingManager) {\n\t        var length = this.drawingManager.objectIndexes.length;\n\t        var clearedKey = this.drawingManager.objectIndexes.splice(length - index - 1, 1)[0];\n\t        this.drawingManager.clearedKey = clearedKey;\n\t        this.drawingManager.update();\n\t      }\n\t    },\n\t    rollback: function rollback(layerIdx, historyIdx) {\n\t      this.drawingManager.rollback(layerIdx, historyIdx);\n\t    },\n\t    openColorDialog: function openColorDialog() {\n\t      this.$refs.hueSlider.setValue(50, true, false);\n\t      this.$refs.satSlider.setValue(50, true, false);\n\t      this.$refs.valSlider.setValue(50, true, false);\n\t      this.$refs.colorDialog.open();\n\t    },\n\t    closeColorDialog: function closeColorDialog() {\n\t      var shape = new Uint8ClampedArray(this.tuneShape.data);\n\t      shape.set(this.tuneShape);\n\t      var ps = new window.ImageData(shape, this.tuneTarget.shape.width, this.tuneTarget.shape.height);\n\t      this.tuneTarget.shape.getContext('2d').putImageData(ps, 0, 0);\n\t      var overlap = new Uint8ClampedArray(this.tuneOverlap.data);\n\t      overlap.set(this.tuneOverlap);\n\t      var po = new window.ImageData(overlap, this.tuneTarget.overlap.width, this.tuneTarget.overlap.height);\n\t      this.tuneTarget.overlap.getContext('2d').putImageData(po, 0, 0);\n\t      this.tuneTarget.url = null;\n\t      this.tuneTarget.updateCanvas();\n\t      this.drawingManager.update();\n\t      this.$refs.colorDialog.close();\n\t    },\n\t    applyColorDialog: function applyColorDialog() {\n\t      var targetTool = _DrawingManager2.default.getToolString(this.tuneTargetKey);\n\t      var targetColor = _DrawingManager2.default.getColor(_DrawingManager2.default.getColorString(this.tuneTargetKey));\n\t      var newColor = _color2.default.rgb(targetColor).rotate(this.tuneInfo.hue).saturate(this.tuneInfo.sat).lighten(this.tuneInfo.val).rgb().array();\n\t      newColor = newColor.map(function (x) {\n\t        return Math.floor(x);\n\t      });\n\t      var newKey = _DrawingManager2.default.getKey(targetTool, Math.floor(newColor[0]), Math.floor(newColor[1]), Math.floor(newColor[2]));\n\t      var idx = this.drawingManager.objectIndexes.indexOf(this.tuneTargetKey);\n\t      if (idx === -1) {\n\t        return;\n\t      }\n\t      this.drawingManager.objectIndexes[idx] = newKey;\n\t      this.drawingManager.objects[newKey] = this.tuneTarget;\n\t      delete this.drawingManager.objects[this.tuneTargetKey];\n\t      this.drawingManager.update();\n\t      this.$refs.colorDialog.close();\n\t    },\n\t    ontune: function ontune(targetKey) {\n\t      this.tuneTargetKey = targetKey;\n\t      this.tuneTarget = this.drawingManager.objects[targetKey];\n\t      this.tuneInfo = {\n\t        hue: 0.0,\n\t        sat: 0.0,\n\t        val: 0.0\n\t      };\n\t      this.tuneShape = this.tuneTarget.shape.getContext('2d').getImageData(0, 0, this.tuneTarget.shape.width, this.tuneTarget.shape.height);\n\t      this.tuneOverlap = this.tuneTarget.overlap.getContext('2d').getImageData(0, 0, this.tuneTarget.overlap.width, this.tuneTarget.overlap.height);\n\t      this.openColorDialog();\n\t    },\n\t    onchangehue: function onchangehue(hue) {\n\t      this.tuneInfo.hue = (hue - 50) / 100 * 360;\n\t      this.colorTune();\n\t    },\n\t    onchangesat: function onchangesat(sat) {\n\t      this.tuneInfo.sat = (sat - 50) / 100;\n\t      this.colorTune();\n\t    },\n\t    onchangeval: function onchangeval(val) {\n\t      this.tuneInfo.val = (val - 50) / 100;\n\t      this.colorTune();\n\t    },\n\t    colorTune: function colorTune() {\n\t      this.tuneTarget.colorTune(this.tuneShape, this.tuneOverlap, this.tuneInfo);\n\t      this.drawingManager.update();\n\t    },\n\t    onchangevisiual: function onchangevisiual() {\n\t      this.drawingManager.changeVisual(this.showPen, this.showBase, this.showExtra);\n\t    },\n\t    togglepalette: function togglepalette() {\n\t      this.showPalette = !this.showPalette;\n\t    }\n\t  }\n\t};\n\n/***/ }),\n\n/***/ 63:\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _slicedToArray2 = __webpack_require__(14);\n\t\n\tvar _slicedToArray3 = _interopRequireDefault(_slicedToArray2);\n\t\n\tvar _Drawing = __webpack_require__(25);\n\t\n\tvar _Drawing2 = _interopRequireDefault(_Drawing);\n\t\n\tvar _Tools = __webpack_require__(10);\n\t\n\tvar _Tools2 = _interopRequireDefault(_Tools);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar getMousePos = function getMousePos(event) {\n\t  var rect = event.target.getBoundingClientRect();\n\t  var clientX = event.clientX || event.touches[0].clientX;\n\t  var clientY = event.clientY || event.touches[0].clientY;\n\t  return [clientX - rect.left, clientY - rect.top];\n\t};\n\t\n\texports.default = {\n\t  name: 'UiCanvas',\n\t  props: ['current-color', 'current-tool', 'prev-tool', 'tool-sizes', 'drawing-manager'],\n\t  data: function data() {\n\t    return {\n\t      currentStroke: [],\n\t      drawing: null,\n\t      editRange: { lx: 0, ly: 0, rx: 0, ry: 0 },\n\t      eraseTarget: undefined\n\t    };\n\t  },\n\t  mounted: function mounted() {\n\t    this.$refs.drawing.addEventListener('dragover', this.dragover, false);\n\t    this.$refs.drawing.addEventListener('drop', this.drop, false);\n\t  },\n\t\n\t  methods: {\n\t    mousedown: function mousedown(event) {\n\t      event.preventDefault();\n\t\n\t      var _getMousePos = getMousePos(event),\n\t          _getMousePos2 = (0, _slicedToArray3.default)(_getMousePos, 2),\n\t          mousex = _getMousePos2[0],\n\t          mousey = _getMousePos2[1];\n\t\n\t      var firstTarget = void 0;\n\t      var color = void 0;\n\t      switch (this.currentTool) {\n\t        case _Tools2.default.PEN:\n\t        case _Tools2.default.BRUSH:\n\t        case _Tools2.default.ERASER:\n\t          this.drawing = new _Drawing2.default(this.currentColor, null, document.querySelector('#drawing'));\n\t          break;\n\t        case _Tools2.default.SPOIT:\n\t          color = this.drawingManager.spoit([[mousex * window.devicePixelRatio, mousey * window.devicePixelRatio]]);\n\t          if (color) {\n\t            this.$emit('onextractcolor', color);\n\t          }\n\t          return;\n\t        case _Tools2.default.FILL:\n\t          return;\n\t        case _Tools2.default.COLOR:\n\t          firstTarget = this.drawingManager.getTopKey([[mousex * window.devicePixelRatio, mousey * window.devicePixelRatio]]);\n\t          if (firstTarget) {\n\t            this.$emit('ontune', firstTarget.split('_overlap')[0]);\n\t          }\n\t          return;\n\t        default:\n\t          return;\n\t      }\n\t      var size = this.toolSizes[this.currentTool];\n\t      this.currentStroke.push([mousex, mousey]);\n\t      this.drawing.draw(this.currentStroke, this.currentColor, this.currentTool, size);\n\t\n\t      this.editRange.lx = mousex - size;\n\t      this.editRange.ly = mousey - size;\n\t      this.editRange.rx = mousex + size;\n\t      this.editRange.ry = mousey + size;\n\t\n\t      this.updateerasertarget(mousex * window.devicePixelRatio, mousey * window.devicePixelRatio);\n\t    },\n\t    mousemove: function mousemove(event) {\n\t      event.preventDefault();\n\t      if (!this.drawing) {\n\t        return;\n\t      }\n\t\n\t      var _currentStroke = (0, _slicedToArray3.default)(this.currentStroke[this.currentStroke.length - 1], 2),\n\t          pmousex = _currentStroke[0],\n\t          pmousey = _currentStroke[1];\n\t\n\t      var _getMousePos3 = getMousePos(event),\n\t          _getMousePos4 = (0, _slicedToArray3.default)(_getMousePos3, 2),\n\t          mousex = _getMousePos4[0],\n\t          mousey = _getMousePos4[1];\n\t\n\t      if (mousex === pmousex && mousey === pmousey) {\n\t        return;\n\t      }\n\t      var size = this.toolSizes[this.currentTool];\n\t      this.currentStroke.push([mousex, mousey]);\n\t      this.drawing.clear(this.editRange);\n\t      this.drawing.draw(this.currentStroke, this.currentColor, this.currentTool, size);\n\t\n\t      this.editRange.lx = Math.min(mousex - size, this.editRange.lx);\n\t      this.editRange.ly = Math.min(mousey - size, this.editRange.ly);\n\t      this.editRange.rx = Math.max(mousex + size, this.editRange.rx);\n\t      this.editRange.ry = Math.max(mousey + size, this.editRange.ry);\n\t\n\t      this.updateerasertarget(mousex * window.devicePixelRatio, mousey * window.devicePixelRatio);\n\t    },\n\t    mouseup: function mouseup(event) {\n\t      event.preventDefault();\n\t      if (!this.drawing) {\n\t        return;\n\t      }\n\t      switch (this.currentTool) {\n\t        case _Tools2.default.PEN:\n\t        case _Tools2.default.BRUSH:\n\t          this.drawingManager.draw(this.drawing, this.currentColor, this.currentTool, this.editRange);\n\t          break;\n\t        case _Tools2.default.ERASER:\n\t          this.drawingManager.erase(this.drawing, this.currentColor, this.currentTool, this.editRange, this.eraseTarget);\n\t          break;\n\t        case _Tools2.default.SPOIT:\n\t          return;\n\t        case _Tools2.default.FILL:\n\t          return;\n\t        default:\n\t          return;\n\t      }\n\t      this.drawing.clear(this.editRange);\n\t      this.drawing = null;\n\t      this.currentStroke = [];\n\t      this.editRange = { lx: 0, ly: 0, rx: 0, ry: 0 };\n\t      this.eraseTarget = undefined;\n\t      this.$parent.$emit('update-layer-list');\n\t    },\n\t    updateerasertarget: function updateerasertarget(mousex, mousey) {\n\t      var size = this.toolSizes[this.currentTool];\n\t      if (this.currentTool === _Tools2.default.ERASER && !this.eraseTarget) {\n\t        var points = [];\n\t        points.push([mousex, mousey]);\n\t        for (var i = 0; i < 16; i += 1) {\n\t          points.push([mousex + 0.5 * size * Math.cos(2 * Math.PI / 16 * i), mousey + 0.5 * size * Math.sin(2 * Math.PI / 16 * i)]);\n\t        }\n\t        var target = this.drawingManager.getTopKey(points);\n\t        if (target) {\n\t          this.eraseTarget = target;\n\t        }\n\t      }\n\t    },\n\t    dragover: function dragover(event) {\n\t      event.preventDefault();\n\t    },\n\t    drop: function drop(event) {\n\t      var _this = this;\n\t\n\t      event.preventDefault();\n\t      var file = event.dataTransfer.files[0];\n\t      if (file.type !== 'image/png' && file.type !== 'image/jpeg') {\n\t        return;\n\t      }\n\t\n\t      var reader = new FileReader();\n\t      reader.onload = function () {\n\t        var image = document.createElement('img');\n\t        image.setAttribute('src', reader.result);\n\t        _this.drawing = new _Drawing2.default(_this.currentColor, null, document.querySelector('#drawing'));\n\t        _this.drawing.drawObject({ canvas: image });\n\t        _this.drawingManager.draw(_this.drawing, _this.currentColor, _this.currentTool, _this.editRange);\n\t      };\n\t      reader.readAsDataURL(file);\n\t    }\n\t  }\n\t};\n\n/***/ }),\n\n/***/ 64:\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\texports.default = {\n\t  name: 'UiLayerList',\n\t  props: ['layers'],\n\t  data: function data() {\n\t    return {\n\t      active: -1\n\t    };\n\t  },\n\t\n\t  methods: {\n\t    clear: function clear(index) {\n\t      this.$emit('onclear', index);\n\t    },\n\t    mouseover: function mouseover(index) {\n\t      this.active = index;\n\t    },\n\t    mouseleave: function mouseleave(index) {\n\t      if (index === this.active) {\n\t        this.active = -1;\n\t      }\n\t    },\n\t    rollback: function rollback(layerIdx, historyIdx) {\n\t      this.$emit('rollback', layerIdx, historyIdx);\n\t    }\n\t  }\n\t};\n\n/***/ }),\n\n/***/ 65:\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\tvar _draggabilly = __webpack_require__(108);\n\t\n\tvar _draggabilly2 = _interopRequireDefault(_draggabilly);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\texports.default = {\n\t  name: 'UiSlider',\n\t  props: ['defaultValue'],\n\t  data: function data() {\n\t    return {\n\t      keyboardStep: 5,\n\t      value: this.defaultValue,\n\t      dragging: false,\n\t      draggable: null\n\t    };\n\t  },\n\t  mounted: function mounted() {\n\t    this.$refs.thumb.style.left = this.value + '%';\n\t\n\t    this.draggable = new _draggabilly2.default(this.$refs.thumb, {\n\t      containment: this.$refs.container,\n\t      axis: 'x'\n\t    });\n\t\n\t    this.draggable.on('dragStart', this.dragStart);\n\t    this.draggable.on('dragMove', this.dragMove);\n\t    this.draggable.on('dragEnd', this.dragEnd);\n\t  },\n\t\n\t  methods: {\n\t    sliderClick: function sliderClick(e) {\n\t      var sliderPosition = this.$refs.slider.getBoundingClientRect();\n\t\n\t      var newValue = (e.clientX - sliderPosition.left) / sliderPosition.width * 100;\n\t\n\t      this.setValue(newValue, true);\n\t\n\t      if (e.target !== this.$refs.thumb) {\n\t        this.draggable._pointerDown(e, e);\n\t      }\n\t\n\t      this.$refs.slider.focus();\n\t    },\n\t    dragStart: function dragStart() {\n\t      this.dragging = true;\n\t      this.$refs.slider.focus();\n\t    },\n\t    dragMove: function dragMove() {\n\t      var x = this.draggable.position.x;\n\t      var newValue = x / this.$refs.slider.getBoundingClientRect().width * 100;\n\t\n\t      this.setValue(newValue);\n\t    },\n\t    dragEnd: function dragEnd() {\n\t      this.dragging = false;\n\t    },\n\t    increment: function increment() {\n\t      if (this.value === 100) {\n\t        return;\n\t      }\n\t\n\t      this.setValue(this.value + this.keyboardStep, true);\n\t    },\n\t    decrement: function decrement() {\n\t      if (this.value === 0) {\n\t        return;\n\t      }\n\t\n\t      this.setValue(this.value - this.keyboardStep, true);\n\t    },\n\t    setValue: function setValue(newValue, updateThumb) {\n\t      var emit = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n\t\n\t      if (newValue === this.value) {\n\t        return;\n\t      }\n\t\n\t      var moderatedValue = Math.round(newValue);\n\t\n\t      if (moderatedValue >= 100) {\n\t        moderatedValue = 100;\n\t      }\n\t\n\t      if (moderatedValue <= 0) {\n\t        moderatedValue = 0;\n\t      }\n\t\n\t      this.value = moderatedValue;\n\t\n\t      if (updateThumb) {\n\t        this.$refs.thumb.style.left = this.value + '%';\n\t      }\n\t      if (emit) {\n\t        this.$emit('change-value', this.value);\n\t      }\n\t    }\n\t  }\n\t};\n\n/***/ }),\n\n/***/ 110:\n/***/ (function(module, exports) {\n\n\t// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 111:\n/***/ (function(module, exports) {\n\n\t// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 112:\n/***/ (function(module, exports) {\n\n\t// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 113:\n/***/ (function(module, exports) {\n\n\t// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 114:\n/***/ (function(module, exports) {\n\n\t// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 176:\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\n\t/* styles */\n\t__webpack_require__(112)\n\t\n\tvar Component = __webpack_require__(13)(\n\t  /* script */\n\t  __webpack_require__(62),\n\t  /* template */\n\t  __webpack_require__(182),\n\t  /* scopeId */\n\t  null,\n\t  /* cssModules */\n\t  null\n\t)\n\t\n\tmodule.exports = Component.exports\n\n\n/***/ }),\n\n/***/ 177:\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\n\t/* styles */\n\t__webpack_require__(110)\n\t\n\tvar Component = __webpack_require__(13)(\n\t  /* script */\n\t  __webpack_require__(63),\n\t  /* template */\n\t  __webpack_require__(180),\n\t  /* scopeId */\n\t  null,\n\t  /* cssModules */\n\t  null\n\t)\n\t\n\tmodule.exports = Component.exports\n\n\n/***/ }),\n\n/***/ 178:\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\n\t/* styles */\n\t__webpack_require__(113)\n\t\n\tvar Component = __webpack_require__(13)(\n\t  /* script */\n\t  __webpack_require__(64),\n\t  /* template */\n\t  __webpack_require__(183),\n\t  /* scopeId */\n\t  null,\n\t  /* cssModules */\n\t  null\n\t)\n\t\n\tmodule.exports = Component.exports\n\n\n/***/ }),\n\n/***/ 179:\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\n\t/* styles */\n\t__webpack_require__(111)\n\t\n\tvar Component = __webpack_require__(13)(\n\t  /* script */\n\t  __webpack_require__(65),\n\t  /* template */\n\t  __webpack_require__(181),\n\t  /* scopeId */\n\t  null,\n\t  /* cssModules */\n\t  null\n\t)\n\t\n\tmodule.exports = Component.exports\n\n\n/***/ }),\n\n/***/ 180:\n/***/ (function(module, exports) {\n\n\tmodule.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n\t  return _c('div', {\n\t    attrs: {\n\t      \"id\": \"ui-canvas\"\n\t    }\n\t  }, [_c('canvas', {\n\t    attrs: {\n\t      \"id\": \"fixed-canvas\"\n\t    }\n\t  }), _vm._v(\" \"), _c('canvas', {\n\t    ref: \"drawing\",\n\t    attrs: {\n\t      \"id\": \"drawing\"\n\t    },\n\t    on: {\n\t      \"mousedown\": _vm.mousedown,\n\t      \"touchstart\": _vm.mousedown,\n\t      \"mousemove\": _vm.mousemove,\n\t      \"touchmove\": _vm.mousemove,\n\t      \"mouseup\": _vm.mouseup,\n\t      \"touchend\": _vm.mouseup,\n\t      \"mouseleave\": _vm.mouseup\n\t    }\n\t  })])\n\t},staticRenderFns: []}\n\n/***/ }),\n\n/***/ 181:\n/***/ (function(module, exports) {\n\n\tmodule.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n\t  return _c('div', {\n\t    ref: \"slider\",\n\t    staticClass: \"ui-slider\",\n\t    class: {\n\t      min: _vm.value === 0, max: _vm.value === 100, dragging: _vm.dragging\n\t    },\n\t    attrs: {\n\t      \"tabindex\": \"0\"\n\t    },\n\t    on: {\n\t      \"mousedown\": _vm.sliderClick,\n\t      \"keydown\": [function($event) {\n\t        if (!('button' in $event) && _vm._k($event.keyCode, \"left\", 37, $event.key)) { return null; }\n\t        if ('button' in $event && $event.button !== 0) { return null; }\n\t        $event.preventDefault();\n\t        _vm.decrement($event)\n\t      }, function($event) {\n\t        if (!('button' in $event) && _vm._k($event.keyCode, \"right\", 39, $event.key)) { return null; }\n\t        if ('button' in $event && $event.button !== 2) { return null; }\n\t        $event.preventDefault();\n\t        _vm.increment($event)\n\t      }]\n\t    }\n\t  }, [_c('div', {\n\t    ref: \"container\",\n\t    staticClass: \"ui-slider-containment\"\n\t  }), _vm._v(\" \"), _c('div', {\n\t    staticClass: \"ui-slider-wrapper\"\n\t  }, [_c('div', {\n\t    staticClass: \"ui-slider-track-container\"\n\t  }, [_c('div', {\n\t    staticClass: \"ui-slider-track\"\n\t  }), _vm._v(\" \"), _c('div', {\n\t    staticClass: \"ui-slider-track-fill\",\n\t    style: ({\n\t      width: _vm.value + '%'\n\t    })\n\t  })]), _vm._v(\" \"), _c('div', {\n\t    ref: \"thumb\",\n\t    staticClass: \"ui-slider-thumb-container\"\n\t  }, [_c('div', {\n\t    staticClass: \"ui-slider-focus-ring\"\n\t  }), _vm._v(\" \"), _c('div', {\n\t    ref: \"thumbCircle\",\n\t    staticClass: \"ui-slider-thumb\"\n\t  })])])])\n\t},staticRenderFns: []}\n\n/***/ }),\n\n/***/ 182:\n/***/ (function(module, exports) {\n\n\tmodule.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n\t  return _c('div', {\n\t    attrs: {\n\t      \"id\": \"app\"\n\t    }\n\t  }, [_c('ui-canvas', {\n\t    attrs: {\n\t      \"current-color\": _vm.currentColor,\n\t      \"current-tool\": _vm.currentTool,\n\t      \"prev-tool\": _vm.prevTool,\n\t      \"tool-sizes\": _vm.toolSizes,\n\t      \"drawing-manager\": _vm.drawingManager\n\t    },\n\t    on: {\n\t      \"ontune\": _vm.ontune,\n\t      \"onextractcolor\": _vm.onextractcolor\n\t    }\n\t  }), _vm._v(\" \"), _c('div', {\n\t    directives: [{\n\t      name: \"show\",\n\t      rawName: \"v-show\",\n\t      value: (_vm.showPalette),\n\t      expression: \"showPalette\"\n\t    }],\n\t    staticClass: \"palette\"\n\t  }, [_c('sketch', {\n\t    ref: \"colorPicker\",\n\t    attrs: {\n\t      \"id\": \"color-picker\"\n\t    },\n\t    on: {\n\t      \"change-color\": _vm.onchange\n\t    },\n\t    model: {\n\t      value: (_vm.currentColor),\n\t      callback: function($$v) {\n\t        _vm.currentColor = $$v\n\t      },\n\t      expression: \"currentColor\"\n\t    }\n\t  }), _vm._v(\" \"), _c('ui-slider', {\n\t    ref: \"slider\",\n\t    attrs: {\n\t      \"defaultValue\": _vm.defaultSize\n\t    },\n\t    on: {\n\t      \"change-value\": _vm.onchangesize\n\t    }\n\t  })], 1), _vm._v(\" \"), _c('div', {\n\t    attrs: {\n\t      \"id\": \"layer-box\"\n\t    }\n\t  }, [(_vm.drawingManager) ? _c('ui-layer-list', {\n\t    staticClass: \"layer-list\",\n\t    attrs: {\n\t      \"layers\": _vm.drawingManager.layers\n\t    },\n\t    on: {\n\t      \"onclear\": _vm.onclear,\n\t      \"rollback\": _vm.rollback\n\t    }\n\t  }) : _vm._e(), _vm._v(\" \"), _c('div', {\n\t    attrs: {\n\t      \"id\": \"show-layer-box\"\n\t    }\n\t  }, [_c('md-switch', {\n\t    on: {\n\t      \"change\": _vm.onchangevisiual\n\t    },\n\t    model: {\n\t      value: (_vm.showPen),\n\t      callback: function($$v) {\n\t        _vm.showPen = $$v\n\t      },\n\t      expression: \"showPen\"\n\t    }\n\t  }, [_vm._v(\"\")]), _vm._v(\" \"), _c('md-switch', {\n\t    on: {\n\t      \"change\": _vm.onchangevisiual\n\t    },\n\t    model: {\n\t      value: (_vm.showBase),\n\t      callback: function($$v) {\n\t        _vm.showBase = $$v\n\t      },\n\t      expression: \"showBase\"\n\t    }\n\t  }, [_vm._v(\"\")]), _vm._v(\" \"), _c('md-switch', {\n\t    on: {\n\t      \"change\": _vm.onchangevisiual\n\t    },\n\t    model: {\n\t      value: (_vm.showExtra),\n\t      callback: function($$v) {\n\t        _vm.showExtra = $$v\n\t      },\n\t      expression: \"showExtra\"\n\t    }\n\t  }, [_vm._v(\"\")])], 1)], 1), _vm._v(\" \"), _c('div', {\n\t    attrs: {\n\t      \"id\": \"canvas-box\"\n\t    }\n\t  }, [_c('md-button', {\n\t    staticClass: \"md-fab\",\n\t    on: {\n\t      \"click\": _vm.newcanvas\n\t    }\n\t  }, [_c('md-icon', [_vm._v(\"note_add\")])], 1), _vm._v(\" \"), _c('md-button', {\n\t    staticClass: \"md-fab md-mini\",\n\t    on: {\n\t      \"click\": _vm.togglepalette\n\t    }\n\t  }, [_c('md-icon', [_vm._v(\"palette\")])], 1)], 1), _vm._v(\" \"), _c('div', {\n\t    attrs: {\n\t      \"id\": \"tool-box\"\n\t    }\n\t  }, [_c('md-button-toggle', {\n\t    ref: \"toolButtons\",\n\t    staticClass: \"md-accent\",\n\t    attrs: {\n\t      \"md-single\": \"\"\n\t    }\n\t  }, [_c('md-button', {\n\t    ref: \"penButton\",\n\t    staticClass: \"md-icon-button md-toggle\",\n\t    on: {\n\t      \"click\": function($event) {\n\t        _vm.toggletool(\"pen\")\n\t      }\n\t    }\n\t  }, [_c('md-icon', [_vm._v(\"edit\")])], 1), _vm._v(\" \"), _c('md-button', {\n\t    ref: \"brushButton\",\n\t    staticClass: \"md-icon-button\",\n\t    on: {\n\t      \"click\": function($event) {\n\t        _vm.toggletool(\"brush\")\n\t      }\n\t    }\n\t  }, [_c('md-icon', [_vm._v(\"brush\")])], 1), _vm._v(\" \"), _c('md-button', {\n\t    staticClass: \"md-icon-button\",\n\t    on: {\n\t      \"click\": function($event) {\n\t        _vm.toggletool(\"eraser\")\n\t      }\n\t    }\n\t  }, [_c('md-icon', [_vm._v(\"call_to_action\")])], 1), _vm._v(\" \"), _c('md-button', {\n\t    staticClass: \"md-icon-button\",\n\t    on: {\n\t      \"click\": function($event) {\n\t        _vm.toggletool(\"spoit\")\n\t      }\n\t    }\n\t  }, [_c('md-icon', [_vm._v(\"colorize\")])], 1), _vm._v(\" \"), _c('md-button', {\n\t    staticClass: \"md-icon-button\",\n\t    on: {\n\t      \"click\": function($event) {\n\t        _vm.toggletool(\"color\")\n\t      }\n\t    }\n\t  }, [_c('md-icon', [_vm._v(\"tune\")])], 1)], 1)], 1), _vm._v(\" \"), _c('md-dialog', {\n\t    ref: \"colorDialog\",\n\t    attrs: {\n\t      \"id\": \"color-dialog\"\n\t    }\n\t  }, [_c('md-dialog-title', [_vm._v(\"\")]), _vm._v(\" \"), _c('md-dialog-content', [_vm._v(\"\\n      \\n      \"), _c('ui-slider', {\n\t    ref: \"hueSlider\",\n\t    attrs: {\n\t      \"defaultValue\": 50\n\t    },\n\t    on: {\n\t      \"change-value\": _vm.onchangehue\n\t    }\n\t  }), _vm._v(\"\\n      \\n      \"), _c('ui-slider', {\n\t    ref: \"satSlider\",\n\t    attrs: {\n\t      \"defaultValue\": 50\n\t    },\n\t    on: {\n\t      \"change-value\": _vm.onchangesat\n\t    }\n\t  }), _vm._v(\"\\n      \\n      \"), _c('ui-slider', {\n\t    ref: \"valSlider\",\n\t    attrs: {\n\t      \"defaultValue\": 50\n\t    },\n\t    on: {\n\t      \"change-value\": _vm.onchangeval\n\t    }\n\t  })], 1), _vm._v(\" \"), _c('md-dialog-actions', [_c('md-button', {\n\t    staticClass: \"md-primary\",\n\t    on: {\n\t      \"click\": _vm.closeColorDialog\n\t    }\n\t  }, [_vm._v(\"\")]), _vm._v(\" \"), _c('md-button', {\n\t    staticClass: \"md-primary\",\n\t    on: {\n\t      \"click\": _vm.applyColorDialog\n\t    }\n\t  }, [_vm._v(\"\")])], 1)], 1)], 1)\n\t},staticRenderFns: []}\n\n/***/ }),\n\n/***/ 183:\n/***/ (function(module, exports) {\n\n\tmodule.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n\t  return _c('div', {\n\t    attrs: {\n\t      \"id\": \"ui-layer-list\"\n\t    }\n\t  }, [(_vm.layers) ? _c('ul', _vm._l((_vm.layers), function(layer, i) {\n\t    return _c('li', {\n\t      on: {\n\t        \"mouseover\": function($event) {\n\t          _vm.mouseover(i)\n\t        },\n\t        \"mouseleave\": function($event) {\n\t          _vm.mouseleave(i)\n\t        }\n\t      }\n\t    }, [_c('md-button', {\n\t      on: {\n\t        \"click\": function($event) {\n\t          _vm.clear(i)\n\t        }\n\t      }\n\t    }, [_c('md-icon', [_vm._v(\"clear\")])], 1), _vm._v(\" \"), _c('img', {\n\t      attrs: {\n\t        \"src\": layer.url\n\t      }\n\t    }), _vm._v(\" \"), (layer.histories && _vm.active === i) ? _c('ul', _vm._l((layer.histories), function(history, j) {\n\t      return _c('li', {\n\t        staticStyle: {\n\t          \"display\": \"inline\"\n\t        }\n\t      }, [_c('img', {\n\t        attrs: {\n\t          \"src\": history\n\t        },\n\t        on: {\n\t          \"click\": function($event) {\n\t            _vm.rollback(i, j)\n\t          }\n\t        }\n\t      })])\n\t    })) : _vm._e()], 1)\n\t  })) : _vm._e()])\n\t},staticRenderFns: []}\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// static/js/app.73294db1681dae71608e.js","// The Vue build version to load with the `import` command\n// (runtime-only or standalone) has been set in webpack.base.conf with an alias.\nimport Vue from 'vue';\nimport App from './App';\n\n/* eslint-disable no-new */\nnew Vue({\n  el: '#app',\n  template: '<App/>',\n  components: { App },\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.js","const tools = {\n  PEN: window.Symbol('PEN'),\n  BRUSH: window.Symbol('BRUSH'),\n  ERASER: window.Symbol('ERASER'),\n  SPOIT: window.Symbol('SPOIT'),\n  FILL: window.Symbol('FILL'),\n  COLOR: window.Symbol('COLOR'),\n  fromName: (name) => {\n    switch (name) {\n      case 'pen':\n        return tools.PEN;\n      case 'brush':\n        return tools.BRUSH;\n      case 'eraser':\n        return tools.ERASER;\n      case 'spoit':\n        return tools.SPOIT;\n      case 'fill':\n        return tools.FILL;\n      case 'color':\n        return tools.COLOR;\n      default:\n        return undefined;\n    }\n  },\n};\n\nexport default tools;\n\n\n\n// WEBPACK FOOTER //\n// ./src/libs/Tools.js","import Color from 'color';\nimport tools from '../libs/Tools';\n\nclass Drawing {\n  constructor(mainColor, tool, canvas,\n    width = 0, height = 0, showPen = true, showBase = true, showExtra = true) {\n    this.mainColor = mainColor;\n    this.tool = tool;\n    this.canvas = canvas;\n    this.url = null;\n    this.history = null;\n    this.shape = document.createElement('canvas');\n    this.overlap = document.createElement('canvas');\n    this.showPen = showPen;\n    this.showBase = showBase;\n    this.showExtra = showExtra;\n\n    if (width === 0 && height === 0) {\n      const style = canvas.currentStyle || window.getComputedStyle(canvas);\n      this.styleWidth = window.parseInt(style.width);\n      this.styleHeight = window.parseInt(style.height);\n    } else {\n      this.styleWidth = width;\n      this.styleHeight = height;\n    }\n\n    const ctx = canvas.getContext('2d');\n    this.canvas.width = this.styleWidth * window.devicePixelRatio;\n    this.canvas.height = this.styleHeight * window.devicePixelRatio;\n    this.canvas.style.width = this.styleWidth;\n    this.canvas.style.height = this.styleHeight;\n    ctx.scale(window.devicePixelRatio, window.devicePixelRatio);\n\n    Drawing.setupCanvas(this.canvas, this.styleWidth, this.styleHeight);\n    Drawing.setupCanvas(this.shape, this.styleWidth, this.styleHeight);\n    Drawing.setupCanvas(this.overlap, this.styleWidth, this.styleHeight);\n\n    Object.defineProperties(this, {\n      _mainColor: {\n        value: this.mainColor,\n      },\n      _canvas: {\n        value: this.canvas,\n      },\n    });\n  }\n\n  static setupCanvas(canvas, styleWidth, styleHeight) {\n    /* eslint-disable no-param-reassign */\n    const ctx = canvas.getContext('2d');\n    canvas.width = styleWidth * window.devicePixelRatio;\n    canvas.height = styleHeight * window.devicePixelRatio;\n    canvas.style.width = styleWidth;\n    canvas.style.height = styleHeight;\n    ctx.scale(window.devicePixelRatio, window.devicePixelRatio);\n  }\n\n  draw(path, color, tool, size) {\n    if (path.length === 0) {\n      return;\n    }\n\n    const ctx = this.canvas.getContext('2d');\n    ctx.lineCap = 'round';\n    switch (tool) {\n      case tools.PEN:\n      case tools.BRUSH:\n        ctx.strokeStyle = color.hex;\n        ctx.globalAlpha = color.a;\n        break;\n      case tools.ERASER:\n        ctx.strokeStyle = '#fff';\n        ctx.globalAlpha = 1.0;\n        break;\n      default:\n        return;\n    }\n    ctx.lineWidth = size;\n    ctx.globalCompositeOperation = 'source-over';\n\n    ctx.beginPath();\n    for (let i = 0; i < Math.max(path.length - 1, 1); i += 1) {\n      const [cx, cy] = path[i];\n      const [nx, ny] = path[i + 1] || path[i];\n      ctx.moveTo(cx, cy);\n      ctx.lineTo(nx, ny);\n    }\n    ctx.stroke();\n    // this.updateCanvas();\n    this.url = null;\n  }\n\n  // TODO: \n  drawObjectComp(obj, editRange) {\n    const ctx = this.shape.getContext('2d');\n    if (editRange) {\n      ctx.drawImage(\n        obj.shape,\n        editRange.lx * window.devicePixelRatio,\n        editRange.ly * window.devicePixelRatio,\n        (editRange.rx - editRange.lx) * window.devicePixelRatio,\n        (editRange.ry - editRange.ly) * window.devicePixelRatio,\n        editRange.lx, editRange.ly,\n        editRange.rx - editRange.lx, editRange.ry - editRange.ly\n      );\n    } else {\n      ctx.drawImage(obj.shape, 0, 0, this.styleWidth, this.styleHeight);\n    }\n    const ctx2 = this.overlap.getContext('2d');\n    if (editRange) {\n      ctx2.drawImage(\n        obj.canvas,\n        editRange.lx * window.devicePixelRatio,\n        editRange.ly * window.devicePixelRatio,\n        (editRange.rx - editRange.lx) * window.devicePixelRatio,\n        (editRange.ry - editRange.ly) * window.devicePixelRatio,\n        editRange.lx, editRange.ly,\n        editRange.rx - editRange.lx, editRange.ry - editRange.ly\n      );\n    } else {\n      ctx2.drawImage(obj.overlap, 0, 0, this.styleWidth, this.styleHeight);\n    }\n    this.updateCanvas();\n    this.url = null;\n  }\n\n  drawObject(obj, editRange) {\n    if (this.tool) {\n      if (this.tool === 'Symbol(PEN)' && !this.showPen) {\n        return;\n      }\n      if (this.tool === 'Symbol(BRUSH)' && !this.showBase) {\n        return;\n      }\n    }\n    const ctx = this.shape.getContext('2d');\n    if (editRange) {\n      ctx.drawImage(\n        obj.canvas,\n        editRange.lx * window.devicePixelRatio,\n        editRange.ly * window.devicePixelRatio,\n        (editRange.rx - editRange.lx) * window.devicePixelRatio,\n        (editRange.ry - editRange.ly) * window.devicePixelRatio,\n        editRange.lx, editRange.ly,\n        editRange.rx - editRange.lx, editRange.ry - editRange.ly\n      );\n    } else {\n      ctx.drawImage(obj.canvas, 0, 0, this.styleWidth, this.styleHeight);\n    }\n    this.updateCanvas();\n    this.url = null;\n  }\n\n  drawOverlapObject(obj, editRange) {\n    if (!this.showExtra) {\n      return;\n    }\n    const ctx = this.overlap.getContext('2d');\n    if (editRange) {\n      ctx.drawImage(\n        obj.canvas,\n        editRange.lx * window.devicePixelRatio,\n        editRange.ly * window.devicePixelRatio,\n        (editRange.rx - editRange.lx) * window.devicePixelRatio,\n        (editRange.ry - editRange.ly) * window.devicePixelRatio,\n        editRange.lx, editRange.ly,\n        editRange.rx - editRange.lx, editRange.ry - editRange.ly\n      );\n    } else {\n      ctx.drawImage(obj.canvas, 0, 0, this.styleWidth, this.styleHeight);\n    }\n    this.updateCanvas();\n    this.url = null;\n  }\n\n  eraseObject(obj/* , editRange */) {\n    if (this.tool) {\n      if (this.tool === 'Symbol(PEN)' && !this.showPen) {\n        return;\n      }\n      if (this.tool === 'Symbol(BRUSH)' && !this.showBase) {\n        return;\n      }\n    }\n    const ctx = this.shape.getContext('2d');\n    // if (editRange) {\n    //   ctx.drawImage(\n    //     obj.canvas,\n    //     editRange.lx * window.devicePixelRatio,\n    //     editRange.ly * window.devicePixelRatio,\n    //     (editRange.rx - editRange.lx) * window.devicePixelRatio,\n    //     (editRange.ry - editRange.ly) * window.devicePixelRatio,\n    //     editRange.lx, editRange.ly,\n    //     editRange.rx - editRange.lx, editRange.ry - editRange.ly\n    //   );\n    // } else {\n    ctx.globalCompositeOperation = 'destination-out';\n    ctx.drawImage(obj.canvas, 0, 0, this.styleWidth, this.styleHeight);\n    ctx.globalCompositeOperation = 'source-over';\n    // }\n    this.updateCanvas();\n    this.url = null;\n  }\n\n  eraseOverlapObject(obj/* , editRange */) {\n    if (!this.showExtra) {\n      return;\n    }\n    const ctx = this.overlap.getContext('2d');\n    // if (editRange) {\n    //   ctx.drawImage(\n    //     obj.canvas,\n    //     editRange.lx * window.devicePixelRatio,\n    //     editRange.ly * window.devicePixelRatio,\n    //     (editRange.rx - editRange.lx) * window.devicePixelRatio,\n    //     (editRange.ry - editRange.ly) * window.devicePixelRatio,\n    //     editRange.lx, editRange.ly,\n    //     editRange.rx - editRange.lx, editRange.ry - editRange.ly\n    //   );\n    // } else {\n    ctx.globalCompositeOperation = 'destination-out';\n    ctx.drawImage(obj.canvas, 0, 0, this.styleWidth, this.styleHeight);\n    ctx.globalCompositeOperation = 'source-over';\n    // }\n    this.canvas.getContext('2d').clearRect(0, 0, this.styleWidth, this.styleHeight);\n    this.updateCanvas();\n    this.url = null;\n  }\n\n  clear(editRange) {\n    const ctx = this.canvas.getContext('2d');\n    if (editRange) {\n      ctx.clearRect(\n        editRange.lx, editRange.ly,\n        editRange.rx - editRange.lx, editRange.ry - editRange.ly\n      );\n    } else {\n      ctx.clearRect(0, 0, this.styleWidth, this.styleHeight);\n    }\n    const ctx2 = this.shape.getContext('2d');\n    if (editRange) {\n      ctx2.clearRect(\n        editRange.lx, editRange.ly,\n        editRange.rx - editRange.lx, editRange.ry - editRange.ly\n      );\n    } else {\n      ctx2.clearRect(0, 0, this.styleWidth, this.styleHeight);\n    }\n    const ctx3 = this.shape.getContext('2d');\n    if (editRange) {\n      ctx3.clearRect(\n        editRange.lx, editRange.ly,\n        editRange.rx - editRange.lx, editRange.ry - editRange.ly\n      );\n    } else {\n      ctx3.clearRect(0, 0, this.styleWidth, this.styleHeight);\n    }\n    this.url = null;\n  }\n\n  colorTune(origShape, origOverlap, info) {\n    Drawing.tune(origShape, this.shape, info);\n    Drawing.tune(origOverlap, this.overlap, info);\n    this.updateCanvas();\n    this.url = null;\n  }\n\n  static tune(orig, canvas, info) {\n    const copied = new Uint8ClampedArray(orig.data);\n    copied.set(orig);\n    const ps = new window.ImageData(\n      copied,\n      canvas.width, canvas.height\n    );\n    const cache = {};\n    for (let i = 0; i < ps.data.length; i += 4) {\n      // Alpha\n      if (ps.data[i + 3] === 0) {\n        /* eslint-disable no-continue */\n        continue;\n      }\n      let newColor;\n      const c = cache[ps.data.slice(i, i + 4).join(',')];\n      if (c) {\n        newColor = c;\n      } else {\n        /* eslint-disable no-mixed-operators */\n        newColor = Color.rgb(ps.data.slice(i, i + 4))\n          .rotate(info.hue)\n          .saturate(info.sat)\n          .lighten(info.val);\n        newColor = newColor.rgb().array();\n        cache[ps.data.slice(i, i + 4).join(',')] = [].concat(newColor);\n      }\n      ps.data[i] = newColor[0];\n      ps.data[i + 1] = newColor[1];\n      ps.data[i + 2] = newColor[2];\n    }\n    canvas.getContext('2d').putImageData(ps, 0, 0);\n  }\n\n  updateCanvas(editRange) {\n    const ctxOrig = this.canvas.getContext('2d');\n    if (!this.tool\n      || (this.tool === 'Symbol(PEN)' && this.showPen)\n      || (this.tool === 'Symbol(BRUSH)' && this.showBase)) {\n      if (editRange) {\n        const w = (editRange.rx - editRange.lx) * window.devicePixelRatio;\n        const h = (editRange.ry - editRange.ly) * window.devicePixelRatio;\n        ctxOrig.putImageData(\n          this.shape.getContext('2d').getImageData(editRange.lx, editRange.ly, w, h), editRange.lx, editRange.ly\n        );\n      } else {\n        ctxOrig.putImageData(\n          this.shape.getContext('2d').getImageData(0, 0, this.shape.width, this.shape.height), 0, 0\n        );\n      }\n      ctxOrig.globalCompositeOperation = 'source-atop';\n    }\n    if (this.tool === 'Symbol(BRUSH)' && this.showExtra) {\n      ctxOrig.drawImage(this.overlap, 0, 0, this.styleWidth, this.styleHeight);\n    }\n    ctxOrig.globalCompositeOperation = 'source-over';\n  }\n\n  changeVisual(pen, base, extra) {\n    this.showPen = pen;\n    this.showBase = base;\n    this.showExtra = extra;\n    this.url = null;\n    this.canvas.getContext('2d').clearRect(0, 0, this.canvas.width, this.canvas.height);\n    this.updateCanvas();\n  }\n\n  get imageUrl() {\n    if (!this.url) {\n      this.url = this.canvas.toDataURL();\n    }\n    return this.url;\n  }\n}\n\nexport default Drawing;\n\n\n\n// WEBPACK FOOTER //\n// ./src/libs/Drawing.js","/* eslint-disable no-param-reassign */\n/* eslint-disable no-mixed-operators */\nconst hslToYuv = (h, s, l) => {\n  h /= 360;\n  s /= 100;\n  l /= 100;\n\n  let r;\n  let g;\n  let b;\n\n  if (s === 0) {\n    r = g = b = l; // achromatic\n  } else {\n    const hue2rgb = (p, q, t) => {\n      if (t < 0) t += 1;\n      if (t > 1) t -= 1;\n      if (t < 1 / 6) return p + (q - p) * 6 * t;\n      if (t < 1 / 2) return q;\n      if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6;\n      return p;\n    };\n\n    const q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n    const p = 2 * l - q;\n    r = hue2rgb(p, q, h + 1 / 3);\n    g = hue2rgb(p, q, h);\n    b = hue2rgb(p, q, h - 1 / 3);\n  }\n\n  r = Math.round(r * 255);\n  g = Math.round(g * 255);\n  b = Math.round(b * 255);\n\n  const y = (0.299 * r + 0.587 * g + 0.114 * b);\n  const u = (-0.169 * r - 0.331 * g + 0.500 * b);\n  const v = (0.500 * r - 0.419 * g - 0.081 * b);\n\n  return [y, u, v];\n};\n\nconst rgbToYuv = (rgb) => {\n  const r = Math.round(rgb[0]);\n  const g = Math.round(rgb[1]);\n  const b = Math.round(rgb[2]);\n\n  const y = (0.299 * r + 0.587 * g + 0.114 * b);\n  const u = (-0.169 * r - 0.331 * g + 0.500 * b);\n  const v = (0.500 * r - 0.419 * g - 0.081 * b);\n\n  return [y, u, v];\n};\n\nexport { hslToYuv, rgbToYuv };\n\n\n\n// WEBPACK FOOTER //\n// ./src/libs/ColorUtil.js","import kmeans from 'ml-kmeans';\nimport dist from 'ml-distance';\n\nimport Drawing from './Drawing';\nimport tools from '../libs/Tools';\nimport { rgbToYuv } from '../libs/ColorUtil';\n\nconst MEASURE_ITER_COUNT = 500;\nconst SORT_DIV = 1;\n\nlet layerIndex = 0;\n\nclass DrawingManager {\n  constructor(canvas) {\n    const style = canvas.currentStyle || window.getComputedStyle(canvas);\n    this.styleWidth = window.parseInt(style.width);\n    this.styleHeight = window.parseInt(style.height);\n    this.fixedObject = new Drawing(null, null, canvas, this.styleWidth, this.styleHeight);\n    this.objects = {};\n    this.objectIndexes = [];\n    this.layers = [];\n    this.histories = [];\n    this.sortCache = {};\n    this.lastKey = null;\n    this.clearedKey = null;\n    this.showPen = true;\n    this.showBase = true;\n    this.showExtra = true;\n\n    Object.defineProperties(this, {\n      _styleWidth: {\n        value: this.styleWidth,\n      },\n      _styleHeight: {\n        value: this.styleHeight,\n      },\n    });\n  }\n\n  static getKey(tool, r, g, b) {\n    layerIndex += 1;\n    const idx = tool === tools.PEN ? 0 : layerIndex;\n    return `${tool.toString()},${r},${g},${b},${idx}`;\n  }\n\n  static getToolString(key) {\n    return key.split(',')[0];\n  }\n\n  static getColorString(key) {\n    return key.split(',').splice(1, 3).join(',');\n  }\n\n  static getColor(colorString) {\n    return colorString.split(',').map(x => parseInt(x, 10));\n  }\n\n  static getImageDataFaster(_x, _y, _w, d) {\n    const x = Math.round(_x);\n    const y = Math.round(_y);\n    const w = Math.round(_w);\n    const r = d[((y * w) + x) * 4];\n    const g = d[(((y * w) + x) * 4) + 1];\n    const b = d[(((y * w) + x) * 4) + 2];\n    const a = d[(((y * w) + x) * 4) + 3];\n    return [r, g, b, a];\n  }\n\n  static measureArea(imgdata, width, height, targetColors, range) {\n    const hits = new Array(targetColors.length);\n    hits.fill(0);\n    let w = width;\n    let h = height;\n    let ox = 0;\n    let oy = 0;\n    if (range) {\n      w = ((range.rx - range.lx) / SORT_DIV) * window.devicePixelRatio;\n      h = ((range.ry - range.ly) / SORT_DIV) * window.devicePixelRatio;\n      ox = (range.lx / SORT_DIV) * window.devicePixelRatio;\n      oy = (range.ly / SORT_DIV) * window.devicePixelRatio;\n    }\n    for (let i = 0; i < MEASURE_ITER_COUNT; i += 1) {\n      const x = Math.round((Math.random() * (w - 1)) + ox);\n      const y = Math.round((Math.random() * (h - 1)) + oy);\n      const p = DrawingManager.getImageDataFaster(x, y, Math.round(width), imgdata);\n      for (let j = 0; j < targetColors.length; j += 1) {\n        const c = targetColors[j];\n        if (p[0] === c[0] && p[1] === c[1] && p[2] === c[2]) {\n          hits[j] += 1;\n        }\n      }\n    }\n    return hits;\n  }\n\n  static filledColor(imgdata, points, width) {\n    for (const point of points) {\n      const p = DrawingManager.getImageDataFaster(point[0], point[1], Math.round(width), imgdata);\n      if (!(p[0] === 0 && p[1] === 0 && p[2] === 0 && p[3] === 0)) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  static spoitColor(imgdata, points, width) {\n    for (const point of points) {\n      const p = DrawingManager.getImageDataFaster(point[0], point[1], Math.round(width), imgdata);\n      if (!(p[0] === 0 && p[1] === 0 && p[2] === 0 && p[3] === 0)) {\n        return p;\n      }\n    }\n    return null;\n  }\n\n  static d(arr, before) {\n    let result = [];\n    const kms = [null, null];\n    const bics = [Number.NEGATIVE_INFINITY, Number.NEGATIVE_INFINITY];\n    for (let i = 0; i < 2; i += 1) {\n      if (arr.cluster_arr[i].length < 2) {\n        /* eslint-disable no-continue */\n        continue;\n      }\n      const km = kmeans(arr.cluster_arr[i], 2);\n      let newArr = [];\n      newArr = newArr.concat(arr.cluster_arr[i]);\n      newArr = newArr.concat(arr.cluster_arr[1 - i]);\n      for (let j = 0; j < arr.cluster_arr[1 - i].length; j += 1) {\n        km.clusters.push(2);\n      }\n\n      const res = DrawingManager.computeBic(newArr, km);\n      if (res.bic > before) {\n        bics[i] = res.bic;\n        kms[i] = km;\n      }\n    }\n\n    if (bics[0] > before || bics[1] > before) {\n      for (let i = 0; i < 2; i += 1) {\n        if (bics[i] > before) {\n          const km = kms[i];\n          const clusters = new Array(2);\n          for (let k = 0; k < km.clusters.length; k += 1) {\n            if (!clusters[km.clusters[k]]) {\n              clusters[km.clusters[k]] = [];\n            }\n            clusters[km.clusters[k]].push(arr.cluster_arr[i][k]);\n          }\n          km.arr = arr.cluster_arr[i];\n          km.cluster_arr = clusters;\n          result = result.concat(DrawingManager.d(km, bics[i]));\n        } else {\n          result.push(arr.cluster_arr[i]);\n        }\n      }\n    } else {\n      result.push([].concat(arr.cluster_arr[0], arr.cluster_arr[1]));\n    }\n    return result;\n  }\n\n  static divide(arr) {\n    if (arr.length < 2) {\n      return [arr];\n    }\n    const km = kmeans(arr, 2);\n    const clusters = new Array(2);\n    for (let i = 0; i < km.clusters.length; i += 1) {\n      if (!clusters[km.clusters[i]]) {\n        clusters[km.clusters[i]] = [];\n      }\n      clusters[km.clusters[i]].push(arr[i]);\n    }\n    if (!clusters[1]) {\n      return [arr];\n    }\n\n    km.arr = arr;\n    km.cluster_arr = clusters;\n    const res = DrawingManager.computeBic(arr, km);\n    const resClusters = DrawingManager.d(km, res.bic);\n    return resClusters;\n  }\n\n  static computeBic(arr, km) {\n    const centers = km.centroids.map(x => x.centroid);\n    const labels = km.clusters;\n    const m = km.centroids.length;\n    const n = km.centroids.map(x => x.size);\n    const N = arr.length;\n    const d = arr[0].length;\n\n    const clusters = new Array(m);\n    for (let i = 0; i < km.clusters.length; i += 1) {\n      if (!clusters[km.clusters[i]]) {\n        clusters[km.clusters[i]] = [];\n      }\n      clusters[km.clusters[i]].push(arr[i]);\n    }\n\n    let s = 0;\n    for (let i = 0; i < m; i += 1) {\n      for (let j = 0; j < N; j += 1) {\n        if (i === labels[j]) {\n          s += dist.distance.euclidean(arr[j], centers[i]);\n        }\n      }\n    }\n    const clVar = (1.0 / (N - m) / d) * s;\n    const constTerm = 0.5 * m * Math.log(N) * (d + 1);\n    if (!clVar) {\n      return { clusters, centers, bic: Number.NEGATIVE_INFINITY };\n    }\n    let bic = 0;\n    for (let i = 0; i < m; i += 1) {\n      const b = n[i];\n      /* eslint-disable max-len */\n      /* eslint-disable  no-mixed-operators */\n      bic += b * Math.log(b) - b * Math.log(N) - ((b * d) / 2) * Math.log(2 * Math.PI * clVar) - ((b - 1) * d / 2);\n    }\n    bic -= constTerm;\n    return { clusters, centers, bic };\n  }\n\n  draw(obj, color, tool, editRange) {\n    switch (tool) {\n      case tools.PEN:\n        this.drawPen(obj, color, tool, editRange);\n        break;\n      case tools.BRUSH:\n        this.drawBrush(obj, color, tool, editRange);\n        break;\n      default:\n        break;\n    }\n\n    this.updateSort();\n    // TODO: editRange \n    // this.update(editRange);\n    this.update();\n  }\n\n  drawPen(obj, color, tool) {\n    if (!this.showPen) {\n      return;\n    }\n    const key = DrawingManager.getKey(tool, color.rgba.r, color.rgba.g, color.rgba.b);\n    let target;\n    if (this.objectIndexes.indexOf(key) === -1) {\n      const canvas = document.createElement('canvas');\n      target = new Drawing(color, tool.toString(), canvas, this.styleWidth, this.styleHeight, this.showPen, this.showBase, this.showExtra);\n      this.objectIndexes.push(key);\n      if (this.clearedKey && DrawingManager.getToolString(this.clearedKey) === 'Symbol(PEN)' && this.objects[this.clearedKey]) {\n        target.history = Object.assign({}, this.objects[this.clearedKey]);\n      }\n      this.clearedKey = null;\n    } else {\n      target = this.objects[key];\n    }\n    target.drawObject(obj);\n    this.objects[key] = target;\n    this.lastKey = key;\n  }\n\n  drawBrush(obj, color, tool, editRange) {\n    if (!this.showBase) {\n      return;\n    }\n    const key = DrawingManager.getKey(tool, color.rgba.r, color.rgba.g, color.rgba.b);\n    const currentColorString = DrawingManager.getColorString(key);\n\n    const allColors = this.objectIndexes.filter(x => DrawingManager.getToolString(x) === 'Symbol(BRUSH)').map(x => DrawingManager.getColor(DrawingManager.getColorString(x)));\n    allColors.push(DrawingManager.getColor(currentColorString));\n\n    const overlapping = this.checkOverlap(obj, editRange);\n    let colors = [];\n    colors = colors.concat(overlapping.comp.map(x => DrawingManager.getColorString(x)));\n    colors = colors.concat(overlapping.spilled.map(x => DrawingManager.getColorString(x)));\n    colors = colors.filter((x, i, self) => self.indexOf(x) === i);\n\n    // if (overlapping.comp.length > 0) {\n    //\n    // } else {\n    //\n    // }\n    const sameIndexes = [];\n    let last = -1;\n    /* eslint-disable no-constant-condition */\n    while (true) {\n      const idx = colors.indexOf(currentColorString, last + 1);\n      if (idx === -1) {\n        break;\n      }\n      sameIndexes.push(idx);\n      last = idx;\n    }\n\n    const simIndexes = [];\n\n    const currentColor = DrawingManager.getColor(currentColorString);\n    const b = rgbToYuv(currentColor);\n    for (let i = 0; i < colors.length; i += 1) {\n      const a = rgbToYuv(DrawingManager.getColor(colors[i]));\n      console.log('----');\n      console.log(Math.abs(a[0] - b[0]));\n      // console.log(Math.abs(a[1] - b[1]));\n      // console.log(Math.abs(a[2] - b[2]));\n      console.log(dist.distance.euclidean([a[1], a[2]], [b[1], b[2]]));\n      console.log(dist.distance.euclidean(DrawingManager.getColor(colors[i]), currentColor));\n      // const d = dist.distance.euclidean(DrawingManager.getColor(colors[i]), currentColor);\n      // TODO: \n      if (Math.abs(a[0] - b[0]) > 100 || dist.distance.euclidean([a[1], a[2]], [b[1], b[2]]) > 40) {\n        continue;\n      }\n      simIndexes.push(i);\n    }\n\n    let target;\n    /* if (sameIndexes.length > 0 && overlapping.comp.length === sameIndexes.length) {\n      console.log('');\n      return;\n    } else */if ((overlapping.spilled.length > 0 || overlapping.comp.length > 0) && simIndexes.length > 0 && simIndexes.length !== sameIndexes.length) {\n      //   \n      if (overlapping.comp.length > 0) {\n        let targetIdx = 0;\n        let minTarget = 10000;\n        for (let i = 0; i < overlapping.comp.length; i += 1) {\n          const d = dist.distance.euclidean(DrawingManager.getColor(DrawingManager.getColorString(overlapping.comp[i])), currentColor);\n          if (d < minTarget) {\n            targetIdx = i;\n            minTarget = d;\n          }\n        }\n        target = this.objects[overlapping.comp[targetIdx]];\n        let changed = false;\n        for (let i = 0; i < overlapping.spilled.length; i += 1) {\n          const d = dist.distance.euclidean(DrawingManager.getColor(DrawingManager.getColorString(overlapping.spilled[i])), currentColor);\n          if (d < minTarget) {\n            targetIdx = i;\n            minTarget = d;\n            changed = true;\n          }\n        }\n        if (changed) {\n          target = this.objects[overlapping.spilled[targetIdx]];\n        }\n        // for (let i = 1; i < simIndexes.length; i += 1) {\n        //   const sim = overlapping.comp[simIndexes[i]];\n        //   target.drawObject(this.objects[sim]);\n        //   delete this.objects[sim];\n        //   this.objectIndexes.splice(this.objectIndexes.indexOf(sim), 1);\n        // }\n        // \n        target.drawOverlapObject(obj);\n        this.lastKey = overlapping.comp[simIndexes[0]];\n      } else {\n        let targetIdx = 0;\n        let minTarget = 10000;\n        for (let i = 0; i < overlapping.spilled.length; i += 1) {\n          const d = dist.distance.euclidean(DrawingManager.getColor(DrawingManager.getColorString(overlapping.spilled[i])), currentColor);\n          console.log(d);\n          if (d < minTarget) {\n            console.log('min!!!');\n            targetIdx = i;\n            minTarget = d;\n          }\n        }\n        target = this.objects[overlapping.spilled[targetIdx]];\n        // for (let i = 1; i < simIndexes.length; i += 1) {\n        //   const sim = overlapping.spilled[simIndexes[i]];\n        //   target.drawObject(this.objects[sim]);\n        //   delete this.objects[sim];\n        //   this.objectIndexes.splice(this.objectIndexes.indexOf(sim), 1);\n        // }\n        // \n        target.drawOverlapObject(obj);\n        this.lastKey = overlapping.spilled[simIndexes[0]];\n      }\n    } else if ((overlapping.comp.length > 0 || overlapping.spilled.length > 0) && sameIndexes.length > 0) {\n      //   \n      if (overlapping.comp.length > 0) {\n        // target = this.objects[overlapping.comp[sameIndexes[0]]];\n        // for (let i = 1; i < sameIndexes.length; i += 1) {\n        //   const sim = overlapping.comp[sameIndexes[i]];\n        //   target.drawObjectComp(this.objects[sim]);\n        //   delete this.objects[sim];\n        //   this.objectIndexes.splice(this.objectIndexes.indexOf(sim), 1);\n        // }\n        for (let i = 0; i < overlapping.comp.length; i += 1) {\n          const sim = overlapping.comp[i];\n          if (DrawingManager.getColorString(sim) !== currentColorString) {\n            continue;\n          }\n          if (!target) {\n            target = this.objects[overlapping.comp[i]];\n            continue;\n          }\n          target.drawObjectComp(this.objects[sim]);\n          delete this.objects[sim];\n          this.objectIndexes.splice(this.objectIndexes.indexOf(sim), 1);\n        }\n        // TODO: \n        if (!target) {\n          for (let i = 0; i < overlapping.spilled.length; i += 1) {\n            const sim = overlapping.spilled[i];\n            if (DrawingManager.getColorString(sim) !== currentColorString) {\n              continue;\n            }\n            if (!target) {\n              target = this.objects[overlapping.spilled[i]];\n              continue;\n            }\n            target.drawObjectComp(this.objects[sim]);\n            delete this.objects[sim];\n            this.objectIndexes.splice(this.objectIndexes.indexOf(sim), 1);\n          }\n        }\n        target.drawObject(obj);\n        this.lastKey = overlapping.comp[sameIndexes[0]];\n      } else {\n        for (let i = 0; i < overlapping.spilled.length; i += 1) {\n          const sim = overlapping.spilled[i];\n          if (DrawingManager.getColorString(sim) !== currentColorString) {\n            continue;\n          }\n          if (!target) {\n            target = this.objects[overlapping.spilled[i]];\n            continue;\n          }\n          target.drawObjectComp(this.objects[sim]);\n          delete this.objects[sim];\n          this.objectIndexes.splice(this.objectIndexes.indexOf(sim), 1);\n        }\n        // for (let i = 1; i < sameIndexes.length; i += 1) {\n        //   const sim = overlapping.spilled[sameIndexes[i]];\n        //   target.drawObjectComp(this.objects[sim]);\n        //   delete this.objects[sim];\n        //   this.objectIndexes.splice(this.objectIndexes.indexOf(sim), 1);\n        // }\n        target.drawObject(obj);\n        this.lastKey = overlapping.spilled[sameIndexes[0]];\n      }\n    } else {\n      const canvas = document.createElement('canvas');\n      target = new Drawing(color, tool.toString(), canvas, this.styleWidth, this.styleHeight, this.showPen, this.showBase, this.showExtra);\n      target.drawObject(obj);\n      this.objectIndexes.push(key);\n      this.objects[key] = target;\n      this.lastKey = key;\n      if (this.clearedKey && DrawingManager.getToolString(this.clearedKey) === 'Symbol(BRUSH)' && this.objects[this.clearedKey]) {\n        target.history = Object.assign({}, this.objects[this.clearedKey]);\n      }\n      this.clearedKey = null;\n    }\n  }\n\n  erase(obj, color, tool, editRange, key) {\n    if (!key) {\n      return;\n    }\n    if (key.indexOf('_overlap') === -1) {\n      const target = this.objects[key];\n      target.eraseObject(obj);\n      this.lastKey = key;\n    } else {\n      const k = key.split('_overlap')[0];\n      const target = this.objects[k];\n      target.eraseOverlapObject(obj);\n      this.lastKey = k;\n    }\n\n    this.update();\n    this.updateSort();\n  }\n\n  update(editRange) {\n    this.layers = [];\n    this.fixedObject.clear(editRange);\n    for (const key of this.objectIndexes) {\n      const tool = DrawingManager.getToolString(key);\n      let target = this.objects[key];\n      const histories = [];\n      while (target.history) {\n        histories.push(target.history.url);\n        target = target.history;\n      }\n      this.layers.push({\n        url: this.objects[key].imageUrl,\n        histories,\n      });\n      if ((tool === 'Symbol(PEN)' && this.showPen)\n        || (tool === 'Symbol(BRUSH)' && (this.showBase || this.showExtra))) {\n        this.fixedObject.drawObject(this.objects[key], editRange);\n      }\n    }\n    this.layers = this.layers.reverse();\n  }\n\n  updateSort() {\n    const c1 = document.createElement('canvas');\n    c1.style.width = this.styleWidth;\n    c1.style.height = this.styleHeight;\n    const d1 = new Drawing(null, null, c1, this.styleWidth / SORT_DIV, this.styleHeight / SORT_DIV);\n    const ctx1 = d1.canvas.getContext('2d');\n\n    const c2 = document.createElement('canvas');\n    c2.style.width = this.styleWidth;\n    c2.style.height = this.styleHeight;\n    const d2 = new Drawing(null, null, c2, this.styleWidth / SORT_DIV, this.styleHeight / SORT_DIV);\n    const ctx2 = d2.canvas.getContext('2d');\n\n    this.objectIndexes.sort((key1, key2) => {\n      const o1 = this.objects[key1];\n      const o2 = this.objects[key2];\n      const tool1 = key1.split(',')[0];\n      const tool2 = key2.split(',')[0];\n      if (tool1 !== tool2) {\n        return tool1 === 'Symbol(PEN)' ? 1 : -1;\n      }\n\n      const cacheKey = `${key1}-${key2}`;\n      let cache = this.sortCache[cacheKey];\n      if (cache && key1 !== this.lastKey && key2 !== this.lastKey) {\n        return cache;\n      }\n\n      const oc1 = o1.canvas;\n      const oc2 = o2.canvas;\n\n      ctx1.globalCompositeOperation = 'source-over';\n      ctx1.drawImage(oc1, 0, 0, this.styleWidth / SORT_DIV, this.styleHeight / SORT_DIV);\n      ctx1.globalCompositeOperation = 'source-in';\n      ctx1.fillStyle = '#f00';\n      ctx1.fillRect(0, 0, this.styleWidth / SORT_DIV, this.styleHeight / SORT_DIV);\n\n      ctx2.globalCompositeOperation = 'source-over';\n      ctx2.drawImage(oc2, 0, 0, this.styleWidth / SORT_DIV, this.styleHeight / SORT_DIV);\n      ctx2.globalCompositeOperation = 'source-in';\n      ctx2.fillStyle = '#00f';\n      ctx2.fillRect(0, 0, this.styleWidth / SORT_DIV, this.styleHeight / SORT_DIV);\n\n      ctx2.globalCompositeOperation = 'xor';\n      ctx2.drawImage(c1, 0, 0, this.styleWidth / SORT_DIV, this.styleHeight / SORT_DIV);\n\n      const imgdata = ctx2.getImageData(0, 0, d2.canvas.width, d2.canvas.height).data;\n\n      const [a, b] = DrawingManager.measureArea(\n        imgdata,\n        d2.canvas.width,\n        d2.canvas.height,\n        [[255, 0, 0], [0, 0, 255]]\n      );\n\n      d1.clear();\n      d2.clear();\n\n      cache = a > b ? -1 : 1;\n      this.sortCache[cacheKey] = cache;\n      return cache;\n    });\n  }\n\n  checkOverlap(obj, editRange) {\n    const result = {\n      comp: [],\n      spilled: [],\n    };\n\n    if (!this.showBase) {\n      return result;\n    }\n\n    const c1 = document.createElement('canvas');\n    c1.style.width = this.styleWidth;\n    c1.style.height = this.styleHeight;\n    const d1 = new Drawing(null, null, c1, this.styleWidth / SORT_DIV, this.styleHeight / SORT_DIV, false, true, false);\n    const ctx1 = d1.canvas.getContext('2d');\n\n    ctx1.globalCompositeOperation = 'source-over';\n    ctx1.drawImage(obj.canvas, 0, 0, this.styleWidth / SORT_DIV, this.styleHeight / SORT_DIV);\n    ctx1.globalCompositeOperation = 'source-in';\n    ctx1.fillStyle = '#f00';\n    ctx1.fillRect(0, 0, this.styleWidth / SORT_DIV, this.styleHeight / SORT_DIV);\n\n    const c2 = document.createElement('canvas');\n    c2.style.width = this.styleWidth;\n    c2.style.height = this.styleHeight;\n    const d2 = new Drawing(null, null, c2, this.styleWidth / SORT_DIV, this.styleHeight / SORT_DIV, false, true, false);\n    const ctx2 = d2.canvas.getContext('2d');\n\n    for (let i = 0; i < this.objectIndexes.length; i += 1) {\n      const key = this.objectIndexes[i];\n      if (DrawingManager.getToolString(key) === 'Symbol(PEN)') {\n        continue;\n      }\n      const target = this.objects[this.objectIndexes[i]];\n\n      ctx2.globalCompositeOperation = 'source-over';\n      ctx2.drawImage(target.canvas, 0, 0, this.styleWidth / SORT_DIV, this.styleHeight / SORT_DIV);\n      ctx2.globalCompositeOperation = 'source-in';\n      ctx2.fillStyle = '#00f';\n      ctx2.fillRect(0, 0, this.styleWidth / SORT_DIV, this.styleHeight / SORT_DIV);\n\n      ctx2.globalCompositeOperation = 'difference';\n      ctx2.drawImage(c1, 0, 0, this.styleWidth / SORT_DIV, this.styleHeight / SORT_DIV);\n\n      const imgdata = ctx2.getImageData(0, 0, d2.canvas.width, d2.canvas.height).data;\n\n      const [a, b, c] = DrawingManager.measureArea(\n        imgdata,\n        d2.canvas.width,\n        d2.canvas.height,\n        [[255, 0, 0], [255, 0, 255], [0, 0, 255]],\n        editRange\n      );\n\n      d2.clear();\n\n      if (a !== 0 && b !== 0 && c !== 0) {\n        result.spilled.push(key);\n      } else if ((a === 0 || c === 0) && b !== 0) {\n        result.comp.push(key);\n      }\n    }\n    return result;\n  }\n\n  spoit(point) {\n    const imgdata = this.fixedObject.canvas.getContext('2d').getImageData(0, 0, this.fixedObject.canvas.width, this.fixedObject.canvas.height).data;\n    return DrawingManager.spoitColor(imgdata, point, this.fixedObject.canvas.width);\n  }\n\n  getTopKey(points) {\n    for (let i = this.objectIndexes.length - 1; i >= 0; i -= 1) {\n      const key = this.objectIndexes[i];\n      const target = this.objects[key];\n      const overlap = target.overlap.getContext('2d').getImageData(0, 0, target.overlap.width, target.overlap.height).data;\n      if (this.showExtra && DrawingManager.filledColor(overlap, points, target.overlap.width)) {\n        return `${key}_overlap`;\n      }\n      const shape = target.shape.getContext('2d').getImageData(0, 0, target.shape.width, target.shape.height).data;\n      const v = !target.tool || (target.tool === 'Symbol(PEN)' && target.showPen) || (target.tool === 'Symbol(BRUSH)' && target.showBase);\n      if (v && DrawingManager.filledColor(shape, points, target.shape.width)) {\n        return key;\n      }\n    }\n    return undefined;\n  }\n\n  // clear(index) {\n  // }\n\n  clearAll() {\n    this.objects = [];\n    this.histories = [];\n    this.layers = [];\n  }\n\n  undo() {\n    this.objects = this.histories[this.histories.length - 1];\n  }\n\n  rollback(layerIdx, historyIdx) {\n    const length = this.objectIndexes.length;\n    const key = this.objectIndexes[length - layerIdx - 1];\n    const canvas = document.createElement('canvas');\n    const target = new Drawing(null, DrawingManager.getToolString(key), canvas, this.styleWidth, this.styleHeight);\n    let history = this.objects[key].history;\n    for (let i = 0; i < historyIdx; i += 1) {\n      history = history.history;\n    }\n    target.drawObjectComp(history);\n    target.history = Object.assign({}, this.objects[key]);\n    this.objects[key] = target;\n    this.update();\n  }\n\n  changeVisual(pen, base, extra) {\n    this.showPen = pen;\n    this.showBase = base;\n    this.showExtra = extra;\n    for (let i = 0; i < this.objectIndexes.length; i += 1) {\n      this.objects[this.objectIndexes[i]].changeVisual(pen, base, extra);\n    }\n    this.update();\n  }\n}\n\nexport default DrawingManager;\n\n\n\n// WEBPACK FOOTER //\n// ./src/libs/DrawingManager.js","<template>\n  <div id=\"app\">\n    <ui-canvas\n      :current-color='currentColor'\n      :current-tool='currentTool'\n      :prev-tool='prevTool'\n      :tool-sizes='toolSizes'\n      :drawing-manager='drawingManager'\n      @ontune='ontune'\n      @onextractcolor='onextractcolor'\n    ></ui-canvas>\n    <div class='palette' v-show='showPalette'>\n      <sketch id='color-picker' v-model='currentColor' @change-color='onchange' ref='colorPicker'></sketch>\n      <ui-slider :defaultValue='defaultSize' @change-value='onchangesize' ref='slider'></ui-slider>\n    </div>\n    <div id='layer-box'>\n      <ui-layer-list v-if='drawingManager' class='layer-list'\n        :layers='drawingManager.layers' @onclear='onclear' @rollback='rollback'>\n      </ui-layer-list>\n      <div id='show-layer-box'>\n        <md-switch v-model='showPen' @change='onchangevisiual'></md-switch>\n        <md-switch v-model='showBase' @change='onchangevisiual'></md-switch>\n        <md-switch v-model='showExtra' @change='onchangevisiual'></md-switch>\n      </div>\n    </div>\n    <div id='canvas-box'>\n      <md-button class='md-fab' @click='newcanvas'>\n        <md-icon>note_add</md-icon>\n      </md-button>\n      <md-button class='md-fab md-mini' @click='togglepalette'>\n        <md-icon>palette</md-icon>\n      </md-button>\n      <!-- <md-button class='md-fab md-mini'>\n        <md-icon>undo</md-icon>\n      </md-button> -->\n    </div>\n    <div id='tool-box'>\n      <md-button-toggle md-single class=\"md-accent\" ref='toolButtons'>\n        <md-button class=\"md-icon-button md-toggle\" @click='toggletool(\"pen\")' ref='penButton'>\n          <md-icon>edit</md-icon>\n        </md-button>\n\n        <md-button class=\"md-icon-button\"  @click='toggletool(\"brush\")' ref='brushButton'>\n          <md-icon>brush</md-icon>\n        </md-button>\n\n        <md-button class=\"md-icon-button\"  @click='toggletool(\"eraser\")'>\n          <md-icon>call_to_action</md-icon>\n        </md-button>\n\n        <md-button class=\"md-icon-button\"  @click='toggletool(\"spoit\")'>\n          <md-icon>colorize</md-icon>\n        </md-button>\n\n        <md-button class=\"md-icon-button\"  @click='toggletool(\"color\")'>\n          <md-icon>tune</md-icon>\n        </md-button>\n      </md-button-toggle>\n    </div>\n    <md-dialog id='color-dialog' ref=\"colorDialog\">\n      <md-dialog-title></md-dialog-title>\n\n      <md-dialog-content>\n        \n        <ui-slider :defaultValue='50' @change-value='onchangehue' ref='hueSlider'></ui-slider>\n        \n        <ui-slider :defaultValue='50' @change-value='onchangesat' ref='satSlider'></ui-slider>\n        \n        <ui-slider :defaultValue='50' @change-value='onchangeval' ref='valSlider'></ui-slider>\n      </md-dialog-content>\n\n      <md-dialog-actions>\n        <md-button class=\"md-primary\" @click=\"closeColorDialog\"></md-button>\n        <md-button class=\"md-primary\" @click=\"applyColorDialog\"></md-button>\n      </md-dialog-actions>\n    </md-dialog>\n  </div>\n</template>\n\n<script>\nimport { Sketch } from 'vue-color';\nimport Vue from 'vue';\nimport Color from 'color';\nimport VueMaterial from 'vue-material';\nimport 'vue-material/dist/vue-material.css';\nimport UiCanvas from './components/UiCanvas';\nimport UiSlider from './components/UiSlider';\nimport UiLayerList from './components/UiLayerList';\nimport DrawingManager from './libs/DrawingManager';\nimport tools from './libs/Tools';\n\nVue.use(VueMaterial);\n\nconst currentColor = {\n  hex: '#4A4A4A',\n  rgba: {\n    r: 74,\n    g: 74,\n    b: 74,\n    a: 1,\n  },\n  a: 1,\n};\n\nconst currentTool = tools.PEN;\nconst prevTool = currentTool;\nconst toolSizes = {};\ntoolSizes[tools.PEN] = 4;\ntoolSizes[tools.BRUSH] = 30;\ntoolSizes[tools.ERASER] = 30;\n\nexport default {\n  name: 'app',\n  components: {\n    Sketch,\n    UiCanvas,\n    UiLayerList,\n    UiSlider,\n  },\n  data() {\n    return {\n      currentColor,\n      currentTool,\n      prevTool,\n      toolSizes,\n      drawingManager: undefined,\n      defaultSize: 4,\n      tuneTargetKey: undefined,\n      tuneTarget: undefined,\n      tuneInfo: undefined,\n      tuneShape: undefined,\n      tuneOverlap: undefined,\n      showPen: true,\n      showBase: true,\n      showExtra: true,\n      showPalette: true,\n    };\n  },\n  mounted() {\n    window.devicePixelRatio = 1.0;\n    this.drawingManager = new DrawingManager(document.querySelector('#fixed-canvas'));\n\n    let count = 0;\n    let startTime = 0;\n    const counter = () => {\n      count += 1;\n      if (new Date().getTime() - startTime > 1000) {\n        document.title = `(FPS: ${count})`;\n        count = 0;\n        startTime = new window.Date().getTime();\n      }\n      window.requestAnimationFrame(counter);\n    };\n    window.requestAnimationFrame(counter);\n  },\n  methods: {\n    onchange(color) {\n      this.currentColor = color;\n    },\n    toggletool(tool) {\n      this.prevTool = this.currentTool;\n      this.currentTool = tools.fromName(tool);\n      this.$refs.slider.setValue(this.toolSizes[this.currentTool], true, false);\n    },\n    onchangesize(size) {\n      this.toolSizes[this.currentTool] = size;\n    },\n    onextractcolor(color) {\n      this.$refs.colorPicker.colorChange({\n        hex: Color.rgb(color).hex(),\n        rgba: {\n          r: color[0],\n          g: color[1],\n          b: color[2],\n          a: 1,\n        },\n        a: 1,\n      });\n    },\n    newcanvas() {\n      this.drawingManager = new DrawingManager(document.querySelector('#fixed-canvas'));\n      this.currentColor = currentColor;\n      this.currentTool = currentTool;\n      this.$refs.slider.setValue(this.defaultSize, true, false);\n      Array.from(this.$refs.toolButtons.$el.children).map(x => x.classList.remove('md-toggle'));\n      // this.$refs.brushButton.$el.classList.add('md-toggle');\n      this.$refs.penButton.$el.classList.add('md-toggle');\n      this.showPen = true;\n      this.showBase = true;\n      this.showExtra = true;\n      this.showPalette = true;\n    },\n    onclear(index) {\n      if (this.drawingManager) {\n        const length = this.drawingManager.objectIndexes.length;\n        const clearedKey = this.drawingManager.objectIndexes.splice(length - index - 1, 1)[0];\n        this.drawingManager.clearedKey = clearedKey;\n        this.drawingManager.update();\n      }\n    },\n    rollback(layerIdx, historyIdx) {\n      this.drawingManager.rollback(layerIdx, historyIdx);\n    },\n    openColorDialog() {\n      this.$refs.hueSlider.setValue(50, true, false);\n      this.$refs.satSlider.setValue(50, true, false);\n      this.$refs.valSlider.setValue(50, true, false);\n      this.$refs.colorDialog.open();\n    },\n    closeColorDialog() {\n      const shape = new Uint8ClampedArray(this.tuneShape.data);\n      shape.set(this.tuneShape);\n      const ps = new window.ImageData(\n        shape,\n        this.tuneTarget.shape.width, this.tuneTarget.shape.height\n      );\n      this.tuneTarget.shape.getContext('2d').putImageData(ps, 0, 0);\n      const overlap = new Uint8ClampedArray(this.tuneOverlap.data);\n      overlap.set(this.tuneOverlap);\n      const po = new window.ImageData(\n        overlap,\n        this.tuneTarget.overlap.width, this.tuneTarget.overlap.height\n      );\n      this.tuneTarget.overlap.getContext('2d').putImageData(po, 0, 0);\n      this.tuneTarget.url = null;\n      this.tuneTarget.updateCanvas();\n      this.drawingManager.update();\n      this.$refs.colorDialog.close();\n    },\n    applyColorDialog() {\n      const targetTool = DrawingManager.getToolString(this.tuneTargetKey);\n      const targetColor =\n        DrawingManager.getColor(DrawingManager.getColorString(this.tuneTargetKey));\n      let newColor = Color.rgb(targetColor)\n        .rotate(this.tuneInfo.hue)\n        .saturate(this.tuneInfo.sat)\n        .lighten(this.tuneInfo.val)\n        .rgb()\n        .array();\n      newColor = newColor.map(x => Math.floor(x));\n      const newKey = DrawingManager.getKey(\n        targetTool,\n        Math.floor(newColor[0]),\n        Math.floor(newColor[1]),\n        Math.floor(newColor[2])\n      );\n      const idx = this.drawingManager.objectIndexes.indexOf(this.tuneTargetKey);\n      if (idx === -1) {\n        return;\n      }\n      this.drawingManager.objectIndexes[idx] = newKey;\n      this.drawingManager.objects[newKey] = this.tuneTarget;\n      delete this.drawingManager.objects[this.tuneTargetKey];\n      this.drawingManager.update();\n      this.$refs.colorDialog.close();\n    },\n    ontune(targetKey) {\n      this.tuneTargetKey = targetKey;\n      this.tuneTarget = this.drawingManager.objects[targetKey];\n      this.tuneInfo = {\n        hue: 0.0,\n        sat: 0.0,\n        val: 0.0,\n      };\n      this.tuneShape = this.tuneTarget.shape.getContext('2d').getImageData(0, 0, this.tuneTarget.shape.width, this.tuneTarget.shape.height);\n      this.tuneOverlap = this.tuneTarget.overlap.getContext('2d').getImageData(0, 0, this.tuneTarget.overlap.width, this.tuneTarget.overlap.height);\n      this.openColorDialog();\n    },\n    onchangehue(hue) {\n      /* eslint-disable no-mixed-operators */\n      this.tuneInfo.hue = (hue - 50) / 100 * 360;\n      this.colorTune();\n    },\n    onchangesat(sat) {\n      this.tuneInfo.sat = (sat - 50) / 100;\n      this.colorTune();\n    },\n    onchangeval(val) {\n      this.tuneInfo.val = (val - 50) / 100;\n      this.colorTune();\n    },\n    colorTune() {\n      this.tuneTarget.colorTune(this.tuneShape, this.tuneOverlap, this.tuneInfo);\n      this.drawingManager.update();\n    },\n    onchangevisiual() {\n      this.drawingManager.changeVisual(this.showPen, this.showBase, this.showExtra);\n    },\n    togglepalette() {\n      this.showPalette = !this.showPalette;\n    },\n  },\n};\n</script>\n\n<style>\nbody\n{\n  display: flex;\n\n  margin: 0;\n  user-select: none;\n}\n\n#app\n{\n  width: 100%;\n  height: 100vh;\n}\n\n.palette\n{\n  position: absolute;\n  left: 20px;\n  top: 20px;\n\n  width: fit-content;\n\n  border-radius: 4px;\n  background: #fff;\n  box-shadow: 0 0 0 1px rgba(0,0,0,.15),0 8px 16px rgba(0,0,0,.15);\n}\n\n.palette>.ui-slider\n{\n  margin-left: 10px;\n  margin-right: 10px;\n  width: auto;\n}\n\n#color-picker\n{\n  box-shadow: none;\n}\n\n#layer-box\n{\n  position: absolute;\n  right: 0px;\n  top: 0px;\n\n  display: flex;\n  flex-direction: column;\n\n  width: 220px;\n  height: 100%;\n\n  background: #eee;\n  box-shadow: 0 0 4px rgba(0,0,0,.15) inset;\n}\n\n.layer-list\n{\n  width: 220px;\n  height: auto;\n\n  overflow-y: scroll;\n  overflow-x: hidden;\n\n  flex: 1 1 auto;\n}\n\n#show-layer-box\n{\n  margin: 8px;\n\n  height: fit-content;\n\n  flex-basis: fit-content;\n}\n\n#canvas-box\n{\n  position: absolute;\n  bottom: 10px;\n  left: 20px;\n\n  width: fit-content;\n  padding: 4px;\n\n  display: flex;\n  align-items: flex-end;\n}\n\n#tool-box\n{\n  position: absolute;\n  right: 0;\n  bottom: 10px;\n  left: 0;\n\n  width: fit-content;\n  margin: 0 auto;\n  /*padding: 4px;*/\n\n  border-radius: 4px;\n  background: rgba(255, 255, 255, .8);\n  box-shadow: 0 0 0 1px rgba(0,0,0,.15),0 8px 16px rgba(0,0,0,.15);\n}\n\n#color-dialog>.md-dialog\n{\n  position: absolute;\n  right: 20px;\n  min-width: 220px;\n  width: 220px;\n}\n\n.md-backdrop.md-dialog-backdrop.md-active\n{\n  background: none;\n}\n\n</style>\n\n\n\n// WEBPACK FOOTER //\n// App.vue?356050f4","<template>\n  <div id='ui-canvas'>\n    <canvas id='fixed-canvas'></canvas>\n    <canvas id='drawing'\n      @mousedown='mousedown'\n      @touchstart='mousedown'\n      @mousemove='mousemove'\n      @touchmove='mousemove'\n      @mouseup='mouseup'\n      @touchend='mouseup'\n      @mouseleave='mouseup'\n      ref='drawing'\n    ></canvas>\n  </div>\n</template>\n\n<script>\n\nimport Drawing from '../libs/Drawing';\nimport tools from '../libs/Tools';\n\nconst getMousePos = (event) => {\n  const rect = event.target.getBoundingClientRect();\n  const clientX = event.clientX || event.touches[0].clientX;\n  const clientY = event.clientY || event.touches[0].clientY;\n  return [clientX - rect.left, clientY - rect.top];\n};\n\nexport default {\n  name: 'UiCanvas',\n  props: [\n    'current-color',\n    'current-tool',\n    'prev-tool',\n    'tool-sizes',\n    'drawing-manager',\n  ],\n  data() {\n    return {\n      currentStroke: [],\n      drawing: null,\n      editRange: { lx: 0, ly: 0, rx: 0, ry: 0 },\n      eraseTarget: undefined,\n    };\n  },\n  mounted() {\n    this.$refs.drawing.addEventListener('dragover', this.dragover, false);\n    this.$refs.drawing.addEventListener('drop', this.drop, false);\n  },\n  methods: {\n    mousedown(event) {\n      event.preventDefault();\n      const [mousex, mousey] = getMousePos(event);\n      let firstTarget;\n      let color;\n      switch (this.currentTool) {\n        case tools.PEN:\n        case tools.BRUSH:\n        case tools.ERASER:\n          this.drawing = new Drawing(this.currentColor, null, document.querySelector('#drawing'));\n          break;\n        case tools.SPOIT:\n          color = this.drawingManager.spoit([[\n            mousex * window.devicePixelRatio,\n            mousey * window.devicePixelRatio,\n          ]]);\n          if (color) {\n            this.$emit('onextractcolor', color);\n          }\n          return;\n        case tools.FILL:\n          return;\n        case tools.COLOR:\n          firstTarget = this.drawingManager.getTopKey([[\n            mousex * window.devicePixelRatio,\n            mousey * window.devicePixelRatio,\n          ]]);\n          if (firstTarget) {\n            this.$emit('ontune', firstTarget.split('_overlap')[0]);\n          }\n          return;\n        default:\n          return;\n      }\n      const size = this.toolSizes[this.currentTool];\n      this.currentStroke.push([mousex, mousey]);\n      this.drawing.draw(\n        this.currentStroke,\n        this.currentColor,\n        this.currentTool,\n        size\n      );\n      //  size / 2 \n      this.editRange.lx = mousex - size;\n      this.editRange.ly = mousey - size;\n      this.editRange.rx = mousex + size;\n      this.editRange.ry = mousey + size;\n\n      this.updateerasertarget(mousex * window.devicePixelRatio, mousey * window.devicePixelRatio);\n    },\n    mousemove(event) {\n      event.preventDefault();\n      if (!this.drawing) {\n        return;\n      }\n      const [pmousex, pmousey] = this.currentStroke[this.currentStroke.length - 1];\n      const [mousex, mousey] = getMousePos(event);\n      if (mousex === pmousex && mousey === pmousey) {\n        return;\n      }\n      const size = this.toolSizes[this.currentTool];\n      this.currentStroke.push([mousex, mousey]);\n      this.drawing.clear(this.editRange);\n      this.drawing.draw(\n        this.currentStroke,\n        this.currentColor,\n        this.currentTool,\n        size\n      );\n      //  size / 2 \n      this.editRange.lx = Math.min(mousex - size, this.editRange.lx);\n      this.editRange.ly = Math.min(mousey - size, this.editRange.ly);\n      this.editRange.rx = Math.max(mousex + size, this.editRange.rx);\n      this.editRange.ry = Math.max(mousey + size, this.editRange.ry);\n\n      this.updateerasertarget(mousex * window.devicePixelRatio, mousey * window.devicePixelRatio);\n    },\n    mouseup(event) {\n      event.preventDefault();\n      if (!this.drawing) {\n        return;\n      }\n      switch (this.currentTool) {\n        case tools.PEN:\n        case tools.BRUSH:\n          this.drawingManager.draw(\n            this.drawing,\n            this.currentColor,\n            this.currentTool,\n            this.editRange,\n          );\n          break;\n        case tools.ERASER:\n          this.drawingManager.erase(\n            this.drawing,\n            this.currentColor,\n            this.currentTool,\n            this.editRange,\n            this.eraseTarget,\n          );\n          break;\n        case tools.SPOIT:\n          return;\n        case tools.FILL:\n          return;\n        default:\n          return;\n      }\n      this.drawing.clear(this.editRange);\n      this.drawing = null;\n      this.currentStroke = [];\n      this.editRange = { lx: 0, ly: 0, rx: 0, ry: 0 };\n      this.eraseTarget = undefined;\n      this.$parent.$emit('update-layer-list');\n    },\n    updateerasertarget(mousex, mousey) {\n      const size = this.toolSizes[this.currentTool];\n      if (this.currentTool === tools.ERASER && !this.eraseTarget) {\n        const points = [];\n        points.push([mousex, mousey]);\n        for (let i = 0; i < 16; i += 1) {\n          /* eslint-disable no-mixed-operators */\n          points.push([\n            mousex + 0.5 * size * Math.cos(2 * Math.PI / 16 * i),\n            mousey + 0.5 * size * Math.sin(2 * Math.PI / 16 * i),\n          ]);\n        }\n        const target = this.drawingManager.getTopKey(points);\n        if (target) {\n          this.eraseTarget = target;\n        }\n      }\n    },\n    dragover(event) {\n      event.preventDefault();\n    },\n    drop(event) {\n      event.preventDefault();\n      const file = event.dataTransfer.files[0];\n      if (file.type !== 'image/png' && file.type !== 'image/jpeg') {\n        return;\n      }\n\n      const reader = new FileReader();\n      reader.onload = () => {\n        const image = document.createElement('img');\n        image.setAttribute('src', reader.result);\n        this.drawing = new Drawing(this.currentColor, null, document.querySelector('#drawing'));\n        this.drawing.drawObject({ canvas: image });\n        this.drawingManager.draw(\n          this.drawing,\n          this.currentColor,\n          this.currentTool,\n          this.editRange,\n        );\n      };\n      reader.readAsDataURL(file);\n    },\n  },\n};\n\n</script>\n\n<style>\n#ui-canvas\n{\n  width: 100%;\n  height: 100vh;\n}\n\ncanvas\n{\n  position: absolute;\n  top: 0;\n  left: 0;\n\n  width: 100%;\n  height: 100vh;\n}\n\ncanvas:not(.md-image) {\n  height: 100vh;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// UiCanvas.vue?78dbeaf4","<template>\n  <div id='ui-layer-list'>\n    <ul v-if='layers'>\n      <li v-for='(layer, i) in layers' @mouseover='mouseover(i)' @mouseleave='mouseleave(i)'>\n        <md-button @click='clear(i)'>\n          <md-icon>clear</md-icon>\n        </md-button>\n        <img :src='layer.url'></img>\n        <ul v-if='layer.histories && active === i'>\n          <li style='display: inline;' v-for='(history, j) in layer.histories'>\n            <img :src='history' @click='rollback(i, j)'></img>\n          </li>\n        </ul>\n      </li>\n    </ul>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'UiLayerList',\n  props: [\n    'layers',\n  ],\n  data() {\n    return {\n      active: -1,\n    };\n  },\n  methods: {\n    clear(index) {\n      this.$emit('onclear', index);\n    },\n    mouseover(index) {\n      this.active = index;\n    },\n    mouseleave(index) {\n      if (index === this.active) {\n        this.active = -1;\n      }\n    },\n    rollback(layerIdx, historyIdx) {\n      this.$emit('rollback', layerIdx, historyIdx);\n    },\n  },\n};\n</script>\n\n<style>\n#ui-layer-list>ul\n{\n  padding: 0;\n  margin: 0;\n}\n\n#ui-layer-list>ul>li\n{\n  position: relative;\n  list-style-type: none;\n\n  height: fit-content;\n}\n\n#ui-layer-list>ul>li>img\n{\n  width: 100%;\n  height: auto;\n  padding: 0;\n  margin: 0;\n\n  background: rgba(255, 255, 255, 0.8);\n}\n\n#ui-layer-list>ul>li>.md-button\n{\n  position: absolute;\n  top: 4px;\n  right: 4px;\n  min-width: 36px;\n  min-height: 36px;\n}\n\n#ui-layer-list>ul>li>ul\n{\n  padding: 0;\n}\n\n#ui-layer-list>ul>li>ul>li>img\n{\n  width: 50%;\n  height: auto;\n  padding: 0;\n  margin: 0;\n\n  background: rgba(255, 255, 255, 0.4);\n}\n\n#ui-layer-list>ul>li>ul>li>img:hover\n{\n  box-shadow: 0 0 0 1px #e91e63 inset,0 8px 16px rgba(0,0,0,.15);\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// UiLayerList.vue?404ea562","<template>\n  <div\n     class=\"ui-slider\" tabindex=\"0\" ref='slider'\n     :class=\"{ min: value === 0, max: value === 100, dragging: dragging }\"\n     @mousedown=\"sliderClick\" @keydown.left.prevent=\"decrement\" @keydown.right.prevent=\"increment\"\n>\n    <div class=\"ui-slider-containment\" ref='container'></div>\n\n    <div class=\"ui-slider-wrapper\">\n        <div class=\"ui-slider-track-container\">\n            <div class=\"ui-slider-track\"></div>\n            <div class=\"ui-slider-track-fill\" :style=\"{ width: value + '%'}\"></div>\n        </div>\n\n        <div class=\"ui-slider-thumb-container\" ref='thumb'>\n            <div class=\"ui-slider-focus-ring\"></div>\n            <div class=\"ui-slider-thumb\" ref='thumbCircle'></div>\n        </div>\n    </div>\n</div>\n</template>\n\n<script>\nimport Draggabilly from 'draggabilly';\n\nexport default {\n  name: 'UiSlider',\n  props: [\n    'defaultValue',\n  ],\n  data() {\n    return {\n      keyboardStep: 5,\n      value: this.defaultValue,\n      dragging: false,\n      draggable: null,\n    };\n  },\n  mounted() {\n    this.$refs.thumb.style.left = `${this.value}%`;\n\n    this.draggable = new Draggabilly(this.$refs.thumb, {\n      containment: this.$refs.container,\n      axis: 'x',\n    });\n\n    this.draggable.on('dragStart', this.dragStart);\n    this.draggable.on('dragMove', this.dragMove);\n    this.draggable.on('dragEnd', this.dragEnd);\n  },\n  methods: {\n    sliderClick(e) {\n      const sliderPosition = this.$refs.slider.getBoundingClientRect();\n\n      const newValue = ((e.clientX - sliderPosition.left) / sliderPosition.width) * 100;\n\n      this.setValue(newValue, true);\n\n      if (e.target !== this.$refs.thumb) {\n        /* eslint-disable no-underscore-dangle */\n        this.draggable._pointerDown(e, e);\n      }\n\n      this.$refs.slider.focus();\n    },\n\n    dragStart() {\n      this.dragging = true;\n      this.$refs.slider.focus();\n    },\n    dragMove() {\n      const x = this.draggable.position.x;\n      const newValue = (x / this.$refs.slider.getBoundingClientRect().width) * 100;\n\n      this.setValue(newValue);\n    },\n    dragEnd() {\n      this.dragging = false;\n    },\n    increment() {\n      if (this.value === 100) {\n        return;\n      }\n\n      this.setValue(this.value + this.keyboardStep, true);\n    },\n    decrement() {\n      if (this.value === 0) {\n        return;\n      }\n\n      this.setValue(this.value - this.keyboardStep, true);\n    },\n    setValue(newValue, updateThumb, emit = true) {\n      if (newValue === this.value) {\n        return;\n      }\n\n      let moderatedValue = Math.round(newValue);\n\n      if (moderatedValue >= 100) {\n        moderatedValue = 100;\n      }\n\n      if (moderatedValue <= 0) {\n        moderatedValue = 0;\n      }\n\n      this.value = moderatedValue;\n\n      if (updateThumb) {\n        this.$refs.thumb.style.left = `${this.value}%`;\n      }\n      if (emit) {\n        this.$emit('change-value', this.value);\n      }\n    },\n  },\n};\n</script>\n\n<style>\n.ui-slider {\n  position: relative;\n  width: 100%;\n  height: 42px;\n  display: flex;\n  align-items: center;\n  outline: none;\n}\n.ui-slider:hover .ui-slider-thumb {\n  transform: scale(1.1);\n}\n.ui-slider:focus .ui-slider-thumb,\n.ui-slider.dragging .ui-slider-thumb {\n  transform: scale(1.1);\n}\n.ui-slider:focus .ui-slider-focus-ring,\n.ui-slider.dragging .ui-slider-focus-ring {\n  transform: scale(1);\n}\n.ui-slider-wrapper {\n  position: relative;\n  width: 100%;\n}\n.ui-slider-track-container {\n  position: relative;\n}\n.ui-slider-track {\n  height: 3px;\n  background-color: rgba(0,0,0,0.28);\n  width: 100%;\n}\n.ui-slider-track-fill {\n  position: absolute;\n  top: 0;\n  height: 3px;\n  background-color: #e91e63;\n}\n.ui-slider-thumb-container {\n  position: absolute;\n  left: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin-top: -20.5px;\n  margin-left: -20.5px;\n  width: 38px;\n  height: 38px;\n}\n.ui-slider-thumb {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 16px;\n  height: 16px;\n  background-color: #e91e63;\n  border-radius: 50%;\n  transition-property: transform;\n  transition-duration: 0.2s;\n  transition-timing-function: linear;\n  transform: scale(1);\n}\n.ui-slider-focus-ring {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 38px;\n  height: 38px;\n  border-radius: 50%;\n  background-color: rgba(233,30,99,0.38);\n  transition: transform 0.2s ease;\n  transform: scale(0);\n}\n.ui-slider-containment {\n  left: 0;\n  right: 0;\n  position: absolute;\n  margin-left: -20.5px;\n  margin-right: -20.5px;\n}\n.page {\n  max-width: 400px;\n  margin: 24px;\n}\n.page input {\n  margin-top: 40px;\n}\n* {\n  box-sizing: border-box;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// UiSlider.vue?1e15156e","\n/* styles */\nrequire(\"!!../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"extract\\\":true,\\\"remove\\\":true}!vue-style-loader!css-loader?sourceMap!../node_modules/vue-loader/lib/style-rewriter?id=data-v-273a77c8!../node_modules/vue-loader/lib/selector?type=styles&index=0!./App.vue\")\n\nvar Component = require(\"!../node_modules/vue-loader/lib/component-normalizer\")(\n  /* script */\n  require(\"!!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"),\n  /* template */\n  require(\"!!../node_modules/vue-loader/lib/template-compiler?id=data-v-273a77c8!../node_modules/vue-loader/lib/selector?type=template&index=0!./App.vue\"),\n  /* scopeId */\n  null,\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/App.vue\n// module id = 176\n// module chunks = 2","\n/* styles */\nrequire(\"!!../../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"extract\\\":true,\\\"remove\\\":true}!vue-style-loader!css-loader?sourceMap!../../node_modules/vue-loader/lib/style-rewriter?id=data-v-01d34620!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./UiCanvas.vue\")\n\nvar Component = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")(\n  /* script */\n  require(\"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./UiCanvas.vue\"),\n  /* template */\n  require(\"!!../../node_modules/vue-loader/lib/template-compiler?id=data-v-01d34620!../../node_modules/vue-loader/lib/selector?type=template&index=0!./UiCanvas.vue\"),\n  /* scopeId */\n  null,\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/UiCanvas.vue\n// module id = 177\n// module chunks = 2","\n/* styles */\nrequire(\"!!../../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"extract\\\":true,\\\"remove\\\":true}!vue-style-loader!css-loader?sourceMap!../../node_modules/vue-loader/lib/style-rewriter?id=data-v-29c54477!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./UiLayerList.vue\")\n\nvar Component = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")(\n  /* script */\n  require(\"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./UiLayerList.vue\"),\n  /* template */\n  require(\"!!../../node_modules/vue-loader/lib/template-compiler?id=data-v-29c54477!../../node_modules/vue-loader/lib/selector?type=template&index=0!./UiLayerList.vue\"),\n  /* scopeId */\n  null,\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/UiLayerList.vue\n// module id = 178\n// module chunks = 2","\n/* styles */\nrequire(\"!!../../node_modules/extract-text-webpack-plugin/loader.js?{\\\"omit\\\":1,\\\"extract\\\":true,\\\"remove\\\":true}!vue-style-loader!css-loader?sourceMap!../../node_modules/vue-loader/lib/style-rewriter?id=data-v-26eb45ae!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./UiSlider.vue\")\n\nvar Component = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")(\n  /* script */\n  require(\"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./UiSlider.vue\"),\n  /* template */\n  require(\"!!../../node_modules/vue-loader/lib/template-compiler?id=data-v-26eb45ae!../../node_modules/vue-loader/lib/selector?type=template&index=0!./UiSlider.vue\"),\n  /* scopeId */\n  null,\n  /* cssModules */\n  null\n)\n\nmodule.exports = Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/UiSlider.vue\n// module id = 179\n// module chunks = 2","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    attrs: {\n      \"id\": \"ui-canvas\"\n    }\n  }, [_c('canvas', {\n    attrs: {\n      \"id\": \"fixed-canvas\"\n    }\n  }), _vm._v(\" \"), _c('canvas', {\n    ref: \"drawing\",\n    attrs: {\n      \"id\": \"drawing\"\n    },\n    on: {\n      \"mousedown\": _vm.mousedown,\n      \"touchstart\": _vm.mousedown,\n      \"mousemove\": _vm.mousemove,\n      \"touchmove\": _vm.mousemove,\n      \"mouseup\": _vm.mouseup,\n      \"touchend\": _vm.mouseup,\n      \"mouseleave\": _vm.mouseup\n    }\n  })])\n},staticRenderFns: []}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-loader/lib/template-compiler.js?id=data-v-01d34620!./~/vue-loader/lib/selector.js?type=template&index=0!./src/components/UiCanvas.vue\n// module id = 180\n// module chunks = 2","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    ref: \"slider\",\n    staticClass: \"ui-slider\",\n    class: {\n      min: _vm.value === 0, max: _vm.value === 100, dragging: _vm.dragging\n    },\n    attrs: {\n      \"tabindex\": \"0\"\n    },\n    on: {\n      \"mousedown\": _vm.sliderClick,\n      \"keydown\": [function($event) {\n        if (!('button' in $event) && _vm._k($event.keyCode, \"left\", 37, $event.key)) { return null; }\n        if ('button' in $event && $event.button !== 0) { return null; }\n        $event.preventDefault();\n        _vm.decrement($event)\n      }, function($event) {\n        if (!('button' in $event) && _vm._k($event.keyCode, \"right\", 39, $event.key)) { return null; }\n        if ('button' in $event && $event.button !== 2) { return null; }\n        $event.preventDefault();\n        _vm.increment($event)\n      }]\n    }\n  }, [_c('div', {\n    ref: \"container\",\n    staticClass: \"ui-slider-containment\"\n  }), _vm._v(\" \"), _c('div', {\n    staticClass: \"ui-slider-wrapper\"\n  }, [_c('div', {\n    staticClass: \"ui-slider-track-container\"\n  }, [_c('div', {\n    staticClass: \"ui-slider-track\"\n  }), _vm._v(\" \"), _c('div', {\n    staticClass: \"ui-slider-track-fill\",\n    style: ({\n      width: _vm.value + '%'\n    })\n  })]), _vm._v(\" \"), _c('div', {\n    ref: \"thumb\",\n    staticClass: \"ui-slider-thumb-container\"\n  }, [_c('div', {\n    staticClass: \"ui-slider-focus-ring\"\n  }), _vm._v(\" \"), _c('div', {\n    ref: \"thumbCircle\",\n    staticClass: \"ui-slider-thumb\"\n  })])])])\n},staticRenderFns: []}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-loader/lib/template-compiler.js?id=data-v-26eb45ae!./~/vue-loader/lib/selector.js?type=template&index=0!./src/components/UiSlider.vue\n// module id = 181\n// module chunks = 2","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    attrs: {\n      \"id\": \"app\"\n    }\n  }, [_c('ui-canvas', {\n    attrs: {\n      \"current-color\": _vm.currentColor,\n      \"current-tool\": _vm.currentTool,\n      \"prev-tool\": _vm.prevTool,\n      \"tool-sizes\": _vm.toolSizes,\n      \"drawing-manager\": _vm.drawingManager\n    },\n    on: {\n      \"ontune\": _vm.ontune,\n      \"onextractcolor\": _vm.onextractcolor\n    }\n  }), _vm._v(\" \"), _c('div', {\n    directives: [{\n      name: \"show\",\n      rawName: \"v-show\",\n      value: (_vm.showPalette),\n      expression: \"showPalette\"\n    }],\n    staticClass: \"palette\"\n  }, [_c('sketch', {\n    ref: \"colorPicker\",\n    attrs: {\n      \"id\": \"color-picker\"\n    },\n    on: {\n      \"change-color\": _vm.onchange\n    },\n    model: {\n      value: (_vm.currentColor),\n      callback: function($$v) {\n        _vm.currentColor = $$v\n      },\n      expression: \"currentColor\"\n    }\n  }), _vm._v(\" \"), _c('ui-slider', {\n    ref: \"slider\",\n    attrs: {\n      \"defaultValue\": _vm.defaultSize\n    },\n    on: {\n      \"change-value\": _vm.onchangesize\n    }\n  })], 1), _vm._v(\" \"), _c('div', {\n    attrs: {\n      \"id\": \"layer-box\"\n    }\n  }, [(_vm.drawingManager) ? _c('ui-layer-list', {\n    staticClass: \"layer-list\",\n    attrs: {\n      \"layers\": _vm.drawingManager.layers\n    },\n    on: {\n      \"onclear\": _vm.onclear,\n      \"rollback\": _vm.rollback\n    }\n  }) : _vm._e(), _vm._v(\" \"), _c('div', {\n    attrs: {\n      \"id\": \"show-layer-box\"\n    }\n  }, [_c('md-switch', {\n    on: {\n      \"change\": _vm.onchangevisiual\n    },\n    model: {\n      value: (_vm.showPen),\n      callback: function($$v) {\n        _vm.showPen = $$v\n      },\n      expression: \"showPen\"\n    }\n  }, [_vm._v(\"\")]), _vm._v(\" \"), _c('md-switch', {\n    on: {\n      \"change\": _vm.onchangevisiual\n    },\n    model: {\n      value: (_vm.showBase),\n      callback: function($$v) {\n        _vm.showBase = $$v\n      },\n      expression: \"showBase\"\n    }\n  }, [_vm._v(\"\")]), _vm._v(\" \"), _c('md-switch', {\n    on: {\n      \"change\": _vm.onchangevisiual\n    },\n    model: {\n      value: (_vm.showExtra),\n      callback: function($$v) {\n        _vm.showExtra = $$v\n      },\n      expression: \"showExtra\"\n    }\n  }, [_vm._v(\"\")])], 1)], 1), _vm._v(\" \"), _c('div', {\n    attrs: {\n      \"id\": \"canvas-box\"\n    }\n  }, [_c('md-button', {\n    staticClass: \"md-fab\",\n    on: {\n      \"click\": _vm.newcanvas\n    }\n  }, [_c('md-icon', [_vm._v(\"note_add\")])], 1), _vm._v(\" \"), _c('md-button', {\n    staticClass: \"md-fab md-mini\",\n    on: {\n      \"click\": _vm.togglepalette\n    }\n  }, [_c('md-icon', [_vm._v(\"palette\")])], 1)], 1), _vm._v(\" \"), _c('div', {\n    attrs: {\n      \"id\": \"tool-box\"\n    }\n  }, [_c('md-button-toggle', {\n    ref: \"toolButtons\",\n    staticClass: \"md-accent\",\n    attrs: {\n      \"md-single\": \"\"\n    }\n  }, [_c('md-button', {\n    ref: \"penButton\",\n    staticClass: \"md-icon-button md-toggle\",\n    on: {\n      \"click\": function($event) {\n        _vm.toggletool(\"pen\")\n      }\n    }\n  }, [_c('md-icon', [_vm._v(\"edit\")])], 1), _vm._v(\" \"), _c('md-button', {\n    ref: \"brushButton\",\n    staticClass: \"md-icon-button\",\n    on: {\n      \"click\": function($event) {\n        _vm.toggletool(\"brush\")\n      }\n    }\n  }, [_c('md-icon', [_vm._v(\"brush\")])], 1), _vm._v(\" \"), _c('md-button', {\n    staticClass: \"md-icon-button\",\n    on: {\n      \"click\": function($event) {\n        _vm.toggletool(\"eraser\")\n      }\n    }\n  }, [_c('md-icon', [_vm._v(\"call_to_action\")])], 1), _vm._v(\" \"), _c('md-button', {\n    staticClass: \"md-icon-button\",\n    on: {\n      \"click\": function($event) {\n        _vm.toggletool(\"spoit\")\n      }\n    }\n  }, [_c('md-icon', [_vm._v(\"colorize\")])], 1), _vm._v(\" \"), _c('md-button', {\n    staticClass: \"md-icon-button\",\n    on: {\n      \"click\": function($event) {\n        _vm.toggletool(\"color\")\n      }\n    }\n  }, [_c('md-icon', [_vm._v(\"tune\")])], 1)], 1)], 1), _vm._v(\" \"), _c('md-dialog', {\n    ref: \"colorDialog\",\n    attrs: {\n      \"id\": \"color-dialog\"\n    }\n  }, [_c('md-dialog-title', [_vm._v(\"\")]), _vm._v(\" \"), _c('md-dialog-content', [_vm._v(\"\\n      \\n      \"), _c('ui-slider', {\n    ref: \"hueSlider\",\n    attrs: {\n      \"defaultValue\": 50\n    },\n    on: {\n      \"change-value\": _vm.onchangehue\n    }\n  }), _vm._v(\"\\n      \\n      \"), _c('ui-slider', {\n    ref: \"satSlider\",\n    attrs: {\n      \"defaultValue\": 50\n    },\n    on: {\n      \"change-value\": _vm.onchangesat\n    }\n  }), _vm._v(\"\\n      \\n      \"), _c('ui-slider', {\n    ref: \"valSlider\",\n    attrs: {\n      \"defaultValue\": 50\n    },\n    on: {\n      \"change-value\": _vm.onchangeval\n    }\n  })], 1), _vm._v(\" \"), _c('md-dialog-actions', [_c('md-button', {\n    staticClass: \"md-primary\",\n    on: {\n      \"click\": _vm.closeColorDialog\n    }\n  }, [_vm._v(\"\")]), _vm._v(\" \"), _c('md-button', {\n    staticClass: \"md-primary\",\n    on: {\n      \"click\": _vm.applyColorDialog\n    }\n  }, [_vm._v(\"\")])], 1)], 1)], 1)\n},staticRenderFns: []}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-loader/lib/template-compiler.js?id=data-v-273a77c8!./~/vue-loader/lib/selector.js?type=template&index=0!./src/App.vue\n// module id = 182\n// module chunks = 2","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    attrs: {\n      \"id\": \"ui-layer-list\"\n    }\n  }, [(_vm.layers) ? _c('ul', _vm._l((_vm.layers), function(layer, i) {\n    return _c('li', {\n      on: {\n        \"mouseover\": function($event) {\n          _vm.mouseover(i)\n        },\n        \"mouseleave\": function($event) {\n          _vm.mouseleave(i)\n        }\n      }\n    }, [_c('md-button', {\n      on: {\n        \"click\": function($event) {\n          _vm.clear(i)\n        }\n      }\n    }, [_c('md-icon', [_vm._v(\"clear\")])], 1), _vm._v(\" \"), _c('img', {\n      attrs: {\n        \"src\": layer.url\n      }\n    }), _vm._v(\" \"), (layer.histories && _vm.active === i) ? _c('ul', _vm._l((layer.histories), function(history, j) {\n      return _c('li', {\n        staticStyle: {\n          \"display\": \"inline\"\n        }\n      }, [_c('img', {\n        attrs: {\n          \"src\": history\n        },\n        on: {\n          \"click\": function($event) {\n            _vm.rollback(i, j)\n          }\n        }\n      })])\n    })) : _vm._e()], 1)\n  })) : _vm._e()])\n},staticRenderFns: []}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-loader/lib/template-compiler.js?id=data-v-29c54477!./~/vue-loader/lib/selector.js?type=template&index=0!./src/components/UiLayerList.vue\n// module id = 183\n// module chunks = 2"],"sourceRoot":""}